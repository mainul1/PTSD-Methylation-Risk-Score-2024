<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Agaz Wani">

<title>Downstream analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="downstream_analysis_v5_files/libs/clipboard/clipboard.min.js"></script>
<script src="downstream_analysis_v5_files/libs/quarto-html/quarto.js"></script>
<script src="downstream_analysis_v5_files/libs/quarto-html/popper.min.js"></script>
<script src="downstream_analysis_v5_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="downstream_analysis_v5_files/libs/quarto-html/anchor.min.js"></script>
<link href="downstream_analysis_v5_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="downstream_analysis_v5_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="downstream_analysis_v5_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="downstream_analysis_v5_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="downstream_analysis_v5_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Downstream analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Agaz Wani </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="note-some-features-have-0-importance-in-random-forest-a-case-when-a-feature-is-not-used-to-make-a-spilit.-these-features-are-still-important-because-their-presence-influences-how-the-splits-occur-even-if-they-are-not-involved-in-any-splits." class="level3">
<h3 class="anchored" data-anchor-id="note-some-features-have-0-importance-in-random-forest-a-case-when-a-feature-is-not-used-to-make-a-spilit.-these-features-are-still-important-because-their-presence-influences-how-the-splits-occur-even-if-they-are-not-involved-in-any-splits.">Note: Some features have 0 importance in Random Forest, a case when a feature is not used to make a spilit. These features are still important because their presence influences how the splits occur, even if they are not involved in any splits.</h3>
<section id="this-version-has-weights-from-other-approachs-coefficients-to-improve-the-risk-scores" class="level4">
<h4 class="anchored" data-anchor-id="this-version-has-weights-from-other-approachs-coefficients-to-improve-the-risk-scores">This version has weights from other approachs (coefficients) to improve the risk scores</h4>
</section>
</section>
<section id="code-to-test-correlationassociation-between-mrs-and-ptsd-and-perform-enrichment-analysis." class="level3">
<h3 class="anchored" data-anchor-id="code-to-test-correlationassociation-between-mrs-and-ptsd-and-perform-enrichment-analysis.">Code to test correlation/association between MRS and PTSD and perform enrichment analysis.</h3>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section">————————————————</h4>
</section>
<section id="note-this-notebook-uses-important-features-using-kbest-and-elastic-net-approach" class="level4">
<h4 class="anchored" data-anchor-id="note-this-notebook-uses-important-features-using-kbest-and-elastic-net-approach">Note: This notebook uses important features using (kbest and elastic net approach)</h4>
<div class="cell">

</div>
</section>
</section>
<section id="risk-scores-on-test-set" class="level3">
<h3 class="anchored" data-anchor-id="risk-scores-on-test-set">risk scores on test set</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2021-10-02_23-12-43 previous path</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="st">"G:/PGC ML/Combined Data/2022-03-30_15-07-11/Elasticnet risk scores ptsdpm test data.xlsx"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>sheet_names <span class="ot">&lt;-</span> <span class="fu">getSheetNames</span>(fname)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># function to read all sheets</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>read_allsheets <span class="ot">&lt;-</span> <span class="cf">function</span>(path){</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  sheet_nms <span class="ot">&lt;-</span> <span class="fu">getSheetNames</span>(path)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  sheets <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sheet_nms, read.xlsx, <span class="at">xlsxFile =</span> path)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(sheets) <span class="ot">&lt;-</span> sheet_nms</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sheets)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># call function for current and lifetime PTSD</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#current</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">&lt;-</span> <span class="fu">read_allsheets</span>(<span class="at">path =</span> fname)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># lifetime is in two different files (noncpgs and noncpgsXY)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>feapath <span class="ot">&lt;-</span> <span class="st">"G:/PGC ML/Combined Data/2022-03-30_15-07-11/"</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>file_ls <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> feapath,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pattern =</span> <span class="st">".csv"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>ptsdlife_file_ls <span class="ot">&lt;-</span> file_ls[<span class="fu">grepl</span>(<span class="st">"^ElasticNet_ptsdlife"</span>, file_ls)]</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>adj_df_life <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ptsdlife_file_ls, <span class="cf">function</span>(x) <span class="fu">read.csv</span>(<span class="fu">paste0</span>(feapath, x)))</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(adj_df_life) <span class="ot">&lt;-</span> sheet_names</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># rename some columns for brevity</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>ptsd_old_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'ptsdpm'</span>, <span class="st">'Traumanum'</span>, <span class="st">'Childhood_Mt'</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>ptsd_new_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CurrentPTSD'</span>, <span class="st">'TraumaNumber'</span>, <span class="st">'ChildhoodMaltreatment'</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># function to rename columns</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>replace_names <span class="ot">&lt;-</span> <span class="cf">function</span>(df, old_cols, new_cols, fac_col){</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x){</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename_at</span>(<span class="fu">vars</span>(old_cols), <span class="sc">~</span>new_cols)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  x[[fac_col]] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(x[[fac_col]])</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(fac_col)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">lapply</span>(df, dim))</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  df</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Current PTSD</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">&lt;-</span> <span class="fu">replace_names</span>(adj_df, ptsd_old_cols, ptsd_new_cols, <span class="st">"CurrentPTSD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(old_cols)

  # Now:
  data %&gt;% select(all_of(old_cols))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CurrentPTSD"
$`Without NonCpG Probes`
[1]  307 2783

$`Without NonCpGXY Probes`
[1]  307 3733</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(adj_df$`Without NonCpGXY Probes`)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lifetime</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ptsdl_old_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PtsdLife"</span>, ptsd_old_cols[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>ptsdl_new_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'LifetimePTSD'</span>, ptsd_new_cols[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>lifetime_df <span class="ot">&lt;-</span> <span class="fu">replace_names</span>(adj_df_life, ptsdl_old_cols, ptsdl_new_cols,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'LifetimePTSD'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LifetimePTSD"
$`Without NonCpG Probes`
[1]  308 2782

$`Without NonCpGXY Probes`
[1]  308 3732</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply(lifetime_df, dim)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="after-kurt-ran-the-analysis-we-want-to-investigate-why-the-direction-of-effect-change-between-discovery-cohots-and-the-replication-cohort.-we-will-run-stratified-test-for-army-and-civilian-cohorts." class="level3">
<h3 class="anchored" data-anchor-id="after-kurt-ran-the-analysis-we-want-to-investigate-why-the-direction-of-effect-change-between-discovery-cohots-and-the-replication-cohort.-we-will-run-stratified-test-for-army-and-civilian-cohorts.">After kurt ran the analysis we want to investigate why the direction of effect change between discovery cohots and the replication cohort. We will run stratified test for army and civilian cohorts.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data from all chorts</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>all_cohorts <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"G:/PGC ML/Pre_Processed Data/2021-11-15_21-41-53/DNHS_GTP_MRS_ArmyS_Prismo_Pheno.csv"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Now add Ptss and gender information to test sets</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">=</span> <span class="fu">lapply</span>(adj_df, <span class="cf">function</span>(x){</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(x, all_cohorts[, <span class="fu">c</span>(<span class="st">"Basename"</span>, <span class="st">"Pts_Severity"</span>, <span class="st">"Gender"</span>, <span class="st">"Study"</span>)],</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> <span class="st">"Basename"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(adj_df, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  307 2786

$`Without NonCpGXY Probes`
[1]  307 3736</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>lifetime_df <span class="ot">=</span> <span class="fu">lapply</span>(lifetime_df, <span class="cf">function</span>(x){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(x, all_cohorts[, <span class="fu">c</span>(<span class="st">"Basename"</span>, <span class="st">"Pts_Severity"</span>, <span class="st">"Gender"</span>, <span class="st">"Study"</span>)],</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> <span class="st">"Basename"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(lifetime_df, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  308 2785

$`Without NonCpGXY Probes`
[1]  308 3735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a copy of test set for individual analysis for just one dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>individual_cohorts_testset <span class="ot">&lt;-</span> adj_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove scaled columns from test set for individual cohort analysis for test set</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># individual_cohorts_testset &lt;- individual_cohorts_testset %&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("ChildhoodMaltreatment", "TraumaNumber"))</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># individual_cohorts_testset &lt;- merge(individual_cohorts_testset, </span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     all_cohorts[, c("Basename", </span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                     "Childhood_Mt", </span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                     "Traumanum")],</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     by = "Basename")</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># individual_cohorts_testset &lt;- individual_cohorts_testset %&gt;%</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(ChildhoodMaltreatment = Childhood_Mt,</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#          TraumaNumber = Traumanum)</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># remove some columns that we already have</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>all_cohorts <span class="ot">&lt;-</span> all_cohorts <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"Childhood_Mt"</span>, <span class="st">"Traumanum"</span>))</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_cohorts)</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Important features for current and lifetime PTSD datasets (both train and test)</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># we need this information to check if we have remitted in lifetime ptsd </span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>current <span class="ot">&lt;-</span> <span class="fu">read_allsheets</span>(<span class="at">path =</span> <span class="fu">paste0</span>(feapath,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"ElasticNet_Current_ptsd_important_features.xlsx"</span>))</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>lifetime <span class="ot">&lt;-</span> <span class="fu">read_allsheets</span>(<span class="at">path =</span> <span class="fu">paste0</span>(feapath,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"ElasticNet_Lifetime_ptsd_important_features.xlsx"</span>)) </span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co"># combine current and lifetime to check if we have remitted for lifetime</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>cur_life_comn <span class="ot">&lt;-</span> <span class="fu">merge</span>(all_cohorts,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>                       lifetime<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>                       <span class="at">by =</span> <span class="st">"Basename"</span>)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>cur_life_comn <span class="ot">&lt;-</span> cur_life_comn <span class="sc">%&gt;%</span> <span class="fu">select</span>(Basename, Ptsdpm, Ptsdlife, Pts_Severity)</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cur_life_comn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1229    4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remitted</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>remitted <span class="ot">&lt;-</span> cur_life_comn <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Ptsdpm <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> Ptsdlife <span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(remitted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 219   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Remitted samples in lifetime PTSD: "</span>, <span class="fu">nrow</span>(remitted)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Remitted samples in lifetime PTSD: 219"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(remitted)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># important features should match between current and lifetime PTSD</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># one column - current with lifetime PTSD will not match - that is ok </span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">colnames</span>(current<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>) <span class="sc">==</span> <span class="fu">colnames</span>(lifetime<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
    1  2781 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">colnames</span>(current<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>) <span class="sc">==</span> <span class="fu">colnames</span>(lifetime<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
    1  3731 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to load the train test set for current ptsd to get gender information</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is from earlier version where we had gender as important feature</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>train_test <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"G:/PGC ML/Combined Data/2021-11-27_19-16-35/Current_ptsd_important_features.csv"</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now combine to get additional helpful information such as basename/gender</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and order data based on sample ids (i.e Basename)</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>current_comb <span class="ot">&lt;-</span> <span class="fu">lapply</span>(current, <span class="cf">function</span>(x){</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">merge</span>(x, all_cohorts, <span class="at">by =</span> <span class="st">"Basename"</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y[<span class="fu">order</span>(<span class="fu">match</span>(y<span class="sc">$</span>Basename, train_test<span class="sc">$</span>Basename)), ]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>} )</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample ids should match</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(current<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>Basename <span class="sc">==</span> train_test<span class="sc">$</span>Basename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
1226 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(current<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Basename <span class="sc">==</span> train_test<span class="sc">$</span>Basename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
1226 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace old columns with new </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ptsd_cur_old_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'current_ptsd'</span>, ptsd_old_cols[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>current_comb <span class="ot">&lt;-</span> <span class="fu">replace_names</span>(current_comb, ptsd_cur_old_cols, ptsd_new_cols, <span class="st">"CurrentPTSD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CurrentPTSD"
$`Without NonCpG Probes`
[1] 1226 2802

$`Without NonCpGXY Probes`
[1] 1226 3752</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(current_comb)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># To get each Army cohort separately. Also get CpGs and important phenotype.</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>army_p <span class="ot">&lt;-</span> <span class="st">'Armystarrs|MRS|Prismo'</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'cg'</span>, <span class="st">'ch'</span>, <span class="st">'trauma'</span>, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">'childhood'</span>, <span class="st">'CurrentPTSD'</span>, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">'LifetimePTSD'</span>, <span class="st">"Basename"</span>, </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Gender"</span>, <span class="st">"Pts_Severity"</span>, <span class="st">"Study"</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get studies of interest</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>filter_study <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols, p){</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">"Current"</span>, <span class="fu">colnames</span>(df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>), <span class="at">ignore.case =</span> T))){</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Current PTSD....."</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> {<span class="fu">print</span>(<span class="st">"Lifetime PTSD ......"</span>)}</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Studies :"</span>, p))</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> </span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">filter</span>(<span class="fu">grepl</span>(p, Study)) <span class="sc">%&gt;%</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(<span class="fu">contains</span>(cols)))</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">lapply</span>(x, dim))</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">grepl</span>(p, Study)) <span class="sc">%&gt;%</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">contains</span>(cols)) </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">dim</span>(x))</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="co"># get individual cohorts. We will use only the dataset without non-cpg and xy probes </span></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>individual_cohorts <span class="ot">&lt;-</span> current_comb<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span> <span class="sc">%&gt;%</span> </span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">which</span>(<span class="fu">grepl</span>(<span class="st">"Base|cg|Gender|Childhood|Trauma|CurrentPTSD|Pts_Sev|Study"</span>,<span class="fu">colnames</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(<span class="at">f =</span> <span class="fu">as.factor</span>(.<span class="sc">$</span>Study))</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(individual_cohorts, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1]  153 3735

$DNHS
[1]  416 3735

$GTP
[1]  484 3735

$MRS
[1]  123 3735

$Prismo
[1]   50 3735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># individual cohorts form test set</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>individual_cohorts_testset <span class="ot">&lt;-</span> individual_cohorts_testset <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">which</span>(<span class="fu">grepl</span>(<span class="st">"Base|cg|Gender|Childhood|Trauma|CurrentPTSD|Pts_Sev|Study"</span>,<span class="fu">colnames</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(<span class="at">f =</span> <span class="fu">as.factor</span>(.<span class="sc">$</span>Study))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(individual_cohorts_testset, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1]   39 3735

$DNHS
[1]  113 3735

$GTP
[1]  119 3735

$MRS
[1]   28 3735

$Prismo
[1]    8 3735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cur_army <span class="ot">&lt;-</span> <span class="fu">filter_study</span>(current_comb, <span class="fu">c</span>(cols, <span class="st">"Study"</span>), army_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Current PTSD....."
[1] "Studies : Armystarrs|MRS|Prismo"
$`Without NonCpG Probes`
[1]  326 2785

$`Without NonCpGXY Probes`
[1]  326 3735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(cur_army)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>civ_p <span class="ot">&lt;-</span> <span class="st">'DNHS|GTP'</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>cur_civ <span class="ot">&lt;-</span> <span class="fu">filter_study</span>(current_comb, <span class="fu">c</span>(cols, <span class="st">"Study"</span>), civ_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Current PTSD....."
[1] "Studies : DNHS|GTP"
$`Without NonCpG Probes`
[1]  900 2785

$`Without NonCpGXY Probes`
[1]  900 3735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lifetime --------------------</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>lifetime_comb <span class="ot">&lt;-</span> <span class="fu">lapply</span>(lifetime, <span class="cf">function</span>(x) <span class="fu">merge</span>(x, all_cohorts,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">by =</span> <span class="st">"Basename"</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>lifetime_old_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'lifetime_ptsd'</span>, ptsd_old_cols[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>lifetime_comb <span class="ot">&lt;-</span> <span class="fu">replace_names</span>(lifetime_comb, lifetime_old_cols,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                               ptsdl_new_cols, <span class="st">'LifetimePTSD'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LifetimePTSD"
$`Without NonCpG Probes`
[1] 1229 2802

$`Without NonCpGXY Probes`
[1] 1229 3752</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>life_army <span class="ot">&lt;-</span> <span class="fu">filter_study</span>(lifetime_comb, cols, army_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lifetime PTSD ......"
[1] "Studies : Armystarrs|MRS|Prismo"
$`Without NonCpG Probes`
[1]  173 2785

$`Without NonCpGXY Probes`
[1]  173 3735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(life_army)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>life_civ <span class="ot">&lt;-</span> <span class="fu">filter_study</span>(lifetime_comb, cols, civ_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lifetime PTSD ......"
[1] "Studies : DNHS|GTP"
$`Without NonCpG Probes`
[1] 1056 2785

$`Without NonCpGXY Probes`
[1] 1056 3735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now to calculate risk scores on both training and test sets</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>current_all <span class="ot">&lt;-</span> <span class="fu">lapply</span>(current_comb, <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(cols)))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(current_all, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 1226 2785

$`Without NonCpGXY Probes`
[1] 1226 3735</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>life_all <span class="ot">&lt;-</span> <span class="fu">lapply</span>(lifetime_comb, <span class="cf">function</span>(x) x<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(cols)))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(life_all, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 1229 2785

$`Without NonCpGXY Probes`
[1] 1229 3735</code></pre>
</div>
</div>
</section>
<section id="correlation-on-covariate-unadjusted-data" class="level3">
<h3 class="anchored" data-anchor-id="correlation-on-covariate-unadjusted-data">Correlation on covariate unadjusted data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unadj &lt;- arrow::read_feather("G:/PGC ML/Pre_Processed Data/2021-11-15_21-41-53/Imputed_DNHS_GTP_MRS_ArmyS_Prsm.feather")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="to-calculate-risk-scores-from-data-remove-the-risk-scores-in-ml-python-code-and-ptsd" class="level3">
<h3 class="anchored" data-anchor-id="to-calculate-risk-scores-from-data-remove-the-risk-scores-in-ml-python-code-and-ptsd">To calculate risk scores from data remove the risk scores (in ML python code) and ptsd</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to remove some columns</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>remove_columns <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols){</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) x[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(x) <span class="sc">%in%</span> cols)])</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">lapply</span>(x, dim))</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> df[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(df) <span class="sc">%in%</span> cols)]</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">dim</span>(x))</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co"># calling function</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns to remove from current and lifetime ptsd</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>rm_cur_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"risk_score"</span>, <span class="st">"Basename"</span>, <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Gender"</span>, <span class="st">"Pts_Severity"</span>, <span class="st">"Study"</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>rm_life_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'LifetimePTSD'</span>, <span class="st">'Basename'</span>,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Gender"</span>, <span class="st">"Pts_Severity"</span>, <span class="st">"Study"</span>)</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>test_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(adj_df, rm_cur_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  307 2780

$`Without NonCpGXY Probes`
[1]  307 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>individual_sc_test <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(individual_cohorts_testset,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(rm_cur_cols, <span class="st">"Study"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1]   39 3730

$DNHS
[1]  113 3730

$GTP
[1]  119 3730

$MRS
[1]   28 3730

$Prismo
[1]    8 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>individual_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(individual_cohorts, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">c</span>(rm_cur_cols, <span class="st">"Study"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1]  153 3730

$DNHS
[1]  416 3730

$GTP
[1]  484 3730

$MRS
[1]  123 3730

$Prismo
[1]   50 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>army_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(cur_army, rm_cur_cols[<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  326 2780

$`Without NonCpGXY Probes`
[1]  326 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>civ_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(cur_civ, rm_cur_cols[<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  900 2780

$`Without NonCpGXY Probes`
[1]  900 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>army_life_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(life_army, rm_life_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  173 2780

$`Without NonCpGXY Probes`
[1]  173 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>test_life_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(lifetime_df, rm_life_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  308 2780

$`Without NonCpGXY Probes`
[1]  308 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>current_all_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(current_all, rm_cur_cols[<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 1226 2780

$`Without NonCpGXY Probes`
[1] 1226 3730</code></pre>
</div>
</div>
</section>
<section id="function-to-scale-the-data-between-0-1" class="level3">
<h3 class="anchored" data-anchor-id="function-to-scale-the-data-between-0-1">function to scale the data between 0-1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>maxmin <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>){</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(x)<span class="sc">==</span><span class="cn">TRUE</span>){</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    maxs <span class="ot">&lt;-</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    mins <span class="ot">&lt;-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale</span>(x,<span class="at">center=</span>mins,<span class="at">scale=</span>maxs<span class="sc">-</span>mins)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    maxs <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>,max, <span class="at">na.rm=</span> na.rm)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    mins <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>,min, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale</span>(x, <span class="at">center =</span> mins, <span class="at">scale =</span> maxs <span class="sc">-</span> mins)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="we-will-scale-trauma-and-childhoodmaltreatment-columns" class="level3">
<h3 class="anchored" data-anchor-id="we-will-scale-trauma-and-childhoodmaltreatment-columns">We will scale trauma and childhoodmaltreatment columns</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>scale_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TraumaNumber"</span>, <span class="st">"ChildhoodMaltreatment"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># current</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>scale_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols){</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the columns with unique values, for e.g in ArmyStarrs cohort </span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># all trauma values are one, so don't scale that </span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># so we need to remove such columns before scaling</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  col_wd_unq_vals <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df[, cols], <span class="cf">function</span>(x) x[<span class="fu">length</span>(<span class="fu">unique</span>(x)) <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  col_wd_unq_vals <span class="ot">&lt;-</span> <span class="fu">Filter</span>(length, col_wd_unq_vals)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  col_wd_unq_vals <span class="ot">&lt;-</span> <span class="fu">names</span>(col_wd_unq_vals)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  cols <span class="ot">&lt;-</span> cols[<span class="sc">!</span>cols <span class="sc">%in%</span> col_wd_unq_vals]</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Scaling columns:"</span>, cols, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  scale_df <span class="ot">&lt;-</span> df[, <span class="fu">which</span>(<span class="fu">names</span>(df) <span class="sc">%in%</span> (cols)), <span class="cn">TRUE</span>]</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  scale_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">maxmin</span>(<span class="at">x =</span> scale_df, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># code to handle one column</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">ncol</span>(scale_df) <span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(scale_df) <span class="ot">&lt;-</span> cols</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    scale_df <span class="ot">&lt;-</span> scale_df[, <span class="fu">match</span>(<span class="fu">colnames</span>(scale_df), cols)]</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check if cols are in order before renaming</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(scale_df) <span class="sc">==</span> cols)){</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"columns in order"</span>)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(scale_df) <span class="ot">&lt;-</span> cols</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{<span class="fu">stop</span>(<span class="st">"columns are NOT in order"</span>)}</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>  other_df <span class="ot">&lt;-</span> df[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(df) <span class="sc">%in%</span> (cols)), <span class="cn">TRUE</span>]</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(other_df, scale_df)</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>scale_data_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(df,  cols){</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) <span class="fu">scale_data</span>(x, cols))</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">lapply</span>(x, dim))</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">scale_data</span>(df, cols)</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">dim</span>(x))</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>adj_sc_df <span class="ot">&lt;-</span> <span class="fu">scale_data_helper</span>(test_sc, scale_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
$`Without NonCpG Probes`
[1]  307 2780

$`Without NonCpGXY Probes`
[1]  307 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(adj_sc_df)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">#----------</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>ind_sc_df_test <span class="ot">&lt;-</span> <span class="fu">scale_data_helper</span>(individual_sc_test, scale_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scaling columns: ChildhoodMaltreatment 
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
$Armystarrs
[1]   39 3730

$DNHS
[1]  113 3730

$GTP
[1]  119 3730

$MRS
[1]   28 3730

$Prismo
[1]    8 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ind_sc_df <span class="ot">&lt;-</span> <span class="fu">scale_data_helper</span>(individual_sc, scale_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scaling columns: ChildhoodMaltreatment 
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
$Armystarrs
[1]  153 3730

$DNHS
[1]  416 3730

$GTP
[1]  484 3730

$MRS
[1]  123 3730

$Prismo
[1]   50 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(ind_sc_df<span class="sc">$</span>Armystarrs)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># army</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>army_sc_df <span class="ot">&lt;-</span> <span class="fu">scale_data_helper</span>(army_sc, scale_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
$`Without NonCpG Probes`
[1]  326 2780

$`Without NonCpGXY Probes`
[1]  326 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(army_sc_df$`Without NonCpG Probes`)</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># lifetime</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co"># army_life_sc_df &lt;- scale_data_helper(army_life_sc, scale_cols[2])</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View(army_life_sc_df)</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>adj_life_sc_df <span class="ot">&lt;-</span> <span class="fu">scale_data_helper</span>(test_life_sc, scale_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
$`Without NonCpG Probes`
[1]  308 2780

$`Without NonCpGXY Probes`
[1]  308 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(adj_life_sc_df)</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># all data</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>cur_sc_df <span class="ot">&lt;-</span> <span class="fu">scale_data_helper</span>(current_all_sc, scale_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
Scaling columns: TraumaNumber ChildhoodMaltreatment 
[1] "columns in order"
$`Without NonCpG Probes`
[1] 1226 2780

$`Without NonCpGXY Probes`
[1] 1226 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(cur_sc_df)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="now-calculate-risk-scores" class="level3">
<h3 class="anchored" data-anchor-id="now-calculate-risk-scores">Now calculate risk scores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load feature importance</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>weights_file_ls <span class="ot">&lt;-</span> file_ls[<span class="fu">grepl</span>(<span class="st">"EN_selected_wd_EN_l1_r_0.1"</span>, file_ls)]</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>weightsWoExpVar <span class="ot">&lt;-</span> file_ls[<span class="fu">grepl</span>(<span class="st">"EN_WO_Exposure_Vars_selected_wd_EN_l1_r_0.1"</span>, file_ls)]</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># add feature weights from model without exposure variables</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">c</span>(weights_file_ls, weightsWoExpVar) , <span class="cf">function</span>(x) <span class="fu">read.csv</span>(<span class="fu">paste0</span>(feapath, x)))</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>sheet_names_new <span class="ot">&lt;-</span> <span class="fu">c</span>(sheet_names, <span class="fu">paste0</span>(sheet_names[<span class="dv">2</span>], <span class="st">"WoExpVar"</span>))</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(weights) <span class="ot">&lt;-</span> sheet_names_new</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(weights,dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 2780    2

$`Without NonCpGXY Probes`
[1] 3730    2

$`Without NonCpGXY ProbesWoExpVar`
[1] 3728    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save weights in one .xls sheet for sharing to run on independent cohorts</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(weights, "../../../Combined Data/2022-03-30_15-07-11/EN_selected_wd_EN_l1_r_0.1.xlsx",</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co">#            rowNames = FALSE)</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># weights &lt;- read.csv("G:/PGC ML/Combined Data/2021-11-27_19-16-35/Important_features.csv")</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lets get the mean and std deviation of risk scores</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>comn_features <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights, <span class="cf">function</span>(x){</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  x[<span class="fu">which</span>(x<span class="sc">$</span><span class="st">`</span><span class="at">Feature</span><span class="st">`</span> <span class="sc">%in%</span>  weights<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span><span class="sc">$</span>Feature), ]</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(comn_features, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 2756    2

$`Without NonCpGXY Probes`
[1] 3728    2

$`Without NonCpGXY ProbesWoExpVar`
[1] 3728    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>mean_sd <span class="ot">&lt;-</span> <span class="fu">lapply</span>(comn_features, <span class="cf">function</span>(x) <span class="fu">summary</span>(x[, <span class="dv">2</span>]))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>mean_sd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.7572171 -0.0641162  0.0000000 -0.0000011  0.0703176  0.8728078 

$`Without NonCpGXY Probes`
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.6189230 -0.0447797  0.0000000 -0.0000185  0.0474258  0.8493837 

$`Without NonCpGXY ProbesWoExpVar`
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.6597470 -0.0495280  0.0000000  0.0003207  0.0539337  0.8426613 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to rename some rows </span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>rename_importance_rows <span class="ot">&lt;-</span> <span class="cf">function</span>(weights_df){</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  weights_df<span class="sc">$</span>Feature <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(weights_df<span class="sc">$</span>Feature <span class="sc">==</span> <span class="st">'Traumanum'</span>, <span class="st">'TraumaNumber'</span>,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(weights_df<span class="sc">$</span>Feature <span class="sc">==</span> <span class="st">'Childhood_Mt'</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'ChildhoodMaltreatment'</span>, weights_df<span class="sc">$</span>Feature))</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  weights_df</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>rename_importance_rows_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(weights_df){</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(weights_df, <span class="st">"list"</span>)){</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights_df, <span class="cf">function</span>(x) <span class="fu">rename_importance_rows</span>(x))</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">lapply</span>(x, dim))</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rename_importance_rows</span>(weights_df)</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">dim</span>(x))</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">rename_importance_rows_helper</span>(<span class="at">weights_df =</span> weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 2780    2

$`Without NonCpGXY Probes`
[1] 3730    2

$`Without NonCpGXY ProbesWoExpVar`
[1] 3728    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lets add df for without trauma and childhood maltreatment variables</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span> <span class="ot">&lt;-</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c(TraumaNumber, ChildhoodMaltreatment))</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co"># current - check order</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="fu">Map</span>((<span class="cf">function</span>(x, y) <span class="fu">table</span>(<span class="fu">colnames</span>(x) <span class="sc">==</span> y<span class="sc">$</span>Feature)), adj_sc_df, weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in colnames(x) == y$Feature: longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`

FALSE  TRUE 
 2769    11 

$`Without NonCpGXY Probes`

FALSE  TRUE 
 3718    12 

$`Without NonCpGXY ProbesWoExpVar`

FALSE  TRUE 
 3721     9 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get features with negative and positive coefficients separately</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>neg_weights <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights, <span class="cf">function</span>(x) x[x<span class="sc">$</span>Importance <span class="sc">&lt;</span> <span class="dv">0</span>, ])</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(neg_weights, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 1027    2

$`Without NonCpGXY Probes`
[1] 1266    2

$`Without NonCpGXY ProbesWoExpVar`
[1] 1282    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>pos_weights <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights, <span class="cf">function</span>(x) x[x<span class="sc">$</span>Importance <span class="sc">&gt;</span> <span class="dv">0</span>, ])</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pos_weights, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 1028    2

$`Without NonCpGXY Probes`
[1] 1286    2

$`Without NonCpGXY ProbesWoExpVar`
[1] 1313    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now get the features from test dataset</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>adj_sc_df_neg <span class="ot">&lt;-</span> <span class="fu">Map</span>((<span class="cf">function</span>(x,y) x[, <span class="fu">colnames</span>(x) <span class="sc">%in%</span> y<span class="sc">$</span>Feature]),</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                     adj_sc_df, neg_weights)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(adj_sc_df_neg, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  307 1027

$`Without NonCpGXY Probes`
[1]  307 1266

$`Without NonCpGXY ProbesWoExpVar`
[1]  307 1282</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>adj_sc_df_pos <span class="ot">&lt;-</span> <span class="fu">Map</span>((<span class="cf">function</span>(x,y) x[, <span class="fu">colnames</span>(x) <span class="sc">%in%</span> y<span class="sc">$</span>Feature]), </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>                     adj_sc_df, pos_weights)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(adj_sc_df_pos, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  307 1028

$`Without NonCpGXY Probes`
[1]  307 1286

$`Without NonCpGXY ProbesWoExpVar`
[1]  307 1313</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to calculate risk scores. </span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It will check order of columns first and the calculate risk scores</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>calculate_score <span class="ot">&lt;-</span> <span class="cf">function</span>(df, weights, additional_cols_df, </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>                            add_col, <span class="at">sheet_names =</span> sheet_names){</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(df), <span class="cf">function</span>(i) {</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># check if weights is a list or not and take appropriate action</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">inherits</span>(weights, <span class="st">"list"</span>)){</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>        weights_df <span class="ot">=</span> weights[[i]]</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{weights_df <span class="ot">=</span> weights}</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>        comn_vars <span class="ot">&lt;-</span> df[[i]][, <span class="fu">which</span>(<span class="fu">colnames</span>(df[[i]]) <span class="sc">%in%</span> weights_df<span class="sc">$</span>Feature)]</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>        ord <span class="ot">&lt;-</span> comn_vars[, <span class="fu">order</span>(<span class="fu">match</span>(<span class="fu">colnames</span>(comn_vars), weights_df<span class="sc">$</span>Feature))]</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># check if we have trauma and childhood in the df</span></span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># it will be in case when we have weights from methylation data only</span></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if the cols exist, we will still add them to get correlation</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>        not_comn_vars <span class="ot">&lt;-</span> <span class="fu">colnames</span>(df[[i]])[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">colnames</span>(df[[i]]) <span class="sc">%in%</span> weights_df<span class="sc">$</span>Feature)]</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">identical</span>(not_comn_vars, <span class="fu">character</span>(<span class="dv">0</span>))){</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>          more_cols <span class="ot">&lt;-</span> not_comn_vars[<span class="fu">which</span>(not_comn_vars <span class="sc">%in%</span> <span class="fu">colnames</span>(df[[i]]))]</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>          add_col <span class="ot">&lt;-</span> <span class="fu">c</span>(add_col, more_cols)</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># we don't need to run this for df with no exposure variables</span></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="st">"TraumaNumber"</span> <span class="sc">%in%</span> weights_df<span class="sc">$</span>Feature){</span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Ordered: "</span>, <span class="fu">table</span>(<span class="fu">colnames</span>(ord) <span class="sc">==</span> weights_df<span class="sc">$</span>Feature),</span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">collapse =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))</span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">&lt;-</span> <span class="fu">apply</span>(ord, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">*</span> weights_df<span class="sc">$</span>Importance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>        ord[[<span class="st">'risk_score'</span>]] <span class="ot">&lt;-</span> s</span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># meth only risk scores</span></span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a>      meth_fea_weights <span class="ot">&lt;-</span> weights_df <span class="sc">%&gt;%</span></span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^cg|^ch."</span>, Feature))</span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a>      df_x <span class="ot">&lt;-</span> df[[i]]</span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a>      meth <span class="ot">&lt;-</span> df_x[, <span class="fu">which</span>(<span class="fu">colnames</span>(df_x) <span class="sc">%in%</span> meth_fea_weights<span class="sc">$</span>Feature)]</span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-45"><a href="#cb95-45" aria-hidden="true" tabindex="-1"></a>      ord_meth <span class="ot">&lt;-</span> meth[, <span class="fu">order</span>(<span class="fu">match</span>(<span class="fu">colnames</span>(meth),meth_fea_weights<span class="sc">$</span>Feature))]</span>
<span id="cb95-46"><a href="#cb95-46" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-47"><a href="#cb95-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Ordered: "</span>, </span>
<span id="cb95-48"><a href="#cb95-48" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">table</span>(<span class="fu">colnames</span>(ord_meth) <span class="sc">==</span></span>
<span id="cb95-49"><a href="#cb95-49" aria-hidden="true" tabindex="-1"></a>                          meth_fea_weights<span class="sc">$</span>Feature),<span class="at">collapse =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))</span>
<span id="cb95-50"><a href="#cb95-50" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-51"><a href="#cb95-51" aria-hidden="true" tabindex="-1"></a>      s_meth <span class="ot">&lt;-</span> <span class="fu">apply</span>(ord_meth, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">*</span> meth_fea_weights<span class="sc">$</span>Importance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb95-52"><a href="#cb95-52" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-53"><a href="#cb95-53" aria-hidden="true" tabindex="-1"></a>      ord[[<span class="st">'meth_only_risk_score'</span>]] <span class="ot">&lt;-</span> s_meth </span>
<span id="cb95-54"><a href="#cb95-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-55"><a href="#cb95-55" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-56"><a href="#cb95-56" aria-hidden="true" tabindex="-1"></a>       <span class="co"># check if from df is a list</span></span>
<span id="cb95-57"><a href="#cb95-57" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">inherits</span>(additional_cols_df, <span class="st">"list"</span>)){</span>
<span id="cb95-58"><a href="#cb95-58" aria-hidden="true" tabindex="-1"></a>        from_df <span class="ot">&lt;-</span> additional_cols_df[[i]] </span>
<span id="cb95-59"><a href="#cb95-59" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb95-60"><a href="#cb95-60" aria-hidden="true" tabindex="-1"></a>        from_df <span class="ot">&lt;-</span> additional_cols_df</span>
<span id="cb95-61"><a href="#cb95-61" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb95-62"><a href="#cb95-62" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-63"><a href="#cb95-63" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb95-64"><a href="#cb95-64" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(add_col) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb95-65"><a href="#cb95-65" aria-hidden="true" tabindex="-1"></a>        ord[add_col] <span class="ot">&lt;-</span> from_df[add_col]</span>
<span id="cb95-66"><a href="#cb95-66" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb95-67"><a href="#cb95-67" aria-hidden="true" tabindex="-1"></a>        ord[[add_col]] <span class="ot">&lt;-</span> from_df[[add_col]]</span>
<span id="cb95-68"><a href="#cb95-68" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb95-69"><a href="#cb95-69" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb95-70"><a href="#cb95-70" aria-hidden="true" tabindex="-1"></a>      ord</span>
<span id="cb95-71"><a href="#cb95-71" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb95-72"><a href="#cb95-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(x) <span class="ot">&lt;-</span> sheet_names</span>
<span id="cb95-73"><a href="#cb95-73" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb95-74"><a href="#cb95-74" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb95-75"><a href="#cb95-75" aria-hidden="true" tabindex="-1"></a>    from_df <span class="ot">=</span> additional_cols_df</span>
<span id="cb95-76"><a href="#cb95-76" aria-hidden="true" tabindex="-1"></a>    comn_vars <span class="ot">&lt;-</span> df[, <span class="fu">which</span>(<span class="fu">colnames</span>(df) <span class="sc">%in%</span> weights_df<span class="sc">$</span>Feature)]</span>
<span id="cb95-77"><a href="#cb95-77" aria-hidden="true" tabindex="-1"></a>    ord <span class="ot">&lt;-</span> comn_vars[, <span class="fu">order</span>(<span class="fu">match</span>(<span class="fu">colnames</span>(comn_vars),weights<span class="sc">$</span>Feature))]</span>
<span id="cb95-78"><a href="#cb95-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Ordered"</span>, <span class="fu">table</span>(<span class="fu">colnames</span>(ord) <span class="sc">==</span> weights<span class="sc">$</span>Feature)))</span>
<span id="cb95-79"><a href="#cb95-79" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">apply</span>(ord, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">*</span> weights<span class="sc">$</span>Importance))</span>
<span id="cb95-80"><a href="#cb95-80" aria-hidden="true" tabindex="-1"></a>   ord[[<span class="st">'risk_score'</span>]] <span class="ot">&lt;-</span> s</span>
<span id="cb95-81"><a href="#cb95-81" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb95-82"><a href="#cb95-82" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(<span class="fu">length</span>(add_col) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb95-83"><a href="#cb95-83" aria-hidden="true" tabindex="-1"></a>        ord[add_col] <span class="ot">&lt;-</span> from_df[add_col]</span>
<span id="cb95-84"><a href="#cb95-84" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb95-85"><a href="#cb95-85" aria-hidden="true" tabindex="-1"></a>        ord[[add_col]] <span class="ot">&lt;-</span> from_df[[add_col]]</span>
<span id="cb95-86"><a href="#cb95-86" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb95-87"><a href="#cb95-87" aria-hidden="true" tabindex="-1"></a>   ord</span>
<span id="cb95-88"><a href="#cb95-88" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-89"><a href="#cb95-89" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-90"><a href="#cb95-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-91"><a href="#cb95-91" aria-hidden="true" tabindex="-1"></a>add_cur_cols <span class="ot">&lt;-</span> rm_cur_cols[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb95-92"><a href="#cb95-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-93"><a href="#cb95-93" aria-hidden="true" tabindex="-1"></a>adj_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(adj_sc_df, weights,</span>
<span id="cb95-94"><a href="#cb95-94" aria-hidden="true" tabindex="-1"></a>                             adj_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb95-95"><a href="#cb95-95" aria-hidden="true" tabindex="-1"></a>                             <span class="at">add_col =</span> add_cur_cols,</span>
<span id="cb95-96"><a href="#cb95-96" aria-hidden="true" tabindex="-1"></a>                             sheet_names_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  2780"
[1] "Ordered:  2778"
[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3728"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>adj_sc_df_neg <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(adj_sc_df_neg, neg_weights,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>                             adj_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>                             sheet_names_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  1027"
[1] "Ordered:  1266"
[1] "Ordered:  1282"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>adj_sc_df_pos <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(adj_sc_df_pos, pos_weights,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>                             adj_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>                             sheet_names_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  1028"
[1] "Ordered:  1026"
[1] "Ordered:  1286"
[1] "Ordered:  1284"
[1] "Ordered:  1313"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual cohorts</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>ind_sc_df_wd_score <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(ind_sc_df, </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>                             weights<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>                             individual_cohorts, </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet_names =</span> <span class="fu">names</span>(individual_cohorts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3730"
[1] "Ordered:  3728"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>ind_sc_df_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(ind_sc_df, </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>                                             weights<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span>,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>                                             individual_cohorts, </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">sheet_names =</span> <span class="fu">names</span>(individual_cohorts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  3728"
[1] "Ordered:  3728"
[1] "Ordered:  3728"
[1] "Ordered:  3728"
[1] "Ordered:  3728"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual cohorts in test set only</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>ind_sc_df_test_wd_score <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(ind_sc_df_test, </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                                           weights<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>                                           individual_cohorts_testset, </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sheet_names =</span> <span class="fu">names</span>(individual_cohorts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3730"
[1] "Ordered:  3728"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>ind_sc_df_test_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(ind_sc_df_test, </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>                                                  weights<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span>,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>                                                  individual_cohorts_testset, </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">sheet_names =</span> <span class="fu">names</span>(individual_cohorts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  3728"
[1] "Ordered:  3728"
[1] "Ordered:  3728"
[1] "Ordered:  3728"
[1] "Ordered:  3728"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Army ---------------</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>army_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(army_sc_df, weights,</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>                         cur_army<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">add_col =</span> add_cur_cols,</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>                         sheet_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  2780"
[1] "Ordered:  2778"
[1] "Ordered:  3730"
[1] "Ordered:  3728"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lifetime</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="co"># army_life_sc_df = order_data(army_life_sc_df)</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="co"># table(colnames(army_life_sc_df) == weights$Feature)</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="co"># army_life_sc_df$risk_score &lt;- calculate_score(army_life_sc_df)</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="co"># army_life_sc_df$LifetimePTSD &lt;- army_life_sc_df$LifetimePTSD</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>add_life_cols <span class="ot">&lt;-</span> rm_life_cols</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>adj_life_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(adj_life_sc_df, weights,</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>                         lifetime_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">add_col =</span> add_life_cols, </span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>                         sheet_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  2780"
[1] "Ordered:  2778"
[1] "Ordered:  3730"
[1] "Ordered:  3728"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>cur_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(cur_sc_df, weights,</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>                         current_all<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>                         sheet_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  2780"
[1] "Ordered:  2778"
[1] "Ordered:  3730"
[1] "Ordered:  3728"</code></pre>
</div>
</div>
</section>
<section id="calculate-mean-methylation-of-samples-for-significant-cpgs" class="level3">
<h3 class="anchored" data-anchor-id="calculate-mean-methylation-of-samples-for-significant-cpgs">calculate mean methylation of samples for significant cpgs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>cpg_p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cg"</span>, <span class="st">"ch."</span>) <span class="co"># pattern</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate mean</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>calculate_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(df, p){</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) {</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mean_meth =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(cpg_p))))</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mean_meth =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(cpg_p))))</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(adj_df, cpg_p)</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>adj_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(adj_sc_df, cpg_p)</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>adj_sc_df_neg <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(adj_sc_df_neg, cpg_p)</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>adj_sc_df_pos <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(adj_sc_df_pos, cpg_p)</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>ind_sc_df_test_wd_score <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(ind_sc_df_test_wd_score, cpg_p)</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>ind_sc_df_test_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(ind_sc_df_test_wo_exp_in_model, cpg_p)</span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>ind_sc_df_wd_score <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(ind_sc_df_wd_score, cpg_p)</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>ind_sc_df_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(ind_sc_df_wo_exp_in_model, cpg_p)</span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>army_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(army_sc_df, cpg_p)</span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a><span class="co"># army_life_sc_df &lt;- calculate_mean(army_life_sc_df, cpg_p)</span></span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>adj_life_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(adj_life_sc_df, cpg_p)</span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>cur_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(cur_sc_df, cpg_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlation-plot" class="level3">
<h3 class="anchored" data-anchor-id="correlation-plot">Correlation plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation columns</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TraumaNumber"</span>, <span class="st">"ChildhoodMaltreatment"</span>, <span class="st">"risk_score"</span>, </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"meth_only_risk_score"</span>, <span class="st">"CurrentPTSD"</span>, <span class="st">"mean_meth"</span>)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>cols_life <span class="ot">&lt;-</span> <span class="fu">c</span>(cols[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="st">"LifetimePTSD"</span>, cols[<span class="dv">6</span>])</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>new_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cumulative trauma"</span>, <span class="st">"Childhood maltreatment"</span>, </span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Risk score"</span>, <span class="st">"Meth Risk score"</span>,</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Current PTSD"</span>, <span class="st">"Mean methylation"</span>)</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>new_names_life <span class="ot">&lt;-</span> <span class="fu">c</span>(new_names[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="st">"Lifetime PTSD"</span>, new_names[<span class="dv">6</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-to-get-correlation-and-adjusted-pvalue.-input-is-data-frame-columns-we-want-to-get-correlation-for-and-new-names-to-assign-for-columns." class="level2">
<h2 class="anchored" data-anchor-id="function-to-get-correlation-and-adjusted-pvalue.-input-is-data-frame-columns-we-want-to-get-correlation-for-and-new-names-to-assign-for-columns.">Function to get correlation and adjusted pvalue. Input is data frame, columns we want to get correlation for and new names to assign for columns.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>get_correlation <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols, new_names){</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># As we have many dfs, lets check which cols are present</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and use those cols</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  cols_present <span class="ot">&lt;-</span> <span class="fu">which</span>(cols <span class="sc">%in%</span> <span class="fu">colnames</span>(df))</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  cols <span class="ot">&lt;-</span> cols[cols_present]</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> new_names[cols_present]</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the cols from df and correlation</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(cols)</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>  indx <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df, is.factor)</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>  df[indx] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df[indx], <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(x)))</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> new_names</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>  cor_df <span class="ot">&lt;-</span> <span class="fu">cor</span>(df)</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">cor.mtest</span>(df, <span class="at">conf.level =</span> <span class="fl">0.95</span>) <span class="co"># added na.rm </span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adjusted pvalues</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>  p_adj <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">p.adjust</span>(<span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(p<span class="sc">$</span>p)),</span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method=</span><span class="st">'fdr'</span>),</span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ncol=</span><span class="fu">ncol</span>(cor_df))</span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(p_adj) <span class="ot">&lt;-</span> new_names</span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(p_adj) <span class="ot">&lt;-</span> new_names</span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>  df_ls <span class="ot">&lt;-</span> <span class="fu">list</span>(cor_df, p_adj, p<span class="sc">$</span>p)</span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(df_ls) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cor"</span>, <span class="st">"padj"</span>, <span class="st">"pval"</span>)</span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_ls)</span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a>get_correlation_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols, new_names){</span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(df, <span class="st">"list"</span>)) {</span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a>    x_cor <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) <span class="fu">get_correlation</span>(x, cols, new_names))</span>
<span id="cb117-32"><a href="#cb117-32" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb117-33"><a href="#cb117-33" aria-hidden="true" tabindex="-1"></a>    x_cor <span class="ot">&lt;-</span> <span class="fu">get_correlation</span>(df, cols, new_names)</span>
<span id="cb117-34"><a href="#cb117-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb117-35"><a href="#cb117-35" aria-hidden="true" tabindex="-1"></a>  x_cor</span>
<span id="cb117-36"><a href="#cb117-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-37"><a href="#cb117-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-38"><a href="#cb117-38" aria-hidden="true" tabindex="-1"></a><span class="co"># color palette</span></span>
<span id="cb117-39"><a href="#cb117-39" aria-hidden="true" tabindex="-1"></a>colrs <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">'#7F0000'</span>,</span>
<span id="cb117-40"><a href="#cb117-40" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'#FF7F00'</span>, <span class="st">'orange'</span>,</span>
<span id="cb117-41"><a href="#cb117-41" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'cyan'</span>, <span class="st">'#007FFF'</span>, <span class="st">'blue'</span>, <span class="st">'#00007F'</span>,</span>
<span id="cb117-42"><a href="#cb117-42" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"#BC3C29FF"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="now-call-the-function-to-get-correlation-for-data" class="level2">
<h2 class="anchored" data-anchor-id="now-call-the-function-to-get-correlation-for-data">Now call the function to get correlation for data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariate adjusted data</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>dfs <span class="ot">&lt;-</span> <span class="fu">list</span>(adj_sc_df, </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>            ind_sc_df_test_wd_score, </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>            ind_sc_df_test_wo_exp_in_model, </span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>            ind_sc_df_wd_score,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>            ind_sc_df_wo_exp_in_model,</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>            army_sc_df, </span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>            cur_sc_df,</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>            adj_life_sc_df)</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>dfs_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Test set Current PTSD scaled'</span>, </span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Individual Cohorts Test'</span>,</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Individual Cohorts Test Wo Exp in Model'</span>,</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Individual Cohorts'</span>,</span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Individual Cohorts Wo Exp in Model'</span>, </span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Army cohorts'</span>, </span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">"All cohorts"</span>,</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Test set Lifetime PTSD'</span>)</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a><span class="co"># dfs &lt;- list(adj_sc_df, ind_sc_df, army_sc_df, adj_life_sc_df)</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a><span class="co"># dfs_names &lt;- c('Test set Current PTSD scaled',  </span></span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                "Individual Cohorts", 'Army cohorts', 'Test set Lifetime PTSD')</span></span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>cor_dfs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(dfs), <span class="cf">function</span>(i){</span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>, <span class="dv">7</span>)){</span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Processing ..."</span>, i)</span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_correlation_helper</span>(<span class="at">df =</span> dfs[[i]], <span class="at">cols =</span> cols,</span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a>                           <span class="at">new_names =</span> new_names)</span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_correlation_helper</span>(<span class="at">df =</span> dfs[[i]], <span class="at">cols =</span> cols_life,                 </span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a>                           <span class="at">new_names =</span> new_names_life)</span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(cols)

  # Now:
  data %&gt;% select(all_of(cols))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(df): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(x, y): the standard deviation is zero

Warning in cor(x, y): the standard deviation is zero

Warning in cor(x, y): the standard deviation is zero

Warning in cor(x, y): the standard deviation is zero

Warning in cor(x, y): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."
[1] "Processing ..."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_dfs) <span class="ot">&lt;-</span> dfs_names</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(cor_dfs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Test set Current PTSD scaled"           
[2] "Individual Cohorts Test"                
[3] "Individual Cohorts Test Wo Exp in Model"
[4] "Individual Cohorts"                     
[5] "Individual Cohorts Wo Exp in Model"     
[6] "Army cohorts"                           
[7] "All cohorts"                            
[8] "Test set Lifetime PTSD"                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save correlation information</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> <span class="st">"Test set Current PTSD scaled"</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>list_of_datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"nonCpG Cor"</span> <span class="ot">=</span> cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD scaled</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>cor,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"nonCpG Padj"</span> <span class="ot">=</span> cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD scaled</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>padj,</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"nonCpGXY Cor"</span> <span class="ot">=</span> cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD scaled</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>cor,</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"nonCpGXY Padj"</span> <span class="ot">=</span> cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD scaled</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>padj)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(list_of_datasets, file = "../data/Correlation_EN_lr_0.1.xlsx", rowNames = T)</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(cor_dfs$`Independent Cohorts`, file = "../data/Correlation_EN_lr_0.1_independent_cohorts.xlsx", rowNames = T)</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a><span class="co"># cor_army_life_df &lt;- get_correlation(df = army_life_sc_df, cols = cols_life,</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 new_names = new_names_life)</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get correlation between different variables</span></span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>correlation_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(cor_df, pval_name, title){</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">=</span> cor_df[[pval_name]]</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(cor_df<span class="sc">$</span>cor,</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.mat =</span> pval,</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"pie"</span>,</span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span>,  <span class="at">number.cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex =</span> <span class="fl">1.2</span>, <span class="at">cl.cex =</span> <span class="fl">1.2</span>,</span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>),</span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch.cex =</span> <span class="fl">1.4</span>,<span class="at">insig =</span> <span class="st">'label_sig'</span>,</span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">cl.ratio =</span> <span class="fl">0.4</span>,</span>
<span id="cb133-28"><a href="#cb133-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>),</span>
<span id="cb133-29"><a href="#cb133-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">colrs</span>(<span class="dv">10</span>),</span>
<span id="cb133-30"><a href="#cb133-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> title)</span>
<span id="cb133-31"><a href="#cb133-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recordPlot</span>()</span>
<span id="cb133-32"><a href="#cb133-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-33"><a href="#cb133-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-34"><a href="#cb133-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-35"><a href="#cb133-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get correlation between variable. </span></span>
<span id="cb133-36"><a href="#cb133-36" aria-hidden="true" tabindex="-1"></a><span class="co"># It will run the above correlation function for all the data </span></span>
<span id="cb133-37"><a href="#cb133-37" aria-hidden="true" tabindex="-1"></a>correlation_plot_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(cor_df, pval_name, title){</span>
<span id="cb133-38"><a href="#cb133-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(cor_df, <span class="st">"list"</span>)){</span>
<span id="cb133-39"><a href="#cb133-39" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">names</span>(cor_dfs)</span>
<span id="cb133-40"><a href="#cb133-40" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(cor_df), <span class="cf">function</span>(i) {</span>
<span id="cb133-41"><a href="#cb133-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">inherits</span>(cor_df[[i]], <span class="st">"list"</span>)){</span>
<span id="cb133-42"><a href="#cb133-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(cor_df[[i]])</span></span>
<span id="cb133-43"><a href="#cb133-43" aria-hidden="true" tabindex="-1"></a>        n1 <span class="ot">&lt;-</span> <span class="fu">names</span>(cor_df[[i]])</span>
<span id="cb133-44"><a href="#cb133-44" aria-hidden="true" tabindex="-1"></a>        p1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(cor_df[[i]]), <span class="cf">function</span>(j){</span>
<span id="cb133-45"><a href="#cb133-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">correlation_plot</span>(cor_df[[i]][[j]], pval_name,</span>
<span id="cb133-46"><a href="#cb133-46" aria-hidden="true" tabindex="-1"></a>                           <span class="at">title =</span> <span class="fu">paste0</span>(n[i], <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>,n1[j]))</span>
<span id="cb133-47"><a href="#cb133-47" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb133-48"><a href="#cb133-48" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb133-49"><a href="#cb133-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(p1) <span class="ot">&lt;-</span> n1</span>
<span id="cb133-50"><a href="#cb133-50" aria-hidden="true" tabindex="-1"></a>        p1</span>
<span id="cb133-51"><a href="#cb133-51" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb133-52"><a href="#cb133-52" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> <span class="fu">correlation_plot</span>(cor_df[[i]], pval_name, <span class="at">title =</span> n[i])</span>
<span id="cb133-53"><a href="#cb133-53" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb133-54"><a href="#cb133-54" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb133-55"><a href="#cb133-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(p) <span class="ot">&lt;-</span> n</span>
<span id="cb133-56"><a href="#cb133-56" aria-hidden="true" tabindex="-1"></a>    p</span>
<span id="cb133-57"><a href="#cb133-57" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb133-58"><a href="#cb133-58" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">correlation_plot</span>(x, pval_name, <span class="at">title =</span> title)</span>
<span id="cb133-59"><a href="#cb133-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb133-60"><a href="#cb133-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb133-61"><a href="#cb133-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-62"><a href="#cb133-62" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation is FDR corrected with "padj"</span></span>
<span id="cb133-63"><a href="#cb133-63" aria-hidden="true" tabindex="-1"></a>p_adj <span class="ot">&lt;-</span> <span class="fu">correlation_plot_helper</span>(cor_dfs, <span class="st">"padj"</span>, <span class="at">title =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-6.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-7.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-8.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-9.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-10.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-11.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-12.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-13.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-14.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-15.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-16.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-17.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-18.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-19.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-20.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-21.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-22.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-23.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-24.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-25.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-26.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-27.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-28.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-12-29.png" class="img-fluid" width="576"></p>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_adj$`Test set Current PTSD`$`Without NonCpG Probes`</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p_adj$`Test set Current PTSD`$`Without NonCpG Probes`, NULL, </span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="co">#           p_adj$`Test set Current PTSD`$`Without NonCpGXY Probes`, rel_widths = c(1,0.1,1),</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="co">#           labels = c('A', '', 'B'), align = "hv", nrow = 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plot-correlation-with-nominally-pvalue" class="level3">
<h3 class="anchored" data-anchor-id="plot-correlation-with-nominally-pvalue">Plot correlation with nominally pvalue</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>cor_p_nominal <span class="ot">&lt;-</span> <span class="fu">correlation_plot_helper</span>(cor_dfs, <span class="st">"pval"</span>, <span class="at">title =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-6.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-7.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-8.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-9.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-10.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-11.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-12.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-13.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-14.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-15.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-16.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-17.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-18.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-19.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-20.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-21.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-22.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-23.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-24.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-25.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-26.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-27.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-28.png" class="img-fluid" width="1152"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-13-29.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD scaled</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="cn">NULL</span>, </span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>          p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD scaled</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">''</span>, <span class="st">'B'</span>), <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Army cohorts</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="cn">NULL</span>, </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>          p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Army cohorts</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">''</span>, <span class="st">'B'</span>), <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Test set Lifetime PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="cn">NULL</span>, </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>          p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Test set Lifetime PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">''</span>, <span class="st">'B'</span>), <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section>
<section id="plot-individual-cohorts-in-one-plot" class="level3">
<h3 class="anchored" data-anchor-id="plot-individual-cohorts-in-one-plot">Plot Individual Cohorts in one plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="at">plotlist =</span> p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Individual Cohorts</span><span class="st">`</span>[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Individual Cohorts</span><span class="st">`</span><span class="sc">$</span>Armystarrs, <span class="cn">NULL</span>,</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>          p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Individual Cohorts</span><span class="st">`</span><span class="sc">$</span>DNHS, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="plot-for-istss.-printing-plot-twice-for-same-condition." class="level3">
<h3 class="anchored" data-anchor-id="plot-for-istss.-printing-plot-twice-for-same-condition.">Plot for ISTSS. Printing plot twice for same condition.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation_plot</span>(cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD scaled</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'padj'</span>,</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">title =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># without exposure variables in the model</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation_plot</span>(cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD scaled</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span>,</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'padj'</span>,</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">title =</span> <span class="st">'Without exposures in model'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="theme-and-linear-model-plot-function" class="level3">
<h3 class="anchored" data-anchor-id="theme-and-linear-model-plot-function">Theme and linear model plot function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># theme setting</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span>   <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">17</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">15</span>),</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>( <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="co"># function to plot with lm line</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>lm_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y, xlab, ylab, title, <span class="at">group=</span><span class="st">'ptsdpm'</span>,</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">'full'</span>, <span class="at">legend=</span><span class="st">''</span>, <span class="at">fig_legend =</span> <span class="cn">TRUE</span>){</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">'full'</span>){</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df,<span class="fu">aes_string</span>(x, y)) <span class="sc">+</span></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>( <span class="at">color=</span><span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>,</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color=</span><span class="st">"darkred"</span>, <span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.5</span>)</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df,<span class="fu">aes_string</span>(x, y, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>( <span class="at">size =</span> <span class="dv">3</span>) </span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(fig_legend){</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"================="</span>)</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_color_manual</span>(legend,</span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"#0072B5FF"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#BC3C29FF"</span>))<span class="sc">+</span></span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> group, <span class="at">color=</span>group),</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method=</span><span class="st">'lm'</span>, <span class="at">linetype=</span><span class="st">"solid"</span>,</span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">1.5</span>) <span class="co">#color="blue", fill="blue",</span></span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_color_manual</span>(legend,</span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"#0072B5FF"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#BC3C29FF"</span>))<span class="sc">+</span></span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)<span class="sc">+</span></span>
<span id="cb143-32"><a href="#cb143-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> group, <span class="at">color=</span>group),</span>
<span id="cb143-33"><a href="#cb143-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method=</span><span class="st">'lm'</span>, <span class="at">linetype=</span><span class="st">"solid"</span>,</span>
<span id="cb143-34"><a href="#cb143-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">1.5</span>) <span class="co">#color="blue", fill="blue",</span></span>
<span id="cb143-35"><a href="#cb143-35" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb143-36"><a href="#cb143-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb143-37"><a href="#cb143-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-38"><a href="#cb143-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-39"><a href="#cb143-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb143-40"><a href="#cb143-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-41"><a href="#cb143-41" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(title)<span class="sc">+</span></span>
<span id="cb143-42"><a href="#cb143-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb143-43"><a href="#cb143-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab) <span class="sc">+</span></span>
<span id="cb143-44"><a href="#cb143-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb143-45"><a href="#cb143-45" aria-hidden="true" tabindex="-1"></a>    th</span>
<span id="cb143-46"><a href="#cb143-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-47"><a href="#cb143-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>fig_legend){</span>
<span id="cb143-48"><a href="#cb143-48" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb143-49"><a href="#cb143-49" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> p</span>
<span id="cb143-50"><a href="#cb143-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="linear-model" class="level1">
<h1>linear model</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sink("G:/PGC ML/Combined Data/2022-03-30_15-07-11/Linear model PTSD summary_coeff_as_weights_selected_wd_EN_lr_0.1.txt")</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>lm_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(df, f){</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"====================================================="</span>)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  analy <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"Data frame"</span>, <span class="fu">deparse</span>(<span class="fu">substitute</span>(df))), <span class="at">collapse =</span> <span class="st">':'</span>),</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"Formula"</span>, f), <span class="at">collapse =</span> <span class="st">':'</span>)), <span class="at">collapse =</span> <span class="st">', '</span>)</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analy)</span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">names</span>(df)</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>    lmr <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(df), <span class="cf">function</span>(i){</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">lm</span>(f, <span class="at">data =</span> df[[i]])</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(n[i])</span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">summary</span>(x))</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>      x</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>    }) </span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>    lmr <span class="ot">&lt;-</span> <span class="fu">lm</span>(f, <span class="at">data =</span> df)</span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(<span class="fu">summary</span>(lmr))</span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>    lmr</span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PTSD formula</span></span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>f_cur_ptsd <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'risk_score~'</span>, <span class="st">'CurrentPTSD'</span>))</span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>f_life_ptsd <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'risk_score~'</span>, <span class="st">'LifetimePTSD'</span>))</span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a>f_ptsd <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'as.numeric(CurrentPTSD)~'</span>, <span class="st">'risk_score'</span>))</span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a>f_cur_ptsd_meth <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'meth_only_risk_score~'</span>, <span class="st">'CurrentPTSD'</span>))</span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-32"><a href="#cb144-32" aria-hidden="true" tabindex="-1"></a><span class="co"># PTSS formula</span></span>
<span id="cb144-33"><a href="#cb144-33" aria-hidden="true" tabindex="-1"></a>f_ptss <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'risk_score~'</span>, <span class="st">'Pts_Severity'</span>))</span>
<span id="cb144-34"><a href="#cb144-34" aria-hidden="true" tabindex="-1"></a>f_ptss_meth <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'meth_only_risk_score~'</span>, <span class="st">'Pts_Severity'</span>))</span>
<span id="cb144-35"><a href="#cb144-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-36"><a href="#cb144-36" aria-hidden="true" tabindex="-1"></a><span class="co"># current PTSD</span></span>
<span id="cb144-37"><a href="#cb144-37" aria-hidden="true" tabindex="-1"></a><span class="co"># lmr_adj &lt;- lm_helper(df = adj_df, f = f_cur_ptsd)</span></span>
<span id="cb144-38"><a href="#cb144-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-39"><a href="#cb144-39" aria-hidden="true" tabindex="-1"></a><span class="co"># for first two where we have risk scores</span></span>
<span id="cb144-40"><a href="#cb144-40" aria-hidden="true" tabindex="-1"></a>lmr_scaled <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>( <span class="at">df =</span> adj_sc_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">f =</span> f_cur_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df[1:2], Formula:risk_score ~ CurrentPTSD"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.53597 -0.65623  0.00982  0.60153  3.11754 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.32208    0.06074   5.303  2.2e-07 ***
CurrentPTSD1  2.11172    0.11974  17.636  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9172 on 305 degrees of freedom
Multiple R-squared:  0.5049,    Adjusted R-squared:  0.5033 
F-statistic:   311 on 1 and 305 DF,  p-value: &lt; 2.2e-16

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-2.6497 -0.5994  0.0406  0.5978  3.2584 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.13206    0.06014   2.196   0.0288 *  
CurrentPTSD1  2.15469    0.11855  18.175   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9081 on 305 degrees of freedom
Multiple R-squared:  0.5199,    Adjusted R-squared:  0.5184 
F-statistic: 330.3 on 1 and 305 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># third where we have meth risk scores only</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>lmr_scaled_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>( <span class="at">df =</span> adj_sc_df[<span class="dv">3</span>], <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df[3], Formula:meth_only_risk_score ~ CurrentPTSD"
[1] "Without NonCpGXY ProbesWoExpVar"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.76234 -0.62664  0.02109  0.65218  2.52759 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.23621    0.05895   4.007 7.74e-05 ***
CurrentPTSD1  1.61428    0.11621  13.891  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8901 on 305 degrees of freedom
Multiple R-squared:  0.3875,    Adjusted R-squared:  0.3855 
F-statistic:   193 on 1 and 305 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>lmr_indep <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df=</span> ind_sc_df_wd_score, <span class="at">f =</span> f_cur_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:ind_sc_df_wd_score, Formula:risk_score ~ CurrentPTSD"
[1] "Armystarrs"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.07109 -0.47138 -0.00396  0.40386  1.93759 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.39888    0.06965   5.727 5.36e-08 ***
CurrentPTSD1  2.31865    0.13294  17.441  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7338 on 151 degrees of freedom
Multiple R-squared:  0.6683,    Adjusted R-squared:  0.6661 
F-statistic: 304.2 on 1 and 151 DF,  p-value: &lt; 2.2e-16

[1] "DNHS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.03773 -0.45616 -0.04721  0.42701  2.03211 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    0.3123     0.0358   8.722   &lt;2e-16 ***
CurrentPTSD1   2.9539     0.1311  22.524   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7025 on 414 degrees of freedom
Multiple R-squared:  0.5506,    Adjusted R-squared:  0.5496 
F-statistic: 507.3 on 1 and 414 DF,  p-value: &lt; 2.2e-16

[1] "GTP"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.54383 -0.49270  0.00944  0.49905  2.51265 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.31916    0.04258  -7.496 3.18e-13 ***
CurrentPTSD1  3.25151    0.07382  44.046  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7652 on 482 degrees of freedom
Multiple R-squared:  0.801, Adjusted R-squared:  0.8006 
F-statistic:  1940 on 1 and 482 DF,  p-value: &lt; 2.2e-16

[1] "MRS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-3.13962 -0.50356  0.02986  0.54116  1.96388 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -0.2084     0.1206  -1.728   0.0866 .  
CurrentPTSD1   2.5740     0.1685  15.273   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9343 on 121 degrees of freedom
Multiple R-squared:  0.6585,    Adjusted R-squared:  0.6556 
F-statistic: 233.3 on 1 and 121 DF,  p-value: &lt; 2.2e-16

[1] "Prismo"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.91667 -0.55511 -0.04729  0.67458  1.81704 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    0.1523     0.1587   0.960    0.342    
CurrentPTSD1   2.7180     0.2722   9.986 2.65e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9117 on 48 degrees of freedom
Multiple R-squared:  0.6751,    Adjusted R-squared:  0.6683 
F-statistic: 99.72 on 1 and 48 DF,  p-value: 2.654e-13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>lmr_indep_meth <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df=</span> ind_sc_df_wd_score, <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:ind_sc_df_wd_score, Formula:meth_only_risk_score ~ CurrentPTSD"
[1] "Armystarrs"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8328 -0.3235  0.0488  0.3330  1.8399 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.59048    0.05705  -10.35   &lt;2e-16 ***
CurrentPTSD1  2.18081    0.10888   20.03   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.601 on 151 degrees of freedom
Multiple R-squared:  0.7265,    Adjusted R-squared:  0.7247 
F-statistic: 401.2 on 1 and 151 DF,  p-value: &lt; 2.2e-16

[1] "DNHS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.87236 -0.37947 -0.01094  0.39980  1.51367 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.27868    0.02902  -9.603   &lt;2e-16 ***
CurrentPTSD1  2.47641    0.10631  23.294   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5694 on 414 degrees of freedom
Multiple R-squared:  0.5672,    Adjusted R-squared:  0.5662 
F-statistic: 542.6 on 1 and 414 DF,  p-value: &lt; 2.2e-16

[1] "GTP"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-2.4324 -0.3692  0.0291  0.3904  2.5818 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.80454    0.03578  -22.48   &lt;2e-16 ***
CurrentPTSD1  2.66315    0.06204   42.92   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6431 on 482 degrees of freedom
Multiple R-squared:  0.7927,    Adjusted R-squared:  0.7922 
F-statistic:  1843 on 1 and 482 DF,  p-value: &lt; 2.2e-16

[1] "MRS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-2.3636 -0.3343  0.1478  0.4380  2.0136 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.1843     0.1026  -11.55   &lt;2e-16 ***
CurrentPTSD1   2.3271     0.1433   16.24   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7944 on 121 degrees of freedom
Multiple R-squared:  0.6855,    Adjusted R-squared:  0.6829 
F-statistic: 263.7 on 1 and 121 DF,  p-value: &lt; 2.2e-16

[1] "Prismo"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.32474 -0.20848  0.07295  0.35425  1.36104 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -0.7583     0.1109  -6.838 1.30e-08 ***
CurrentPTSD1   2.1004     0.1902  11.045 8.86e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.637 on 48 degrees of freedom
Multiple R-squared:  0.7176,    Adjusted R-squared:  0.7117 
F-statistic:   122 on 1 and 48 DF,  p-value: 8.862e-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>lmr_indep_test <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df=</span> ind_sc_df_test_wd_score, <span class="at">f =</span> f_cur_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:ind_sc_df_test_wd_score, Formula:risk_score ~ CurrentPTSD"
[1] "Armystarrs"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-1.4159 -0.5947 -0.1226  0.3362  2.5747 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -0.2147     0.1651  -1.301    0.201    
CurrentPTSD1   1.5186     0.2976   5.104 1.02e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8577 on 37 degrees of freedom
Multiple R-squared:  0.4131,    Adjusted R-squared:  0.3973 
F-statistic: 26.05 on 1 and 37 DF,  p-value: 1.024e-05

[1] "DNHS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.66429 -0.54166  0.04247  0.54842  2.13808 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.69722    0.08114   8.593 6.04e-14 ***
CurrentPTSD1  2.75859    0.30495   9.046 5.59e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8314 on 111 degrees of freedom
Multiple R-squared:  0.4244,    Adjusted R-squared:  0.4192 
F-statistic: 81.83 on 1 and 111 DF,  p-value: 5.593e-15

[1] "GTP"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-2.0218 -0.6466  0.0265  0.5575  2.6254 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -0.1883     0.1034  -1.821   0.0712 .  
CurrentPTSD1   2.9929     0.1740  17.198   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9072 on 117 degrees of freedom
Multiple R-squared:  0.7166,    Adjusted R-squared:  0.7141 
F-statistic: 295.8 on 1 and 117 DF,  p-value: &lt; 2.2e-16

[1] "MRS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-2.4247 -0.6002  0.1190  0.8591  1.7395 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)    0.2348     0.2915   0.806  0.42772   
CurrentPTSD1   1.3499     0.4122   3.275  0.00299 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.091 on 26 degrees of freedom
Multiple R-squared:  0.292, Adjusted R-squared:  0.2648 
F-statistic: 10.72 on 1 and 26 DF,  p-value: 0.002991

[1] "Prismo"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-1.5713 -0.5816  0.1970  0.7492  0.8519 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)    0.2484     0.4294   0.578    0.584  
CurrentPTSD1   2.0605     0.7012   2.938    0.026 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9602 on 6 degrees of freedom
Multiple R-squared:   0.59, Adjusted R-squared:  0.5217 
F-statistic: 8.634 on 1 and 6 DF,  p-value: 0.026</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>lmr_indep_meth_test <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df=</span> ind_sc_df_test_wd_score, <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:ind_sc_df_test_wd_score, Formula:meth_only_risk_score ~ CurrentPTSD"
[1] "Armystarrs"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.16569 -0.46926 -0.03328  0.46936  1.63620 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -0.3868     0.1262  -3.065  0.00405 ** 
CurrentPTSD1   1.4002     0.2275   6.155 3.87e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6557 on 37 degrees of freedom
Multiple R-squared:  0.5059,    Adjusted R-squared:  0.4926 
F-statistic: 37.89 on 1 and 37 DF,  p-value: 3.871e-07

[1] "DNHS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.66822 -0.43463  0.05511  0.46852  1.27676 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.04177    0.06425   -0.65    0.517    
CurrentPTSD1  1.91007    0.24149    7.91 2.08e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6584 on 111 degrees of freedom
Multiple R-squared:  0.3605,    Adjusted R-squared:  0.3547 
F-statistic: 62.56 on 1 and 111 DF,  p-value: 2.085e-12

[1] "GTP"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.04949 -0.52405 -0.00393  0.55017  2.06564 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.67240    0.08663  -7.762 3.48e-12 ***
CurrentPTSD1  2.14806    0.14581  14.731  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7601 on 117 degrees of freedom
Multiple R-squared:  0.6497,    Adjusted R-squared:  0.6467 
F-statistic:   217 on 1 and 117 DF,  p-value: &lt; 2.2e-16

[1] "MRS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.83990 -0.64299  0.08256  0.68683  1.39515 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.0549     0.2417  -4.364  0.00018 ***
CurrentPTSD1   1.2138     0.3418   3.551  0.00149 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9044 on 26 degrees of freedom
Multiple R-squared:  0.3266,    Adjusted R-squared:  0.3007 
F-statistic: 12.61 on 1 and 26 DF,  p-value: 0.00149

[1] "Prismo"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.71231 -0.26031 -0.03805  0.17684  0.99576 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   -0.9596     0.2678  -3.584   0.0116 *
CurrentPTSD1   1.0769     0.4372   2.463   0.0489 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5987 on 6 degrees of freedom
Multiple R-squared:  0.5028,    Adjusted R-squared:  0.4199 
F-statistic: 6.067 on 1 and 6 DF,  p-value: 0.04892</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>lmr_indep_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df=</span> ind_sc_df_wo_exp_in_model, <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:ind_sc_df_wo_exp_in_model, Formula:meth_only_risk_score ~ CurrentPTSD"
[1] "Armystarrs"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9485 -0.3250  0.0242  0.3755  2.0461 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.03964    0.05854   0.677    0.499    
CurrentPTSD1  2.18146    0.11174  19.523   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6168 on 151 degrees of freedom
Multiple R-squared:  0.7162,    Adjusted R-squared:  0.7144 
F-statistic: 381.2 on 1 and 151 DF,  p-value: &lt; 2.2e-16

[1] "DNHS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9575 -0.3952 -0.0209  0.4021  1.6281 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.33591    0.03067   10.95   &lt;2e-16 ***
CurrentPTSD1  2.58967    0.11235   23.05   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6018 on 414 degrees of freedom
Multiple R-squared:  0.562, Adjusted R-squared:  0.561 
F-statistic: 531.3 on 1 and 414 DF,  p-value: &lt; 2.2e-16

[1] "GTP"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.68645 -0.39729  0.03967  0.43585  2.77886 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.21228    0.03911  -5.428 9.06e-08 ***
CurrentPTSD1  2.86044    0.06781  42.181  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7029 on 482 degrees of freedom
Multiple R-squared:  0.7868,    Adjusted R-squared:  0.7864 
F-statistic:  1779 on 1 and 482 DF,  p-value: &lt; 2.2e-16

[1] "MRS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-2.5925 -0.3886  0.1475  0.5022  2.1396 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -0.6595     0.1142  -5.773 6.14e-08 ***
CurrentPTSD1   2.5505     0.1596  15.979  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8849 on 121 degrees of freedom
Multiple R-squared:  0.6785,    Adjusted R-squared:  0.6758 
F-statistic: 255.3 on 1 and 121 DF,  p-value: &lt; 2.2e-16

[1] "Prismo"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.24828 -0.26519  0.04905  0.35005  1.37337 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -0.1253     0.1091  -1.149    0.256    
CurrentPTSD1   2.0861     0.1870  11.153  6.3e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6265 on 48 degrees of freedom
Multiple R-squared:  0.7216,    Adjusted R-squared:  0.7158 
F-statistic: 124.4 on 1 and 48 DF,  p-value: 6.304e-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>lmr_ind_ptsd <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df=</span> ind_sc_df_wd_score, <span class="at">f =</span> f_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:ind_sc_df_wd_score, Formula:as.numeric(CurrentPTSD) ~ risk_score"
[1] "Armystarrs"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.63278 -0.17126 -0.03634  0.15907  0.83759 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.97610    0.02702   36.12   &lt;2e-16 ***
risk_score   0.28822    0.01653   17.44   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2587 on 151 degrees of freedom
Multiple R-squared:  0.6683,    Adjusted R-squared:  0.6661 
F-statistic: 304.2 on 1 and 151 DF,  p-value: &lt; 2.2e-16

[1] "DNHS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.38826 -0.10397 -0.01729  0.07150  0.79573 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.975279   0.009709  100.45   &lt;2e-16 ***
risk_score  0.186412   0.008276   22.52   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1765 on 414 degrees of freedom
Multiple R-squared:  0.5506,    Adjusted R-squared:  0.5496 
F-statistic: 507.3 on 1 and 414 DF,  p-value: &lt; 2.2e-16

[1] "GTP"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.68518 -0.15875 -0.00753  0.15035  0.59470 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.144821   0.010480  109.23   &lt;2e-16 ***
risk_score  0.246345   0.005593   44.05   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2106 on 482 degrees of freedom
Multiple R-squared:  0.801, Adjusted R-squared:  0.8006 
F-statistic:  1940 on 1 and 482 DF,  p-value: &lt; 2.2e-16

[1] "MRS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.65864 -0.19148  0.00104  0.18947  0.96974 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.22824    0.03242   37.89   &lt;2e-16 ***
risk_score   0.25581    0.01675   15.27   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2945 on 121 degrees of freedom
Multiple R-squared:  0.6585,    Adjusted R-squared:  0.6556 
F-statistic: 233.3 on 1 and 121 DF,  p-value: &lt; 2.2e-16

[1] "Prismo"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.56176 -0.23546  0.01966  0.20409  0.58891 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.07266    0.04729  22.685  &lt; 2e-16 ***
risk_score   0.24836    0.02487   9.986 2.65e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2756 on 48 degrees of freedom
Multiple R-squared:  0.6751,    Adjusted R-squared:  0.6683 
F-statistic: 99.72 on 1 and 48 DF,  p-value: 2.654e-13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>lmr_meth <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>( <span class="at">df =</span> adj_sc_df, <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df, Formula:meth_only_risk_score ~ CurrentPTSD"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.47898 -0.55352  0.02981  0.59124  2.15533 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.24587    0.05193  -4.734 3.37e-06 ***
CurrentPTSD1  1.43425    0.10238  14.009  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7842 on 305 degrees of freedom
Multiple R-squared:  0.3915,    Adjusted R-squared:  0.3895 
F-statistic: 196.3 on 1 and 305 DF,  p-value: &lt; 2.2e-16

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.51685 -0.56610  0.03961  0.61107  2.38101 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.37794    0.05462   -6.92 2.67e-11 ***
CurrentPTSD1  1.53823    0.10767   14.29  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8247 on 305 degrees of freedom
Multiple R-squared:  0.4009,    Adjusted R-squared:  0.3989 
F-statistic: 204.1 on 1 and 305 DF,  p-value: &lt; 2.2e-16

[1] "Without NonCpGXY ProbesWoExpVar"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.76234 -0.62664  0.02109  0.65218  2.52759 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.23621    0.05895   4.007 7.74e-05 ***
CurrentPTSD1  1.61428    0.11621  13.891  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8901 on 305 degrees of freedom
Multiple R-squared:  0.3875,    Adjusted R-squared:  0.3855 
F-statistic:   193 on 1 and 305 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>lmr_ptsd <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>( <span class="at">df =</span> adj_sc_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">f =</span> f_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df[1:2], Formula:as.numeric(CurrentPTSD) ~ risk_score"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-0.7729 -0.2262 -0.0673  0.1346  0.9740 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.05039    0.02116   49.63   &lt;2e-16 ***
risk_score   0.23909    0.01356   17.64   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3086 on 305 degrees of freedom
Multiple R-squared:  0.5049,    Adjusted R-squared:  0.5033 
F-statistic:   311 on 1 and 305 DF,  p-value: &lt; 2.2e-16

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-0.69449 -0.21982 -0.05769  0.14489  0.99591 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.09167    0.01959   55.72   &lt;2e-16 ***
risk_score   0.24130    0.01328   18.18   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3039 on 305 degrees of freedom
Multiple R-squared:  0.5199,    Adjusted R-squared:  0.5184 
F-statistic: 330.3 on 1 and 305 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>lmr_scaled_ptss <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>( <span class="at">df =</span> adj_sc_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">f =</span> f_ptss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df[1:2], Formula:risk_score ~ Pts_Severity"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8940 -0.6930 -0.1181  0.5443  3.3189 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.561955   0.127348  -4.413 1.56e-05 ***
Pts_Severity  0.034895   0.002966  11.766  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.959 on 235 degrees of freedom
  (70 observations deleted due to missingness)
Multiple R-squared:  0.3707,    Adjusted R-squared:  0.368 
F-statistic: 138.4 on 1 and 235 DF,  p-value: &lt; 2.2e-16

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.98792 -0.67659 -0.09895  0.60817  3.04173 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.706519   0.128023  -5.519    9e-08 ***
Pts_Severity  0.034213   0.002982  11.475   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.964 on 235 degrees of freedom
  (70 observations deleted due to missingness)
Multiple R-squared:  0.3591,    Adjusted R-squared:  0.3564 
F-statistic: 131.7 on 1 and 235 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>lmr_scaled_ptss_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>( <span class="at">df =</span> adj_sc_df[<span class="dv">3</span>], <span class="at">f =</span> f_ptss_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df[3], Formula:meth_only_risk_score ~ Pts_Severity"
[1] "Without NonCpGXY ProbesWoExpVar"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.66693 -0.67904 -0.02891  0.65656  2.47458 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.240141   0.127700  -1.881   0.0613 .  
Pts_Severity  0.023638   0.002974   7.948 7.88e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9616 on 235 degrees of freedom
  (70 observations deleted due to missingness)
Multiple R-squared:  0.2119,    Adjusted R-squared:  0.2085 
F-statistic: 63.18 on 1 and 235 DF,  p-value: 7.875e-14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>lmr_meth_ptss <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>( <span class="at">df =</span> adj_sc_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">f =</span> f_ptss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df[1:2], Formula:risk_score ~ Pts_Severity"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8940 -0.6930 -0.1181  0.5443  3.3189 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.561955   0.127348  -4.413 1.56e-05 ***
Pts_Severity  0.034895   0.002966  11.766  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.959 on 235 degrees of freedom
  (70 observations deleted due to missingness)
Multiple R-squared:  0.3707,    Adjusted R-squared:  0.368 
F-statistic: 138.4 on 1 and 235 DF,  p-value: &lt; 2.2e-16

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.98792 -0.67659 -0.09895  0.60817  3.04173 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.706519   0.128023  -5.519    9e-08 ***
Pts_Severity  0.034213   0.002982  11.475   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.964 on 235 degrees of freedom
  (70 observations deleted due to missingness)
Multiple R-squared:  0.3591,    Adjusted R-squared:  0.3564 
F-statistic: 131.7 on 1 and 235 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>lmr_army <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df =</span> army_sc_df, <span class="at">f =</span> f_cur_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:army_sc_df, Formula:risk_score ~ CurrentPTSD"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.20402 -0.58197 -0.07243  0.56119  2.48904 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.06901    0.06169   1.119    0.264    
CurrentPTSD1  2.43317    0.10084  24.130   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8811 on 324 degrees of freedom
Multiple R-squared:  0.6425,    Adjusted R-squared:  0.6414 
F-statistic: 582.3 on 1 and 324 DF,  p-value: &lt; 2.2e-16

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.37646 -0.56628 -0.02432  0.53041  2.49274 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.16138    0.05958  -2.709  0.00711 ** 
CurrentPTSD1  2.54239    0.09739  26.105  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.851 on 324 degrees of freedom
Multiple R-squared:  0.6778,    Adjusted R-squared:  0.6768 
F-statistic: 681.5 on 1 and 324 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>lmr_scaled_life <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(adj_life_sc_df, <span class="at">f =</span> f_life_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_life_sc_df, Formula:risk_score ~ LifetimePTSD"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8999 -0.6741  0.0224  0.6317  3.4106 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    0.18862    0.07433   2.538   0.0117 *  
LifetimePTSD1  1.77433    0.12382  14.330   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.043 on 306 degrees of freedom
Multiple R-squared:  0.4016,    Adjusted R-squared:  0.3996 
F-statistic: 205.4 on 1 and 306 DF,  p-value: &lt; 2.2e-16

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7258 -0.7086  0.0169  0.6464  3.3908 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    0.04229    0.07571   0.559    0.577    
LifetimePTSD1  1.76124    0.12611  13.966   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.063 on 306 degrees of freedom
Multiple R-squared:  0.3893,    Adjusted R-squared:  0.3873 
F-statistic: 195.1 on 1 and 306 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># association between mean methylation in datasets with </span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="co"># positive and negative coefficients</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>f_pos <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'mean_meth~'</span>, <span class="st">'CurrentPTSD'</span>))</span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>lmr_pos <span class="ot">=</span> <span class="fu">lm_helper</span>(adj_sc_df_pos, f_pos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df_pos, Formula:mean_meth ~ CurrentPTSD"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0211129 -0.0050827 -0.0002522  0.0050363  0.0207822 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.4991740  0.0005102 978.460  &lt; 2e-16 ***
CurrentPTSD1 0.0049972  0.0010057   4.969 1.12e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007703 on 305 degrees of freedom
Multiple R-squared:  0.07489,   Adjusted R-squared:  0.07186 
F-statistic: 24.69 on 1 and 305 DF,  p-value: 1.124e-06

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0202233 -0.0050940 -0.0005408  0.0048594  0.0215928 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.4992610  0.0005076 983.528  &lt; 2e-16 ***
CurrentPTSD1 0.0045995  0.0010007   4.596  6.3e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007665 on 305 degrees of freedom
Multiple R-squared:  0.06478,   Adjusted R-squared:  0.06171 
F-statistic: 21.13 on 1 and 305 DF,  p-value: 6.305e-06

[1] "Without NonCpGXY ProbesWoExpVar"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0201312 -0.0048991 -0.0005723  0.0047069  0.0218388 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.4992608  0.0005075 983.670  &lt; 2e-16 ***
CurrentPTSD1 0.0045341  0.0010005   4.532 8.41e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007664 on 305 degrees of freedom
Multiple R-squared:  0.06308,   Adjusted R-squared:  0.06001 
F-statistic: 20.54 on 1 and 305 DF,  p-value: 8.411e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>lmr_neg <span class="ot">=</span> <span class="fu">lm_helper</span>(adj_sc_df_neg, f_pos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df_neg, Formula:mean_meth ~ CurrentPTSD"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0219016 -0.0049024  0.0000199  0.0047911  0.0211929 

Coefficients:
               Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept)   0.5005418  0.0004892 1023.100   &lt;2e-16 ***
CurrentPTSD1 -0.0013327  0.0009644   -1.382    0.168    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007387 on 305 degrees of freedom
Multiple R-squared:  0.006222,  Adjusted R-squared:  0.002963 
F-statistic:  1.91 on 1 and 305 DF,  p-value: 0.168

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0218394 -0.0050350  0.0000715  0.0048811  0.0209081 

Coefficients:
               Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept)   0.5006234  0.0004888 1024.251   &lt;2e-16 ***
CurrentPTSD1 -0.0015143  0.0009635   -1.572    0.117    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.00738 on 305 degrees of freedom
Multiple R-squared:  0.008034,  Adjusted R-squared:  0.004781 
F-statistic:  2.47 on 1 and 305 DF,  p-value: 0.1171

[1] "Without NonCpGXY ProbesWoExpVar"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0216125 -0.0049001 -0.0000301  0.0049316  0.0211275 

Coefficients:
              Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept)   0.500610   0.000488 1025.830   &lt;2e-16 ***
CurrentPTSD1 -0.001393   0.000962   -1.448    0.149    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007369 on 305 degrees of freedom
Multiple R-squared:  0.006826,  Adjusted R-squared:  0.00357 
F-statistic: 2.096 on 1 and 305 DF,  p-value: 0.1487</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># risk scores vs mean methylation</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>f_rc <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'mean_meth~'</span>, <span class="st">'risk_score'</span>))</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>lmr_meth_sc <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df =</span> adj_sc_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">f =</span>f_rc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df[1:2], Formula:mean_meth ~ risk_score"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
      Min        1Q    Median        3Q       Max 
-0.020184 -0.004855 -0.000134  0.005219  0.020752 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.4997668  0.0005031 993.414   &lt;2e-16 ***
risk_score  0.0006234  0.0003223   1.935    0.054 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007336 on 305 degrees of freedom
Multiple R-squared:  0.01212,   Adjusted R-squared:  0.008882 
F-statistic: 3.742 on 1 and 305 DF,  p-value: 0.05397

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0206719 -0.0047538 -0.0002014  0.0053987  0.0207937 

Coefficients:
             Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept) 0.4999798  0.0004720 1059.288   &lt;2e-16 ***
risk_score  0.0005271  0.0003198    1.648      0.1    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007321 on 305 degrees of freedom
Multiple R-squared:  0.008827,  Adjusted R-squared:  0.005578 
F-statistic: 2.716 on 1 and 305 DF,  p-value: 0.1004</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cumulative trauma vs mean methylation</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>f_trma <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'mean_meth~'</span>, <span class="st">'TraumaNumber'</span>))</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>lmr_ct_meth_sc <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df =</span> adj_sc_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], f_trma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df[1:2], Formula:mean_meth ~ TraumaNumber"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0203780 -0.0045649 -0.0003155  0.0052297  0.0208649 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.5008185  0.0006395 783.100   &lt;2e-16 ***
TraumaNumber -0.0020230  0.0019034  -1.063    0.289    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007367 on 305 degrees of freedom
Multiple R-squared:  0.00369,   Adjusted R-squared:  0.0004232 
F-statistic:  1.13 on 1 and 305 DF,  p-value: 0.2887

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
      Min        1Q    Median        3Q       Max 
-0.021031 -0.004595 -0.000328  0.005259  0.021032 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.5008950  0.0006369 786.416   &lt;2e-16 ***
TraumaNumber -0.0021856  0.0018957  -1.153     0.25    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007337 on 305 degrees of freedom
Multiple R-squared:  0.004339,  Adjusted R-squared:  0.001075 
F-statistic: 1.329 on 1 and 305 DF,  p-value: 0.2498</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># childhood maltreatment vs mean methylation</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>f_ch_trma <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'mean_meth~'</span>, <span class="st">'ChildhoodMaltreatment'</span>))</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>lmr_chd_meth_sc <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df =</span> adj_sc_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], f_ch_trma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df[1:2], Formula:mean_meth ~ ChildhoodMaltreatment"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0199786 -0.0048269 -0.0002544  0.0051957  0.0203279 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           0.5000618  0.0005927 843.637   &lt;2e-16 ***
ChildhoodMaltreatment 0.0012041  0.0020547   0.586    0.558    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007377 on 305 degrees of freedom
Multiple R-squared:  0.001125,  Adjusted R-squared:  -0.00215 
F-statistic: 0.3434 on 1 and 305 DF,  p-value: 0.5583

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0206894 -0.0048263 -0.0001557  0.0052032  0.0204326 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           0.5001752  0.0005907   846.7   &lt;2e-16 ***
ChildhoodMaltreatment 0.0008196  0.0020476     0.4    0.689    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007351 on 305 degrees of freedom
Multiple R-squared:  0.000525,  Adjusted R-squared:  -0.002752 
F-statistic: 0.1602 on 1 and 305 DF,  p-value: 0.6892</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sink()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="lm-for-mean-methylation-and-risk-scores" class="level1">
<h1>lm for mean methylation and risk scores</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>p_meth_adj_sep <span class="ot">&lt;-</span> <span class="fu">lm_plot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'mean_meth'</span>,</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">"Risk score"</span>,</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab  =</span> <span class="st">"Mean methylation"</span>,</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">model =</span> <span class="st">'seperate'</span>,</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend =</span> <span class="st">''</span>,</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Test set adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpG Probes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation ideoms with `aes()`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>p_meth_adj_sep1 <span class="ot">&lt;-</span> <span class="fu">lm_plot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> <span class="st">'mean_meth'</span>,</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">xlab  =</span> <span class="st">"Risk score"</span>,</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="st">'seperate'</span>,</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">group =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">legend =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">title =</span> <span class="st">"Test set adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpGXY Probes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "================="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_adj_sep</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>p_meth_adj_ptss <span class="ot">&lt;-</span> <span class="fu">lm_plot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">"Risk score"</span>,</span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab  =</span> <span class="st">"PTSS"</span>,</span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">model =</span> <span class="st">'seperate'</span>,</span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend =</span> <span class="st">''</span>,</span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Test set adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpG Probes"</span>)</span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>p_meth_adj_ptss1 <span class="ot">&lt;-</span> <span class="fu">lm_plot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab  =</span> <span class="st">"Risk score"</span>,</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">model =</span> <span class="st">'seperate'</span>,</span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Test set adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpGXY Probes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "================="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_meth_adj_sep, p_meth_adj_sep1, </span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>),</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="st">'AUTO'</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_meth_adj_ptss, p_meth_adj_ptss1,</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>),</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="st">'AUTO'</span></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 70 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 70 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 70 rows containing non-finite values (`stat_smooth()`).
Removed 70 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p_meth_sep, p_meth_adj_sep, </span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           p_meth_sep_l, p_meth_adj_sep_l, labels = 'AUTO'</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="co">#           )</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------lm for negative and positive coeff</span></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_adj_neg &lt;- lm_plot(df = adj_sc_df_neg$`Without NonCpG Probes`, x = 'risk_score',</span></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                           y = 'mean_meth',</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                           xlab = "Risk score",</span></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab  = "Mean methylation",</span></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                           model = 'seperate',</span></span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                           group = "CurrentPTSD",</span></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                           fig_legend = FALSE,</span></span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                           legend = '',</span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                           title = "Test set adjusted and scaled: \n Without NonCpG Probes")</span></span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_adj_neg1 &lt;- lm_plot(df = adj_sc_df_neg$`Without NonCpGXY Probes`, x = 'risk_score',</span></span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                           y = 'mean_meth',</span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                           xlab  = "Risk score",</span></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "",</span></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                           model = 'seperate',</span></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                           group = "CurrentPTSD",</span></span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                           fig_legend = TRUE,</span></span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                           legend = 'Current PTSD',</span></span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                           title = "Test set adjusted and scaled: \n Without NonCpGXY Probes")</span></span>
<span id="cb200-28"><a href="#cb200-28" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb200-29"><a href="#cb200-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p_meth_adj_neg, p_meth_adj_neg1,</span></span>
<span id="cb200-30"><a href="#cb200-30" aria-hidden="true" tabindex="-1"></a><span class="co">#            labels = 'AUTO'</span></span>
<span id="cb200-31"><a href="#cb200-31" aria-hidden="true" tabindex="-1"></a><span class="co">#           )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plot-for-sobp-poster" class="level3">
<h3 class="anchored" data-anchor-id="plot-for-sobp-poster">Plot for SOBP poster</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_adj_sep &lt;- lm_plot(df = adj_sc_df, x = 'risk_score',</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                           y = 'mean_meth',</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                           xlab = "Risk score",</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "Mean methylation",</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                           model = 'seperate',</span></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                           group = "CurrentPTSD",</span></span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                           legend = 'Current PTSD',</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                           title = "")</span></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_adj_sep</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="density-plot-function" class="level3">
<h3 class="anchored" data-anchor-id="density-plot-function">Density plot function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>make_densityplot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y, xlab, ylab, <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">''</span>, <span class="at">legend =</span> <span class="st">''</span>, <span class="at">facet =</span> <span class="cn">FALSE</span>){</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.numeric</span>(df[[x]])){</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">seq</span>(<span class="fu">min</span>(df[, x], <span class="at">na.rm =</span> T), <span class="fu">max</span>(df[, x], <span class="at">na.rm =</span> T), <span class="dv">1</span>))</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes_string</span>(<span class="at">x=</span>x, <span class="at">group=</span>y, <span class="at">fill=</span>y)) <span class="sc">+</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="fl">1.5</span>, <span class="at">alpha=</span>.<span class="dv">8</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> b)</span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes_string</span>(<span class="at">x=</span>x, <span class="at">group=</span>y, <span class="at">fill=</span>y)) <span class="sc">+</span></span>
<span id="cb202-10"><a href="#cb202-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="fl">1.5</span>, <span class="at">alpha=</span>.<span class="dv">8</span>)</span>
<span id="cb202-11"><a href="#cb202-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb202-12"><a href="#cb202-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb202-13"><a href="#cb202-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb202-14"><a href="#cb202-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#theme_classic()</span></span>
<span id="cb202-15"><a href="#cb202-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb202-16"><a href="#cb202-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(facet <span class="sc">!=</span> <span class="cn">FALSE</span>){</span>
<span id="cb202-17"><a href="#cb202-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">'Adding facet'</span>)</span>
<span id="cb202-18"><a href="#cb202-18" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, facet)))<span class="sc">+</span></span>
<span id="cb202-19"><a href="#cb202-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb202-20"><a href="#cb202-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb202-21"><a href="#cb202-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb202-22"><a href="#cb202-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb202-23"><a href="#cb202-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fig_legend){</span>
<span id="cb202-24"><a href="#cb202-24" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(legend,</span>
<span id="cb202-25"><a href="#cb202-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values  =</span> <span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">"#BC3C29FF"</span>))</span>
<span id="cb202-26"><a href="#cb202-26" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb202-27"><a href="#cb202-27" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(legend,</span>
<span id="cb202-28"><a href="#cb202-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values  =</span> <span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">"#BC3C29FF"</span>)) <span class="sc">+</span></span>
<span id="cb202-29"><a href="#cb202-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb202-30"><a href="#cb202-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb202-31"><a href="#cb202-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-32"><a href="#cb202-32" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(title) <span class="sc">+</span></span>
<span id="cb202-33"><a href="#cb202-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb202-34"><a href="#cb202-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab)<span class="sc">+</span> th</span>
<span id="cb202-35"><a href="#cb202-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for risk scores</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>p1_sc_d <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># legend = "Current PTSD",</span></span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">"Test set covariate adjusted and scaled :</span><span class="sc">\n</span><span class="st">Without NonCpG Probes"</span>)</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_sc_d</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>p1_sc_d1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">legend =</span> <span class="st">"Current PTSD"</span>,</span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">"Test set covariate adjusted and scaled :</span><span class="sc">\n</span><span class="st">Without NonCpGXY Probes"</span>)</span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true" tabindex="-1"></a>p1_army_sc_d <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> army_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb203-25"><a href="#cb203-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb203-26"><a href="#cb203-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb203-27"><a href="#cb203-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="co"># legend = "Current PTSD",</span></span>
<span id="cb203-28"><a href="#cb203-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"Covariate adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpG Probes </span><span class="sc">\n</span><span class="st"> (3 Army cohorts) "</span>)</span>
<span id="cb203-29"><a href="#cb203-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-30"><a href="#cb203-30" aria-hidden="true" tabindex="-1"></a>p1_army_sc_d1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> army_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb203-31"><a href="#cb203-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb203-32"><a href="#cb203-32" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb203-33"><a href="#cb203-33" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb203-34"><a href="#cb203-34" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb203-35"><a href="#cb203-35" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">legend =</span> <span class="st">"Current PTSD"</span>,</span>
<span id="cb203-36"><a href="#cb203-36" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="st">"Covariate adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpGXY Probes </span><span class="sc">\n</span><span class="st"> (3 Army cohorts) "</span>)</span>
<span id="cb203-37"><a href="#cb203-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-38"><a href="#cb203-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-39"><a href="#cb203-39" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1_sc_d, p1_sc_d1, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.3</span>, <span class="dv">2</span>),</span>
<span id="cb203-40"><a href="#cb203-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="st">'AUTO'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="1248"></p>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1_army_sc_d, p1_army_sc_d1, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>),</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="st">'AUTO'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="1248"></p>
</div>
</div>
</section>
<section id="density-plots-for-individual-cohorts" class="level3">
<h3 class="anchored" data-anchor-id="density-plots-for-individual-cohorts">Density plots for Individual Cohorts</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for risk scores</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>risk_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"risk_score"</span>, <span class="st">"meth_only_risk_score"</span>)</span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>independent_plots <span class="ot">&lt;-</span> <span class="cf">function</span>(vars, indp_dfs, <span class="at">wo_exp=</span><span class="cn">FALSE</span>){</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(vars), <span class="cf">function</span>(j){</span>
<span id="cb205-7"><a href="#cb205-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print("Risk scores variables :", x)</span></span>
<span id="cb205-8"><a href="#cb205-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb205-9"><a href="#cb205-9" aria-hidden="true" tabindex="-1"></a>  ind_den_plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(indp_dfs), <span class="cf">function</span>(i){</span>
<span id="cb205-10"><a href="#cb205-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">5</span>){</span>
<span id="cb205-11"><a href="#cb205-11" aria-hidden="true" tabindex="-1"></a>    fig_legend <span class="ot">=</span> <span class="cn">TRUE</span> <span class="co"># change this to true for legend later</span></span>
<span id="cb205-12"><a href="#cb205-12" aria-hidden="true" tabindex="-1"></a>    legend <span class="ot">=</span> <span class="st">"Current PTSD"</span></span>
<span id="cb205-13"><a href="#cb205-13" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb205-14"><a href="#cb205-14" aria-hidden="true" tabindex="-1"></a>    fig_legend <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb205-15"><a href="#cb205-15" aria-hidden="true" tabindex="-1"></a>    legend <span class="ot">=</span> <span class="st">"test"</span></span>
<span id="cb205-16"><a href="#cb205-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb205-17"><a href="#cb205-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(wo_exp <span class="sc">|</span> j <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb205-18"><a href="#cb205-18" aria-hidden="true" tabindex="-1"></a>      xlab <span class="ot">=</span> <span class="st">'Methylation risk score'</span></span>
<span id="cb205-19"><a href="#cb205-19" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span> (j <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb205-20"><a href="#cb205-20" aria-hidden="true" tabindex="-1"></a>      xlab <span class="ot">=</span> <span class="st">'Risk score'</span></span>
<span id="cb205-21"><a href="#cb205-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb205-22"><a href="#cb205-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb205-23"><a href="#cb205-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make_densityplot</span>(<span class="at">df =</span> indp_dfs[[i]], </span>
<span id="cb205-24"><a href="#cb205-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> vars[j],</span>
<span id="cb205-25"><a href="#cb205-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb205-26"><a href="#cb205-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> xlab,</span>
<span id="cb205-27"><a href="#cb205-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb205-28"><a href="#cb205-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fig_legend =</span> fig_legend,</span>
<span id="cb205-29"><a href="#cb205-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend =</span> legend,</span>
<span id="cb205-30"><a href="#cb205-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">title =</span> <span class="fu">names</span>(indp_dfs)[i])</span>
<span id="cb205-31"><a href="#cb205-31" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb205-32"><a href="#cb205-32" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb205-33"><a href="#cb205-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb205-34"><a href="#cb205-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb205-35"><a href="#cb205-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-36"><a href="#cb205-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-37"><a href="#cb205-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-38"><a href="#cb205-38" aria-hidden="true" tabindex="-1"></a><span class="co"># ind_den_plots</span></span>
<span id="cb205-39"><a href="#cb205-39" aria-hidden="true" tabindex="-1"></a>ind_den_plots <span class="ot">&lt;-</span> <span class="fu">independent_plots</span>(<span class="at">vars =</span> risk_vars, <span class="at">indp_dfs =</span> ind_sc_df_wd_score)</span>
<span id="cb205-40"><a href="#cb205-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-41"><a href="#cb205-41" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_den_plots[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb205-42"><a href="#cb205-42" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_den_plots[[<span class="dv">1</span>]][<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb205-43"><a href="#cb205-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb205-44"><a href="#cb205-44" aria-hidden="true" tabindex="-1"></a>p1_p2_ind <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb205-45"><a href="#cb205-45" aria-hidden="true" tabindex="-1"></a>indp_cohorts.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Individual cohorts"</span>, </span>
<span id="cb205-46"><a href="#cb205-46" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>))</span>
<span id="cb205-47"><a href="#cb205-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-48"><a href="#cb205-48" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p1_p2_ind, <span class="at">top =</span> indp_cohorts.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(plot_grid(plotlist = ind_den_plots[1:4], cols = 3),</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="co">#          plot_grid(ind_den_plots[5],    rel_widths = 1))</span></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>p1_m <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_den_plots[[<span class="dv">2</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>p2_m <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_den_plots[[<span class="dv">2</span>]][<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>p1_p2_ind_m <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1_m,p2_m, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>indp_cohorts_wo_exp.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Individual cohorts without exposure variables"</span>, </span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>))</span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p1_p2_ind_m, <span class="at">top =</span> indp_cohorts_wo_exp.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="weights-from-without-exposure-variables-model" class="level3">
<h3 class="anchored" data-anchor-id="weights-from-without-exposure-variables-model">Weights from Without exposure variables model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ind_den_plots</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>ind_den_plots_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">independent_plots</span>(<span class="at">vars =</span> risk_vars[<span class="dv">2</span>], </span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">indp_dfs =</span> ind_sc_df_wo_exp_in_model,</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">wo_exp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>p1_m_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_den_plots_wo_exp_in_model[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>p2_m_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_den_plots_wo_exp_in_model[[<span class="dv">1</span>]][<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>p1_p2_ind_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1_m_wo_exp_in_model, p2_m_wo_exp_in_model, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a>indp_cohorts_wo_exp_in_model.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Individual cohorts without exposure variables in the model"</span>, </span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>))</span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-15"><a href="#cb207-15" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p1_p2_ind_wo_exp_in_model, <span class="at">top =</span> indp_cohorts_wo_exp_in_model.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="independent-cohorts-test-set" class="level3">
<h3 class="anchored" data-anchor-id="independent-cohorts-test-set">independent cohorts test set</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>ind_test_den_plots <span class="ot">&lt;-</span> <span class="fu">independent_plots</span>(<span class="at">vars =</span> risk_vars, <span class="at">indp_dfs =</span> ind_sc_df_test_wd_score)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_test_den_plots[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_test_den_plots[[<span class="dv">1</span>]][<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>indp_cohorts_test.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Individual cohorts testset"</span>, </span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>))</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>p1_p2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p1_p2, <span class="at">top =</span> indp_cohorts_test.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(plot_grid(plotlist = ind_den_plots[1:4], cols = 3),</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="co">#          plot_grid(ind_den_plots[5],    rel_widths = 1))</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>p1_m <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_test_den_plots[[<span class="dv">2</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>p2_m <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_test_den_plots[[<span class="dv">2</span>]][<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>p1_p2_m <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1_m,p2_m, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>indp_cohorts_test_wo_exp.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Individual cohorts testset without exposure variables"</span>, </span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>))</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p1_p2_m, <span class="at">top =</span> indp_cohorts_test_wo_exp.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="independent-test-wo-exposure-variables-in-model" class="level3">
<h3 class="anchored" data-anchor-id="independent-test-wo-exposure-variables-in-model">independent test wo exposure variables in model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ind_den_plots</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>ind_test_den_plots_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">independent_plots</span>(<span class="at">vars =</span> risk_vars[<span class="dv">2</span>], </span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">indp_dfs =</span> ind_sc_df_test_wo_exp_in_model,</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">wo_exp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>indp_cohorts_test_wo_exp_in_model.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Individual cohorts testset without exposure variables in model"</span>, </span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>))</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>p1_test_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_test_den_plots_wo_exp_in_model[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>p2_test_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_test_den_plots_wo_exp_in_model[[<span class="dv">1</span>]][<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a>p1_p2_test_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1_test_wo_exp_in_model, p2_test_wo_exp_in_model, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb210-17"><a href="#cb210-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-18"><a href="#cb210-18" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p1_p2_test_wo_exp_in_model, <span class="at">top =</span> indp_cohorts_test_wo_exp_in_model.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="case-controls-and-males-females-in-train-test" class="level3">
<h3 class="anchored" data-anchor-id="case-controls-and-males-females-in-train-test">Case, controls and males, females in train test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>CurrentPTSD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
228  79 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>CurrentPTSD)<span class="sc">/</span><span class="fu">nrow</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      0       1 
74.2671 25.7329 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2 
143 164 </code></pre>
</div>
</div>
</section>
<section id="to-confirm-if-females-have-high-scores-compared-to-males-as-in-va-samples" class="level3">
<h3 class="anchored" data-anchor-id="to-confirm-if-females-have-high-scores-compared-to-males-as-in-va-samples">To confirm if females have high scores compared to males (as in VA samples)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we'll get the sex info from the earlier dataset </span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="co"># when we had gender as significant feature</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="co"># It </span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sex_info &lt;- read.csv("G:/PGC ML/Combined Data/2021-11-27_19-16-35/risk scores ptsdpm test data.csv")</span></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(adj_sc_df$`Without NonCpG Probes`)</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # all should be True</span></span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a><span class="co"># table(adj_sc_df$`Without NonCpG Probes`$CurrentPTSD == sex_info$ptsdpm)</span></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a><span class="co"># table(as.integer(adj_sc_df$`Without NonCpG Probes`$TraumaNumber) == as.integer(sex_info$Traumanum))</span></span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df$`Without NonCpG Probes`$Gender &lt;- as.factor(sex_info$Gender)</span></span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df$`Without NonCpGXY Probes`$Gender &lt;- as.factor(sex_info$Gender)</span></span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a>adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>Gender)</span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true" tabindex="-1"></a>adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>Gender)</span>
<span id="cb217-20"><a href="#cb217-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-21"><a href="#cb217-21" aria-hidden="true" tabindex="-1"></a>mf_rsk_p <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>,</span>
<span id="cb217-22"><a href="#cb217-22" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb217-23"><a href="#cb217-23" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb217-24"><a href="#cb217-24" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb217-25"><a href="#cb217-25" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb217-26"><a href="#cb217-26" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb217-27"><a href="#cb217-27" aria-hidden="true" tabindex="-1"></a>                             <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb217-28"><a href="#cb217-28" aria-hidden="true" tabindex="-1"></a>                             <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb217-29"><a href="#cb217-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">"Test set, controls and cases separately </span><span class="sc">\n</span><span class="st">(Without NonCpG Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_p1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Test set, controls and cases together </span><span class="sc">\n</span><span class="st">(Without NonCpG Probes)"</span>)</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_p, mf_rsk_p1, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_p2 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Test set, controls and cases separately </span><span class="sc">\n</span><span class="st">(Without NonCpGXY Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_p3 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Controls and cases together </span><span class="sc">\n</span><span class="st">(Without NonCpGXY Probes)"</span>)</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_p2, mf_rsk_p3, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------- check if females have higher symptom severity</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Non CPG probes separate and together</span></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>mf_rsk_ptss <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'PTSS'</span>,</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Test set, controls and cases separately </span><span class="sc">\n</span><span class="st">(Without NonCpG Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_ptss1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'PTSS'</span>,</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Test set, controls and cases together </span><span class="sc">\n</span><span class="st">(Without NonCpG Probes)"</span>)</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_ptss, mf_rsk_ptss1, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 70 rows containing non-finite values (`stat_density()`).
Removed 70 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Non CPG and XY probes separate and together</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>mf_rsk_ptss2 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'PTSS'</span>,</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Test set, controls and cases separately </span><span class="sc">\n</span><span class="st">(Without NonCpGXY Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_ptss3 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'PTSS'</span>,</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Test set, controls and cases together </span><span class="sc">\n</span><span class="st">(Without NonCpGXY Probes)"</span>)</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_ptss2, mf_rsk_ptss3, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 70 rows containing non-finite values (`stat_density()`).
Removed 70 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-28-4.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section>
<section id="check-risk-scores-for-males-and-females-in-train-and-test-current-ptsd" class="level3">
<h3 class="anchored" data-anchor-id="check-risk-scores-for-males-and-females-in-train-and-test-current-ptsd">Check risk scores for males and females in train and test (current ptsd)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>test_df <span class="ot">&lt;-</span> current_all_sc<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>CurrentPTSD <span class="sc">==</span> train_test<span class="sc">$</span>current_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
1226 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test_df<span class="sc">$</span>TraumaNumber <span class="sc">==</span> train_test<span class="sc">$</span>Traumanum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
1226 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">as.integer</span>(test_df<span class="sc">$</span>ChildhoodMaltreatment) <span class="sc">==</span> <span class="fu">as.integer</span>(train_test<span class="sc">$</span>Childhood_Mt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
1226 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train_test<span class="sc">$</span>Gender)</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train_test<span class="sc">$</span>Gender)</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>mf_rsk_all_p <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Controls and cases separately </span><span class="sc">\n</span><span class="st"> ( in train and test Without NonCpG Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_all_p1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Controls and cases together </span><span class="sc">\n</span><span class="st">(in train and test Without NonCpG Probes)"</span>)</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_all_p, mf_rsk_all_p1, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_all_p2 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Controls and cases separately </span><span class="sc">\n</span><span class="st"> ( in train and test - Without NonCpGXY Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_all_p3 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="st">"Controls and cases together </span><span class="sc">\n</span><span class="st">(in train and test - Without NonCpGXY Probes)"</span>)</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_all_p2, mf_rsk_all_p3, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="1344"></p>
</div>
</div>
<section id="distribution-of-mean-methylation-of-positive-and-negative-coefficient-features-for-cases-and-controls" class="level4">
<h4 class="anchored" data-anchor-id="distribution-of-mean-methylation-of-positive-and-negative-coefficient-features-for-cases-and-controls">Distribution of mean methylation of positive and negative coefficient features for cases and controls</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Positive coefficient features</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_pos_meth &lt;- make_densityplot(df = adj_sc_df_pos$`Without NonCpG Probes`,</span></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 x = 'mean_meth',</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 y = 'CurrentPTSD',</span></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 xlab = 'Mean methylation',</span></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 ylab = "Density",</span></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 fig_legend = FALSE,</span></span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 # legend = "Current PTSD",</span></span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 title = "Covariate adjusted and scaled: \n Without NonCpG Probes \n (positive coefficient) ")</span></span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a><span class="co"># p2_pos_meth &lt;- make_densityplot(df = adj_sc_df_pos$`Without NonCpGXY Probes`, x = 'mean_meth',</span></span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'CurrentPTSD',</span></span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Mean methylation',</span></span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "",</span></span>
<span id="cb243-15"><a href="#cb243-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "Current PTSD",</span></span>
<span id="cb243-16"><a href="#cb243-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Covariate adjusted and scaled: \n Without NonCpGXY Probes \n (positive coefficient) ")</span></span>
<span id="cb243-17"><a href="#cb243-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-18"><a href="#cb243-18" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(p1_pos_meth, p2_pos_meth, rel_widths = c(2, 1.3))</span></span>
<span id="cb243-19"><a href="#cb243-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-20"><a href="#cb243-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-21"><a href="#cb243-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # ---------------------------------------------------</span></span>
<span id="cb243-22"><a href="#cb243-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # Negative coefficient features</span></span>
<span id="cb243-23"><a href="#cb243-23" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_neg_meth &lt;- make_densityplot(df = adj_sc_df_neg$`Without NonCpG Probes`, x = 'mean_meth',</span></span>
<span id="cb243-24"><a href="#cb243-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'CurrentPTSD',</span></span>
<span id="cb243-25"><a href="#cb243-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Mean methylation',</span></span>
<span id="cb243-26"><a href="#cb243-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb243-27"><a href="#cb243-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = FALSE,</span></span>
<span id="cb243-28"><a href="#cb243-28" aria-hidden="true" tabindex="-1"></a><span class="co">#                          # legend = "Current PTSD",</span></span>
<span id="cb243-29"><a href="#cb243-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Covariate adjusted and scaled: \n Without NonCpG Probes \n (negative coefficient) ")</span></span>
<span id="cb243-30"><a href="#cb243-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-31"><a href="#cb243-31" aria-hidden="true" tabindex="-1"></a><span class="co"># p2_neg_meth &lt;- make_densityplot(df = adj_sc_df_neg$`Without NonCpGXY Probes`, x = 'mean_meth',</span></span>
<span id="cb243-32"><a href="#cb243-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'CurrentPTSD',</span></span>
<span id="cb243-33"><a href="#cb243-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Mean methylation',</span></span>
<span id="cb243-34"><a href="#cb243-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "",</span></span>
<span id="cb243-35"><a href="#cb243-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "Current PTSD",</span></span>
<span id="cb243-36"><a href="#cb243-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Covariate adjusted and scaled: \n Without NonCpGXY Probes \n (negative coefficient) ")</span></span>
<span id="cb243-37"><a href="#cb243-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-38"><a href="#cb243-38" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(p1_neg_meth, p2_neg_meth, rel_widths = c(2, 1.3))</span></span>
<span id="cb243-39"><a href="#cb243-39" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-40"><a href="#cb243-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-41"><a href="#cb243-41" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-42"><a href="#cb243-42" aria-hidden="true" tabindex="-1"></a><span class="co"># # --------------------------------------------------------</span></span>
<span id="cb243-43"><a href="#cb243-43" aria-hidden="true" tabindex="-1"></a><span class="co"># # positive coefficient features for males and females separately</span></span>
<span id="cb243-44"><a href="#cb243-44" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df_pos$`Without NonCpG Probes`$Gender &lt;- as.factor(adj_sc_df_pos$`Without NonCpG Probes`$Gender)</span></span>
<span id="cb243-45"><a href="#cb243-45" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df_pos$`Without NonCpGXY Probes`$Gender &lt;- as.factor(adj_sc_df_pos$`Without NonCpGXY Probes`$Gender)</span></span>
<span id="cb243-46"><a href="#cb243-46" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-47"><a href="#cb243-47" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_pos_meth_sep &lt;- make_densityplot(df = adj_sc_df_pos$`Without NonCpG Probes`, x = 'risk_score',</span></span>
<span id="cb243-48"><a href="#cb243-48" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb243-49"><a href="#cb243-49" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb243-50"><a href="#cb243-50" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb243-51"><a href="#cb243-51" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = FALSE,</span></span>
<span id="cb243-52"><a href="#cb243-52" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "",</span></span>
<span id="cb243-53"><a href="#cb243-53" aria-hidden="true" tabindex="-1"></a><span class="co">#                          facet = "CurrentPTSD",</span></span>
<span id="cb243-54"><a href="#cb243-54" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases separately \n ( positive coef - Without NonCpG Probes)")</span></span>
<span id="cb243-55"><a href="#cb243-55" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-56"><a href="#cb243-56" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_pos_meth_sep1 &lt;- make_densityplot(df = adj_sc_df_pos$`Without NonCpGXY Probes`, x = 'risk_score',</span></span>
<span id="cb243-57"><a href="#cb243-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb243-58"><a href="#cb243-58" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb243-59"><a href="#cb243-59" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb243-60"><a href="#cb243-60" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = TRUE,</span></span>
<span id="cb243-61"><a href="#cb243-61" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "Gender",</span></span>
<span id="cb243-62"><a href="#cb243-62" aria-hidden="true" tabindex="-1"></a><span class="co">#                          facet = "CurrentPTSD",</span></span>
<span id="cb243-63"><a href="#cb243-63" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases separately \n ( positive coef - Without NonCpGXY Probes)")</span></span>
<span id="cb243-64"><a href="#cb243-64" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-65"><a href="#cb243-65" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(p1_pos_meth_sep, p1_pos_meth_sep1, rel_widths = c(1.5, 2))</span></span>
<span id="cb243-66"><a href="#cb243-66" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-67"><a href="#cb243-67" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-68"><a href="#cb243-68" aria-hidden="true" tabindex="-1"></a><span class="co"># # -----------------------------------------</span></span>
<span id="cb243-69"><a href="#cb243-69" aria-hidden="true" tabindex="-1"></a><span class="co"># # Negative coefficient features for males and females separately </span></span>
<span id="cb243-70"><a href="#cb243-70" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df_neg$`Without NonCpG Probes`$Gender &lt;- as.factor(adj_sc_df_neg$`Without NonCpG Probes`$Gender)</span></span>
<span id="cb243-71"><a href="#cb243-71" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df_neg$`Without NonCpGXY Probes`$Gender &lt;- as.factor(adj_sc_df_neg$`Without NonCpGXY Probes`$Gender)</span></span>
<span id="cb243-72"><a href="#cb243-72" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-73"><a href="#cb243-73" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_neg_meth_sep &lt;- make_densityplot(df = adj_sc_df_neg$`Without NonCpG Probes`, x = 'risk_score',</span></span>
<span id="cb243-74"><a href="#cb243-74" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb243-75"><a href="#cb243-75" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb243-76"><a href="#cb243-76" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb243-77"><a href="#cb243-77" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = FALSE,</span></span>
<span id="cb243-78"><a href="#cb243-78" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "",</span></span>
<span id="cb243-79"><a href="#cb243-79" aria-hidden="true" tabindex="-1"></a><span class="co">#                          facet = "CurrentPTSD",</span></span>
<span id="cb243-80"><a href="#cb243-80" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases separately \n ( negative coef - Without NonCpG Probes)")</span></span>
<span id="cb243-81"><a href="#cb243-81" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-82"><a href="#cb243-82" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_neg_meth_sep1 &lt;- make_densityplot(df = adj_sc_df_neg$`Without NonCpGXY Probes`, x = 'risk_score',</span></span>
<span id="cb243-83"><a href="#cb243-83" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb243-84"><a href="#cb243-84" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb243-85"><a href="#cb243-85" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb243-86"><a href="#cb243-86" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = TRUE,</span></span>
<span id="cb243-87"><a href="#cb243-87" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "Gender",</span></span>
<span id="cb243-88"><a href="#cb243-88" aria-hidden="true" tabindex="-1"></a><span class="co">#                          facet = "CurrentPTSD",</span></span>
<span id="cb243-89"><a href="#cb243-89" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases separately \n ( negative coef - Without NonCpGXY Probes)")</span></span>
<span id="cb243-90"><a href="#cb243-90" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb243-91"><a href="#cb243-91" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(p1_neg_meth_sep, p1_neg_meth_sep1, rel_widths = c(1.5, 2))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="without-using-gender-in-estimating-risk-scores-check-risk-scores-for-males-and-females-in-train-and-test-current-ptsd" class="level3">
<h3 class="anchored" data-anchor-id="without-using-gender-in-estimating-risk-scores-check-risk-scores-for-males-and-females-in-train-and-test-current-ptsd">Without using gender in estimating risk scores, check risk scores for males and females in train and test (current ptsd)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cur_sc_df_gen$Gender &lt;- as.factor(cur_sc_df_gen$Gender)</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mf_rsk_all_gen_p &lt;- make_densityplot(df = cur_sc_df_gen, x = 'risk_score',</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = FALSE,</span></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "",</span></span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                          facet = "CurrentPTSD",</span></span>
<span id="cb244-9"><a href="#cb244-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases seprately \n ( in train and test)")</span></span>
<span id="cb244-10"><a href="#cb244-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb244-11"><a href="#cb244-11" aria-hidden="true" tabindex="-1"></a><span class="co"># mf_rsk_all_gen_p1 &lt;- make_densityplot(df = cur_sc_df_gen, x = 'risk_score',</span></span>
<span id="cb244-12"><a href="#cb244-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb244-13"><a href="#cb244-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb244-14"><a href="#cb244-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "",</span></span>
<span id="cb244-15"><a href="#cb244-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = TRUE,</span></span>
<span id="cb244-16"><a href="#cb244-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "Gender",</span></span>
<span id="cb244-17"><a href="#cb244-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases together \n(in train and test)")</span></span>
<span id="cb244-18"><a href="#cb244-18" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(mf_rsk_all_gen_p, mf_rsk_all_gen_p1, rel_widths = c(2, 1.3))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="box-plot-function" class="level2">
<h2 class="anchored" data-anchor-id="box-plot-function">Box plot function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>make_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y, xlab, ylab,</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>                         test_pval, y_pos, <span class="at">title =</span> <span class="st">""</span>){</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes_string</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> x)) <span class="sc">+</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">"#BC3C29FF"</span>)) <span class="sc">+</span></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="fl">1.7</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span> th <span class="sc">+</span></span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(title) <span class="sc">+</span></span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab)</span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-15"><a href="#cb245-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add significance</span></span>
<span id="cb245-16"><a href="#cb245-16" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">+</span> <span class="fu">geom_signif</span>(</span>
<span id="cb245-17"><a href="#cb245-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation =</span> <span class="fu">formatC</span>(test_pval, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb245-18"><a href="#cb245-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_position =</span> y_pos , <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb245-19"><a href="#cb245-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">textsize =</span> <span class="dv">5</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.02</span>))</span>
<span id="cb245-20"><a href="#cb245-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-1" class="level1">
<h1>———————————————</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>wcox_test_sc <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>)</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>wcox_test_sc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  risk_score by CurrentPTSD
W = 1271, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>wcox_test_sc<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.545035e-30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>p1_box_sc <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">test_pval =</span> wcox_test_sc<span class="sc">$</span>p.value,</span>
<span id="cb250-7"><a href="#cb250-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y_pos =</span> <span class="fl">4.8</span>,</span>
<span id="cb250-8"><a href="#cb250-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Covariate adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpG Probes"</span></span>
<span id="cb250-9"><a href="#cb250-9" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb250-10"><a href="#cb250-10" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc</span></span>
<span id="cb250-11"><a href="#cb250-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-12"><a href="#cb250-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-13"><a href="#cb250-13" aria-hidden="true" tabindex="-1"></a>wcox_test_sc1 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb250-14"><a href="#cb250-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>)</span>
<span id="cb250-15"><a href="#cb250-15" aria-hidden="true" tabindex="-1"></a>wcox_test_sc1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  risk_score by CurrentPTSD
W = 1107, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>wcox_test_sc1<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.393875e-31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>p1_box_sc1 <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ylab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">test_pval =</span> wcox_test_sc1<span class="sc">$</span>p.value,</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y_pos =</span> <span class="fl">4.7</span>,</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">title =</span> <span class="st">"Covariate adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpGXY Probes"</span></span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc1</span></span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1_box_sc, p1_box_sc1, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># life</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_life_sc &lt;- wilcox.test(risk_score ~ LifetimePTSD, </span></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 data =adj_life_sc_df$`Without NonCpG Probes`)</span></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_life_sc</span></span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_life_sc$p.value</span></span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_life_sc &lt;- make_boxplot(df = adj_life_sc_df, x = 'LifetimePTSD',</span></span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                        y = 'risk_score',</span></span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                        xlab = 'Lifetime PTSD',</span></span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                        ylab = '',</span></span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                        test_pval = wcox_test_life_sc$p.value,</span></span>
<span id="cb255-13"><a href="#cb255-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                        y_pos = .54,</span></span>
<span id="cb255-14"><a href="#cb255-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                        title = "" # Covariate adjusted \nand scaled</span></span>
<span id="cb255-15"><a href="#cb255-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb255-16"><a href="#cb255-16" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_life_sc</span></span>
<span id="cb255-17"><a href="#cb255-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb255-18"><a href="#cb255-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb255-19"><a href="#cb255-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb255-20"><a href="#cb255-20" aria-hidden="true" tabindex="-1"></a><span class="co"># # --------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="density-plot-for-istss" class="level3">
<h3 class="anchored" data-anchor-id="density-plot-for-istss">Density plot for ISTSS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>istss_den <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">title =</span> <span class="st">""</span></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a>istss_den_meth <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb256-15"><a href="#cb256-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb256-16"><a href="#cb256-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">legend =</span> <span class="st">"Current</span><span class="sc">\n</span><span class="st"> PTSD"</span>,</span>
<span id="cb256-17"><a href="#cb256-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title =</span> <span class="st">""</span></span>
<span id="cb256-18"><a href="#cb256-18" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb256-19"><a href="#cb256-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-20"><a href="#cb256-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-21"><a href="#cb256-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-22"><a href="#cb256-22" aria-hidden="true" tabindex="-1"></a><span class="co"># istss_den</span></span>
<span id="cb256-23"><a href="#cb256-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb256-24"><a href="#cb256-24" aria-hidden="true" tabindex="-1"></a><span class="co"># istss_den_meth</span></span>
<span id="cb256-25"><a href="#cb256-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-26"><a href="#cb256-26" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(istss_den, istss_den_meth,</span>
<span id="cb256-27"><a href="#cb256-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="box-plots-for-individual-cohorts" class="level3">
<h3 class="anchored" data-anchor-id="box-plots-for-individual-cohorts">Box plots for Individual Cohorts</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>indp_wcox <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ind_sc_df_wd_score, <span class="cf">function</span>(x){ </span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox.test</span>(risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> x)</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>indp_wcox_pvals <span class="ot">&lt;-</span> <span class="fu">lapply</span>(indp_wcox, <span class="cf">function</span>(x){</span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span>p.value</span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true" tabindex="-1"></a>indp_wcox_pvals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1] 2.62041e-20

$DNHS
[1] 5.503212e-20

$GTP
[1] 1.130651e-71

$MRS
[1] 3.146849e-19

$Prismo
[1] 2.437197e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>indp_box_plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(ind_sc_df_wd_score), <span class="cf">function</span>(i){</span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)){</span>
<span id="cb259-3"><a href="#cb259-3" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="fl">3.5</span></span>
<span id="cb259-4"><a href="#cb259-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{y_pos <span class="ot">=</span> <span class="dv">4</span>}</span>
<span id="cb259-5"><a href="#cb259-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb259-6"><a href="#cb259-6" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)){</span>
<span id="cb259-7"><a href="#cb259-7" aria-hidden="true" tabindex="-1"></a>    ylab <span class="ot">=</span> <span class="st">""</span></span>
<span id="cb259-8"><a href="#cb259-8" aria-hidden="true" tabindex="-1"></a>   }<span class="cf">else</span>{ylab <span class="ot">=</span> <span class="st">'Risk score'</span>}</span>
<span id="cb259-9"><a href="#cb259-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">make_boxplot</span>(<span class="at">df =</span> ind_sc_df_wd_score[[i]], </span>
<span id="cb259-10"><a href="#cb259-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb259-11"><a href="#cb259-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb259-12"><a href="#cb259-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb259-13"><a href="#cb259-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> ylab,</span>
<span id="cb259-14"><a href="#cb259-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">test_pval =</span> indp_wcox[[i]]<span class="sc">$</span>p.value,</span>
<span id="cb259-15"><a href="#cb259-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">y_pos =</span> y_pos,</span>
<span id="cb259-16"><a href="#cb259-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="fu">names</span>(ind_sc_df_wd_score)[i]</span>
<span id="cb259-17"><a href="#cb259-17" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb259-18"><a href="#cb259-18" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb259-19"><a href="#cb259-19" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb259-20"><a href="#cb259-20" aria-hidden="true" tabindex="-1"></a><span class="co"># indp_box_plots</span></span>
<span id="cb259-21"><a href="#cb259-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-22"><a href="#cb259-22" aria-hidden="true" tabindex="-1"></a>indp_box_p <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> indp_box_plots)</span>
<span id="cb259-23"><a href="#cb259-23" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(indp_box_p, <span class="at">top=</span> indp_cohorts.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>indp_wcox_meth <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ind_sc_df_wd_score, <span class="cf">function</span>(x){</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> x)</span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(indp_wcox_meth, <span class="cf">function</span>(x){</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span>p.value</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1] 5.614775e-21

$DNHS
[1] 2.673469e-20

$GTP
[1] 6.06792e-71

$MRS
[1] 2.87066e-19

$Prismo
[1] 6.092992e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a>indp_box_plots_meth <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(ind_sc_df_wd_score), <span class="cf">function</span>(i){</span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span><span class="dv">3</span>){</span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">5</span>){</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{y_pos <span class="ot">=</span> <span class="fl">2.5</span>}</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)){</span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a>    ylab <span class="ot">=</span> <span class="st">""</span></span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{ylab <span class="ot">=</span> <span class="st">'Methylation risk score'</span>}</span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">make_boxplot</span>(<span class="at">df =</span> ind_sc_df_wd_score[[i]], </span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> ylab,</span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">test_pval =</span> indp_wcox_meth[[i]]<span class="sc">$</span>p.value,</span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">y_pos =</span> y_pos,</span>
<span id="cb262-20"><a href="#cb262-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="fu">names</span>(ind_sc_df_wd_score)[i]</span>
<span id="cb262-21"><a href="#cb262-21" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb262-22"><a href="#cb262-22" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb262-23"><a href="#cb262-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb262-24"><a href="#cb262-24" aria-hidden="true" tabindex="-1"></a><span class="co"># indp_box_plots</span></span>
<span id="cb262-25"><a href="#cb262-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-26"><a href="#cb262-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-27"><a href="#cb262-27" aria-hidden="true" tabindex="-1"></a>indp_box_p_meth <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> indp_box_plots_meth)</span>
<span id="cb262-28"><a href="#cb262-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(indp_box_p_meth, <span class="at">top=</span> indp_cohorts_wo_exp.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>indp_wcox_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ind_sc_df_wo_exp_in_model, <span class="cf">function</span>(x){ </span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> x)</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a>indp_box_plots_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(ind_sc_df_wo_exp_in_model), <span class="cf">function</span>(i){</span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)){</span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">5</span>){</span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="fl">2.5</span></span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{y_pos <span class="ot">=</span> <span class="dv">3</span>}</span>
<span id="cb263-14"><a href="#cb263-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb263-15"><a href="#cb263-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)){</span>
<span id="cb263-16"><a href="#cb263-16" aria-hidden="true" tabindex="-1"></a>    ylab <span class="ot">=</span> <span class="st">""</span></span>
<span id="cb263-17"><a href="#cb263-17" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{ylab <span class="ot">=</span> <span class="st">'Methylation risk score'</span>}</span>
<span id="cb263-18"><a href="#cb263-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb263-19"><a href="#cb263-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">make_boxplot</span>(<span class="at">df =</span> ind_sc_df_wo_exp_in_model[[i]], </span>
<span id="cb263-20"><a href="#cb263-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb263-21"><a href="#cb263-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb263-22"><a href="#cb263-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb263-23"><a href="#cb263-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> ylab,</span>
<span id="cb263-24"><a href="#cb263-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">test_pval =</span> indp_wcox_wo_exp_in_model[[i]]<span class="sc">$</span>p.value,</span>
<span id="cb263-25"><a href="#cb263-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">y_pos =</span> y_pos,</span>
<span id="cb263-26"><a href="#cb263-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="fu">names</span>(ind_sc_df_wo_exp_in_model)[i]</span>
<span id="cb263-27"><a href="#cb263-27" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb263-28"><a href="#cb263-28" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb263-29"><a href="#cb263-29" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb263-30"><a href="#cb263-30" aria-hidden="true" tabindex="-1"></a><span class="co"># indp_box_plots</span></span>
<span id="cb263-31"><a href="#cb263-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-32"><a href="#cb263-32" aria-hidden="true" tabindex="-1"></a>indp_box_p_wo_exp <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> indp_box_plots_wo_exp_in_model)</span>
<span id="cb263-33"><a href="#cb263-33" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(indp_box_p_wo_exp, <span class="at">top=</span> indp_cohorts_wo_exp_in_model.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-35-3.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="box-plots-for-individual-cohorts-test-set" class="level3">
<h3 class="anchored" data-anchor-id="box-plots-for-individual-cohorts-test-set">Box plots for Individual Cohorts TEST SET</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>indp_wcox_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ind_sc_df_test_wd_score, <span class="cf">function</span>(x){ </span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox.test</span>(risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> x)</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>indp_wcox_pvals_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(indp_wcox_test, <span class="cf">function</span>(x){</span>
<span id="cb264-7"><a href="#cb264-7" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span>p.value</span>
<span id="cb264-8"><a href="#cb264-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb264-9"><a href="#cb264-9" aria-hidden="true" tabindex="-1"></a>indp_wcox_pvals_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1] 2.201444e-05

$DNHS
[1] 3.880804e-06

$GTP
[1] 9.21005e-19

$MRS
[1] 0.002963113

$Prismo
[1] 0.03571429</code></pre>
</div>
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>indp_box_plots_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(ind_sc_df_test_wd_score), <span class="cf">function</span>(i){</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>)){</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{y_pos <span class="ot">=</span> <span class="dv">4</span>}</span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">make_boxplot</span>(<span class="at">df =</span> ind_sc_df_test_wd_score[[i]], </span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">test_pval =</span> indp_wcox_test[[i]]<span class="sc">$</span>p.value,</span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">y_pos =</span> y_pos,</span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="fu">names</span>(ind_sc_df_test_wd_score)[i]</span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a><span class="co"># indp_box_plots</span></span>
<span id="cb266-19"><a href="#cb266-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-20"><a href="#cb266-20" aria-hidden="true" tabindex="-1"></a>indp_box_p_test <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> indp_box_plots_test)</span>
<span id="cb266-21"><a href="#cb266-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-22"><a href="#cb266-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(indp_box_p_test, <span class="at">top =</span> indp_cohorts_test.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>indp_wcox_meth_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ind_sc_df_test_wd_score, <span class="cf">function</span>(x){</span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> x)</span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(indp_wcox_meth_test, <span class="cf">function</span>(x){</span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span>p.value</span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1] 4.607756e-07

$DNHS
[1] 5.074252e-06

$GTP
[1] 7.258134e-18

$MRS
[1] 0.002077544

$Prismo
[1] 0.07142857</code></pre>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>indp_box_plots_meth_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(ind_sc_df_test_wd_score), <span class="cf">function</span>(i){</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)){</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="fl">1.3</span></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>)){</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> .<span class="dv">1</span></span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(i<span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>)){</span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>    y_pos<span class="ot">=</span><span class="fl">2.2</span></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{y_pos <span class="ot">=</span> <span class="dv">3</span>}</span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)){</span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a>    ylab <span class="ot">=</span> <span class="st">""</span></span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{ylab <span class="ot">=</span> <span class="st">'Methylation risk score'</span>}</span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">make_boxplot</span>(<span class="at">df =</span> ind_sc_df_test_wd_score[[i]], </span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb269-16"><a href="#cb269-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb269-17"><a href="#cb269-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb269-18"><a href="#cb269-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> ylab,</span>
<span id="cb269-19"><a href="#cb269-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">test_pval =</span> indp_wcox_meth_test[[i]]<span class="sc">$</span>p.value,</span>
<span id="cb269-20"><a href="#cb269-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">y_pos =</span> y_pos,</span>
<span id="cb269-21"><a href="#cb269-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="fu">names</span>(ind_sc_df_test_wd_score)[i]</span>
<span id="cb269-22"><a href="#cb269-22" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb269-23"><a href="#cb269-23" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb269-24"><a href="#cb269-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb269-25"><a href="#cb269-25" aria-hidden="true" tabindex="-1"></a><span class="co"># indp_box_plots</span></span>
<span id="cb269-26"><a href="#cb269-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-27"><a href="#cb269-27" aria-hidden="true" tabindex="-1"></a>indp_box_p_meth_test <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> indp_box_plots_meth_test)</span>
<span id="cb269-28"><a href="#cb269-28" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(indp_box_p_meth_test, <span class="at">top =</span> indp_cohorts_test_wo_exp.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid" width="768"></p>
</div>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>indp_wcox_wo_exp_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ind_sc_df_test_wo_exp_in_model, <span class="cf">function</span>(x){ </span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> x)</span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>indp_box_plots_wo_exp_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(ind_sc_df_test_wo_exp_in_model), <span class="cf">function</span>(i){</span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)){</span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>)){</span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> .<span class="dv">8</span></span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(i<span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>)){</span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a>    y_pos<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{y_pos <span class="ot">=</span> <span class="fl">3.5</span>}</span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)){</span>
<span id="cb270-17"><a href="#cb270-17" aria-hidden="true" tabindex="-1"></a>    ylab <span class="ot">=</span> <span class="st">""</span></span>
<span id="cb270-18"><a href="#cb270-18" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{ylab <span class="ot">=</span> <span class="st">'Methylation risk score'</span>}</span>
<span id="cb270-19"><a href="#cb270-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb270-20"><a href="#cb270-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">make_boxplot</span>(<span class="at">df =</span> ind_sc_df_test_wo_exp_in_model[[i]], </span>
<span id="cb270-21"><a href="#cb270-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb270-22"><a href="#cb270-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb270-23"><a href="#cb270-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb270-24"><a href="#cb270-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> ylab,</span>
<span id="cb270-25"><a href="#cb270-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">test_pval =</span> indp_wcox_wo_exp_test[[i]]<span class="sc">$</span>p.value,</span>
<span id="cb270-26"><a href="#cb270-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">y_pos =</span> y_pos,</span>
<span id="cb270-27"><a href="#cb270-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="fu">names</span>(ind_sc_df_test_wo_exp_in_model)[i]</span>
<span id="cb270-28"><a href="#cb270-28" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb270-29"><a href="#cb270-29" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb270-30"><a href="#cb270-30" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb270-31"><a href="#cb270-31" aria-hidden="true" tabindex="-1"></a><span class="co"># indp_box_plots</span></span>
<span id="cb270-32"><a href="#cb270-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-33"><a href="#cb270-33" aria-hidden="true" tabindex="-1"></a>indp_box_p_wo_exp_test <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> indp_box_plots_wo_exp_test)</span>
<span id="cb270-34"><a href="#cb270-34" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(indp_box_p_wo_exp_test, <span class="at">top =</span> indp_cohorts_test_wo_exp_in_model.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-36-3.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="box-plot-for-istss" class="level3">
<h3 class="anchored" data-anchor-id="box-plot-for-istss">Box plot for ISTSS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>p1_box_istss <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ylab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">test_pval =</span> wcox_test_sc1<span class="sc">$</span>p.value,</span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y_pos =</span> <span class="fl">4.7</span>,</span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">""</span></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a>                             )</span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a>wcox_test_meth <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>)</span>
<span id="cb271-14"><a href="#cb271-14" aria-hidden="true" tabindex="-1"></a>wcox_test_meth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by CurrentPTSD
W = 1918, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>wcox_test_meth<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.930179e-25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>p1_box_istss_meth <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ylab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">test_pval =</span> wcox_test_meth<span class="sc">$</span>p.value,</span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y_pos =</span> <span class="fl">3.2</span>,</span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="st">""</span></span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange den plots</span></span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(istss_den, istss_den_meth, </span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>),</span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label_x =</span> .<span class="dv">15</span> , <span class="at">vjust =</span> <span class="dv">2</span>,</span>
<span id="cb275-15"><a href="#cb275-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>))</span>
<span id="cb275-16"><a href="#cb275-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-17"><a href="#cb275-17" aria-hidden="true" tabindex="-1"></a><span class="co"># add title to den plots</span></span>
<span id="cb275-18"><a href="#cb275-18" aria-hidden="true" tabindex="-1"></a>title_den.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Distribution of risk scores"</span>,</span>
<span id="cb275-19"><a href="#cb275-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>), <span class="at">vjust =</span> <span class="dv">2</span>)</span>
<span id="cb275-20"><a href="#cb275-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-21"><a href="#cb275-21" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p1, <span class="at">top =</span> title_den.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange box plots</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1_box_istss, </span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>                         p1_box_istss_meth,</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"C"</span>,<span class="st">"D"</span>),</span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label_x =</span> .<span class="dv">15</span> , <span class="at">vjust =</span> <span class="dv">2</span>)</span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a><span class="co"># add title to box plots</span></span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a>title.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Difference in risk scores"</span>,</span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>), <span class="at">vjust =</span> <span class="dv">2</span>)</span>
<span id="cb276-10"><a href="#cb276-10" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p2, <span class="at">top =</span> title.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add x label to box plots</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>x.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Current PTSD"</span>,</span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">2</span>)</span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange plots in grid</span></span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>p_comb <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p_comb, <span class="at">bottom =</span> x.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-37-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_istss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="box-plot-for-without-exposure-variables-in-the-model" class="level3">
<h3 class="anchored" data-anchor-id="box-plot-for-without-exposure-variables-in-the-model">Box plot for without exposure variables in the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>istss_den_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span>, </span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">legend =</span> <span class="st">"Current</span><span class="sc">\n</span><span class="st"> PTSD"</span>,</span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title =</span> <span class="st">"Without exposure variables</span><span class="sc">\n</span><span class="st">in the model"</span></span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb279-9"><a href="#cb279-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-10"><a href="#cb279-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-11"><a href="#cb279-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-12"><a href="#cb279-12" aria-hidden="true" tabindex="-1"></a>wcox_test_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb279-13"><a href="#cb279-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span>)</span>
<span id="cb279-14"><a href="#cb279-14" aria-hidden="true" tabindex="-1"></a>wcox_test_meth_wo_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by CurrentPTSD
W = 2033, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>wcox_test_meth_wo_exp<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.127294e-24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>p1_box_istss_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span>, </span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ylab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">test_pval =</span> wcox_test_meth_wo_exp<span class="sc">$</span>p.value,</span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y_pos =</span> <span class="fl">3.2</span>,</span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="st">""</span></span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange den plots</span></span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a>p_wo_exp <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(istss_den_meth_wo_exp, p1_box_istss_meth_wo_exp, </span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb283-14"><a href="#cb283-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label_x =</span> .<span class="dv">15</span> )</span>
<span id="cb283-15"><a href="#cb283-15" aria-hidden="true" tabindex="-1"></a>p_wo_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="384"></p>
</div>
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # add title to den plots</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="co"># title_den.grob &lt;- textGrob("Distribution of risk scores",</span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                    gp=gpar(fontsize=20), vjust = 1)</span></span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- grid.arrange(arrangeGrob(p1, top = title_den.grob))</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a><span class="co"># # arrange box plots</span></span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;- cowplot::plot_grid(p1_box_istss, </span></span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                          p1_box_istss_meth,</span></span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                          labels = c("C","D"),</span></span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                          label_x = .15 , vjust = 2)</span></span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # add title to box plots</span></span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a><span class="co"># title.grob &lt;- textGrob("Difference in risk scores",</span></span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                    gp=gpar(fontsize=20), vjust = 1)</span></span>
<span id="cb284-16"><a href="#cb284-16" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;- grid.arrange(arrangeGrob(p2, top = title.grob))</span></span>
<span id="cb284-17"><a href="#cb284-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb284-18"><a href="#cb284-18" aria-hidden="true" tabindex="-1"></a><span class="co"># # add x label to box plots</span></span>
<span id="cb284-19"><a href="#cb284-19" aria-hidden="true" tabindex="-1"></a><span class="co"># x.grob &lt;- textGrob("Current PTSD",</span></span>
<span id="cb284-20"><a href="#cb284-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                    gp=gpar(fontsize=18), vjust = -2)</span></span>
<span id="cb284-21"><a href="#cb284-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb284-22"><a href="#cb284-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # arrange plots in grid</span></span>
<span id="cb284-23"><a href="#cb284-23" aria-hidden="true" tabindex="-1"></a><span class="co"># p_comb &lt;- cowplot::plot_grid(p1,p2, nrow = 2)</span></span>
<span id="cb284-24"><a href="#cb284-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb284-25"><a href="#cb284-25" aria-hidden="true" tabindex="-1"></a><span class="co"># grid.arrange(arrangeGrob(p_comb, bottom = x.grob))</span></span>
<span id="cb284-26"><a href="#cb284-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-27"><a href="#cb284-27" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_istss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="box-plots-for-models-1-2-3-for-manuscript.-we-have-model-3-data-saved-in-a-file-so-let-load-that-first" class="level3">
<h3 class="anchored" data-anchor-id="box-plots-for-models-1-2-3-for-manuscript.-we-have-model-3-data-saved-in-a-file-so-let-load-that-first">Box plots for models 1, 2 &amp; 3 for manuscript. We have model 3 data saved in a file so let load that first</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">local</span>(<span class="fu">get</span>(<span class="fu">load</span>(<span class="st">"../../../Combined Data/2023-03-08_21-41-11/Adj_sc_df_for_pathways.RData"</span>)))</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Without NonCpG Probes"   "Without NonCpGXY Probes"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../../../Combined Data/2022-03-30_15-07-11/Adj_sc_df_for_pathways.RData"</span>)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(adj_sc_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Without NonCpG Probes"           "Without NonCpGXY Probes"        
[3] "Without NonCpGXY ProbesWoExpVar"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>m1_den <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb289-6"><a href="#cb289-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb289-7"><a href="#cb289-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">xlab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb289-8"><a href="#cb289-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb289-9"><a href="#cb289-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb289-10"><a href="#cb289-10" aria-hidden="true" tabindex="-1"></a>                              <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb289-11"><a href="#cb289-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">title =</span> <span class="st">"Model 1"</span></span>
<span id="cb289-12"><a href="#cb289-12" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb289-13"><a href="#cb289-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-14"><a href="#cb289-14" aria-hidden="true" tabindex="-1"></a>m2_den <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span>, </span>
<span id="cb289-15"><a href="#cb289-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb289-16"><a href="#cb289-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb289-17"><a href="#cb289-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb289-18"><a href="#cb289-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb289-19"><a href="#cb289-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb289-20"><a href="#cb289-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title =</span> <span class="st">"Model 2"</span></span>
<span id="cb289-21"><a href="#cb289-21" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb289-22"><a href="#cb289-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-23"><a href="#cb289-23" aria-hidden="true" tabindex="-1"></a>m3_den <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> model3<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb289-24"><a href="#cb289-24" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb289-25"><a href="#cb289-25" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb289-26"><a href="#cb289-26" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb289-27"><a href="#cb289-27" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb289-28"><a href="#cb289-28" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">legend =</span> <span class="st">"Current</span><span class="sc">\n</span><span class="st"> PTSD"</span>,</span>
<span id="cb289-29"><a href="#cb289-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title =</span> <span class="st">"Model 3"</span></span>
<span id="cb289-30"><a href="#cb289-30" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb289-31"><a href="#cb289-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-32"><a href="#cb289-32" aria-hidden="true" tabindex="-1"></a>wcox_m1 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb289-33"><a href="#cb289-33" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>)</span>
<span id="cb289-34"><a href="#cb289-34" aria-hidden="true" tabindex="-1"></a>m1_box <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb289-35"><a href="#cb289-35" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb289-36"><a href="#cb289-36" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb289-37"><a href="#cb289-37" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb289-38"><a href="#cb289-38" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ylab =</span> <span class="st">'Risk score'</span>,</span>
<span id="cb289-39"><a href="#cb289-39" aria-hidden="true" tabindex="-1"></a>                             <span class="at">test_pval =</span> wcox_m1<span class="sc">$</span>p.value,</span>
<span id="cb289-40"><a href="#cb289-40" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y_pos =</span> <span class="fl">4.7</span>,</span>
<span id="cb289-41"><a href="#cb289-41" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">""</span></span>
<span id="cb289-42"><a href="#cb289-42" aria-hidden="true" tabindex="-1"></a>                             )</span>
<span id="cb289-43"><a href="#cb289-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-44"><a href="#cb289-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-45"><a href="#cb289-45" aria-hidden="true" tabindex="-1"></a>wcox_m2 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb289-46"><a href="#cb289-46" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span>)</span>
<span id="cb289-47"><a href="#cb289-47" aria-hidden="true" tabindex="-1"></a>wcox_m2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by CurrentPTSD
W = 2033, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>wcox_m2<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.127294e-24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>m2_box <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY ProbesWoExpVar</span><span class="st">`</span>, </span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ylab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">test_pval =</span> wcox_m2<span class="sc">$</span>p.value,</span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y_pos =</span> <span class="fl">3.8</span>,</span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="st">""</span></span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-11"><a href="#cb293-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-12"><a href="#cb293-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-13"><a href="#cb293-13" aria-hidden="true" tabindex="-1"></a>wcox_m3 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb293-14"><a href="#cb293-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> model3<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>)</span>
<span id="cb293-15"><a href="#cb293-15" aria-hidden="true" tabindex="-1"></a>wcox_m3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by CurrentPTSD
W = 3460, p-value = 3.464e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>wcox_m3<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.464215e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>m3_box <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> model3<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ylab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">test_pval =</span> wcox_m3<span class="sc">$</span>p.value,</span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y_pos =</span> <span class="fl">4.5</span>,</span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="st">""</span></span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange den plots</span></span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(m1_den, </span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true" tabindex="-1"></a>                         m2_den, </span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true" tabindex="-1"></a>                         m3_den,</span>
<span id="cb297-15"><a href="#cb297-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>),</span>
<span id="cb297-16"><a href="#cb297-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb297-17"><a href="#cb297-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label_x =</span> .<span class="dv">15</span> , <span class="at">vjust =</span> <span class="dv">2</span>,</span>
<span id="cb297-18"><a href="#cb297-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="dv">2</span>))</span>
<span id="cb297-19"><a href="#cb297-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-20"><a href="#cb297-20" aria-hidden="true" tabindex="-1"></a><span class="co"># add title to den plots</span></span>
<span id="cb297-21"><a href="#cb297-21" aria-hidden="true" tabindex="-1"></a>title_den.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Distribution of risk scores"</span>,</span>
<span id="cb297-22"><a href="#cb297-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>), <span class="at">vjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb297-23"><a href="#cb297-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-24"><a href="#cb297-24" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p1, <span class="at">top =</span> title_den.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="864"></p>
</div>
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange box plots</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(m1_box, </span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>                         m2_box,</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>                         m3_box,</span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"B"</span>),</span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label_x =</span> .<span class="dv">15</span> , <span class="at">vjust =</span> <span class="dv">2</span>)</span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a><span class="co"># add title to box plots</span></span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a>title.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Difference in risk scores"</span>,</span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>), <span class="at">vjust =</span> <span class="dv">1</span>)</span>
<span id="cb298-12"><a href="#cb298-12" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p2, <span class="at">top =</span> title.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid" width="864"></p>
</div>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add x label to box plots</span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>x.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Current PTSD"</span>,</span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">15</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.5</span>)</span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange plots in grid</span></span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>p_comb <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p_comb, <span class="at">bottom =</span> x.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_v5_files/figure-html/unnamed-chunk-40-3.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
<section id="save-dfs-with-risk-scores-and-weights-to-use-in-pathway-analysis" class="level3">
<h3 class="anchored" data-anchor-id="save-dfs-with-risk-scores-and-weights-to-use-in-pathway-analysis">Save dfs with risk scores and weights to use in pathway analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># save(adj_sc_df, file =  "../../../Combined Data/2022-03-30_15-07-11/Adj_sc_df_for_pathways.RData")</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="co"># save(weights, file = "../../../Combined Data/2022-03-30_15-07-11/weights_for_pathways.RData")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="boxplot-for-negative-and-positive-coefficient-features-using" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-for-negative-and-positive-coefficient-features-using">Boxplot for negative and positive coefficient features using</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-3"><a href="#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_neg &lt;- wilcox.test(risk_score ~ CurrentPTSD, </span></span>
<span id="cb301-4"><a href="#cb301-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 data = adj_sc_df_neg$`Without NonCpG Probes`)</span></span>
<span id="cb301-5"><a href="#cb301-5" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_neg$p.value</span></span>
<span id="cb301-6"><a href="#cb301-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-7"><a href="#cb301-7" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_neg1 &lt;- wilcox.test(risk_score ~ CurrentPTSD, </span></span>
<span id="cb301-8"><a href="#cb301-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  data = adj_sc_df_neg$`Without NonCpGXY Probes`)</span></span>
<span id="cb301-9"><a href="#cb301-9" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_neg1$p.value</span></span>
<span id="cb301-10"><a href="#cb301-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-11"><a href="#cb301-11" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc_neg &lt;- make_boxplot(df = adj_sc_df_neg$`Without NonCpG Probes`, </span></span>
<span id="cb301-12"><a href="#cb301-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                               x = 'CurrentPTSD',</span></span>
<span id="cb301-13"><a href="#cb301-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                               y = 'mean_meth',</span></span>
<span id="cb301-14"><a href="#cb301-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                               xlab = 'Current PTSD',</span></span>
<span id="cb301-15"><a href="#cb301-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                               ylab = 'Mean methylation',</span></span>
<span id="cb301-16"><a href="#cb301-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                               test_pval = wcox_test_sc_neg$p.value,</span></span>
<span id="cb301-17"><a href="#cb301-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                               y_pos = .53,</span></span>
<span id="cb301-18"><a href="#cb301-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                               title = "Covariate adjusted and scaled: \n Without NonCpG Probes \n(negative coefficients)"</span></span>
<span id="cb301-19"><a href="#cb301-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb301-20"><a href="#cb301-20" aria-hidden="true" tabindex="-1"></a><span class="co"># # p1_box_sc</span></span>
<span id="cb301-21"><a href="#cb301-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-22"><a href="#cb301-22" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply(adj_sc_df_neg, dim)</span></span>
<span id="cb301-23"><a href="#cb301-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-24"><a href="#cb301-24" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply(adj_sc_df_pos, dim)</span></span>
<span id="cb301-25"><a href="#cb301-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-26"><a href="#cb301-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-27"><a href="#cb301-27" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-28"><a href="#cb301-28" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc_neg1 &lt;- make_boxplot(df = adj_sc_df_neg$`Without NonCpGXY Probes`, </span></span>
<span id="cb301-29"><a href="#cb301-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                                x = 'CurrentPTSD',</span></span>
<span id="cb301-30"><a href="#cb301-30" aria-hidden="true" tabindex="-1"></a><span class="co">#                                y = 'mean_meth',</span></span>
<span id="cb301-31"><a href="#cb301-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                                xlab = 'Current PTSD',</span></span>
<span id="cb301-32"><a href="#cb301-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                                ylab = 'Mean methylation',</span></span>
<span id="cb301-33"><a href="#cb301-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                                test_pval = wcox_test_sc_neg1$p.value,</span></span>
<span id="cb301-34"><a href="#cb301-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                                y_pos = .53,</span></span>
<span id="cb301-35"><a href="#cb301-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                                title = "Covariate adjusted and scaled: \n Without NonCpGXY Probes \n(negative coefficients)"</span></span>
<span id="cb301-36"><a href="#cb301-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb301-37"><a href="#cb301-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-38"><a href="#cb301-38" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p1_box_sc_neg, p1_box_sc_neg1, nrow = 1)</span></span>
<span id="cb301-39"><a href="#cb301-39" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-40"><a href="#cb301-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-41"><a href="#cb301-41" aria-hidden="true" tabindex="-1"></a><span class="co"># #------------------------------------</span></span>
<span id="cb301-42"><a href="#cb301-42" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_pos &lt;- wilcox.test(risk_score ~ CurrentPTSD, </span></span>
<span id="cb301-43"><a href="#cb301-43" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 data = adj_sc_df_pos$`Without NonCpG Probes`)</span></span>
<span id="cb301-44"><a href="#cb301-44" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_pos$p.value</span></span>
<span id="cb301-45"><a href="#cb301-45" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-46"><a href="#cb301-46" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_pos1 &lt;- wilcox.test(risk_score ~ CurrentPTSD, </span></span>
<span id="cb301-47"><a href="#cb301-47" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  data = adj_sc_df_pos$`Without NonCpGXY Probes`)</span></span>
<span id="cb301-48"><a href="#cb301-48" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_pos1$p.value</span></span>
<span id="cb301-49"><a href="#cb301-49" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-50"><a href="#cb301-50" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc_pos &lt;- make_boxplot(df = adj_sc_df_pos$`Without NonCpG Probes`, </span></span>
<span id="cb301-51"><a href="#cb301-51" aria-hidden="true" tabindex="-1"></a><span class="co">#                               x = 'CurrentPTSD',</span></span>
<span id="cb301-52"><a href="#cb301-52" aria-hidden="true" tabindex="-1"></a><span class="co">#                               y = 'mean_meth',</span></span>
<span id="cb301-53"><a href="#cb301-53" aria-hidden="true" tabindex="-1"></a><span class="co">#                               xlab = 'Current PTSD',</span></span>
<span id="cb301-54"><a href="#cb301-54" aria-hidden="true" tabindex="-1"></a><span class="co">#                               ylab = 'Mean methylation',</span></span>
<span id="cb301-55"><a href="#cb301-55" aria-hidden="true" tabindex="-1"></a><span class="co">#                               test_pval = wcox_test_sc_pos$p.value,</span></span>
<span id="cb301-56"><a href="#cb301-56" aria-hidden="true" tabindex="-1"></a><span class="co">#                               y_pos = .53,</span></span>
<span id="cb301-57"><a href="#cb301-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                               title = "Covariate adjusted and scaled: \n Without NonCpG Probes \n(positive coefficients)"</span></span>
<span id="cb301-58"><a href="#cb301-58" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb301-59"><a href="#cb301-59" aria-hidden="true" tabindex="-1"></a><span class="co"># # p1_box_sc</span></span>
<span id="cb301-60"><a href="#cb301-60" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-61"><a href="#cb301-61" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-62"><a href="#cb301-62" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc_pos1 &lt;- make_boxplot(df = adj_sc_df_pos$`Without NonCpGXY Probes`, </span></span>
<span id="cb301-63"><a href="#cb301-63" aria-hidden="true" tabindex="-1"></a><span class="co">#                                x = 'CurrentPTSD',</span></span>
<span id="cb301-64"><a href="#cb301-64" aria-hidden="true" tabindex="-1"></a><span class="co">#                                y = 'mean_meth',</span></span>
<span id="cb301-65"><a href="#cb301-65" aria-hidden="true" tabindex="-1"></a><span class="co">#                                xlab = 'Current PTSD',</span></span>
<span id="cb301-66"><a href="#cb301-66" aria-hidden="true" tabindex="-1"></a><span class="co">#                                ylab = 'Mean methylation',</span></span>
<span id="cb301-67"><a href="#cb301-67" aria-hidden="true" tabindex="-1"></a><span class="co">#                                test_pval = wcox_test_sc_pos1$p.value,</span></span>
<span id="cb301-68"><a href="#cb301-68" aria-hidden="true" tabindex="-1"></a><span class="co">#                                y_pos = .53,</span></span>
<span id="cb301-69"><a href="#cb301-69" aria-hidden="true" tabindex="-1"></a><span class="co">#                                title = "Covariate adjusted and scaled: \n Without NonCpGXY Probes \n(positive coefficients)"</span></span>
<span id="cb301-70"><a href="#cb301-70" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb301-71"><a href="#cb301-71" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb301-72"><a href="#cb301-72" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p1_box_sc_pos, p1_box_sc_pos1, nrow = 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mean-methylation" class="level3">
<h3 class="anchored" data-anchor-id="mean-methylation">Mean methylation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_meth &lt;- wilcox.test(mean_meth ~ CurrentPTSD, data = adj_sc_df)</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_meth</span></span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_meth$p.value</span></span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot risk scores for ptsd</span></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a><span class="co"># p2_box &lt;- make_boxplot(df = adj_sc_df, x = 'CurrentPTSD',</span></span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                        y = 'mean_meth',</span></span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                        xlab = 'Current PTSD',</span></span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                        ylab = 'Mean methylation',</span></span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                        test_pval = wcox_test_meth$p.value,</span></span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                        y_pos  = .54,</span></span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                        title = ""</span></span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb302-15"><a href="#cb302-15" aria-hidden="true" tabindex="-1"></a><span class="co"># p2_box</span></span>
<span id="cb302-16"><a href="#cb302-16" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb302-17"><a href="#cb302-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb302-18"><a href="#cb302-18" aria-hidden="true" tabindex="-1"></a><span class="co"># # life</span></span>
<span id="cb302-19"><a href="#cb302-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb302-20"><a href="#cb302-20" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_meth_life &lt;- wilcox.test(mean_meth ~ LifetimePTSD,</span></span>
<span id="cb302-21"><a href="#cb302-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                               data = adj_life_sc_df)</span></span>
<span id="cb302-22"><a href="#cb302-22" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_meth_life</span></span>
<span id="cb302-23"><a href="#cb302-23" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_meth_life$p.value</span></span>
<span id="cb302-24"><a href="#cb302-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot risk scores for ptsd</span></span>
<span id="cb302-25"><a href="#cb302-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb302-26"><a href="#cb302-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb302-27"><a href="#cb302-27" aria-hidden="true" tabindex="-1"></a><span class="co"># p2_box_l &lt;- make_boxplot(df = adj_life_sc_df, x = 'LifetimePTSD',</span></span>
<span id="cb302-28"><a href="#cb302-28" aria-hidden="true" tabindex="-1"></a><span class="co">#                        y = 'mean_meth',</span></span>
<span id="cb302-29"><a href="#cb302-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                        xlab = 'Lifetime PTSD',</span></span>
<span id="cb302-30"><a href="#cb302-30" aria-hidden="true" tabindex="-1"></a><span class="co">#                        ylab = '',</span></span>
<span id="cb302-31"><a href="#cb302-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                        test_pval = wcox_test_meth_life$p.value,</span></span>
<span id="cb302-32"><a href="#cb302-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                        y_pos  = .54,</span></span>
<span id="cb302-33"><a href="#cb302-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                        title = ""</span></span>
<span id="cb302-34"><a href="#cb302-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb302-35"><a href="#cb302-35" aria-hidden="true" tabindex="-1"></a><span class="co"># p2_box_l</span></span>
<span id="cb302-36"><a href="#cb302-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb302-37"><a href="#cb302-37" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid( p2_box, p2_box_l, nrow = 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- ### Mediation Analysis -->
<!-- ```{r} -->
<!-- # X → Y, X → M, and X + M → Y -->
<!-- test_df = adj_sc_df$`Without NonCpG Probes` -->
<!-- test_df$CurrentPTSD <- as.numeric(test_df$CurrentPTSD) -->
<!-- m1 <- lm(CurrentPTSD~Gender, data = test_df) -->
<!-- summary(m1) -->
<!-- m12 <- lm(risk_score~Gender, data = test_df) -->
<!-- summary(m12) -->
<!-- m123 <- lm(CurrentPTSD~Gender+risk_score, data = test_df) -->
<!-- summary(m123) -->
<!-- ``` -->
<!-- ### Get gene annotations -->
<!-- ```{r} -->
<!-- annot_file <- fread("D:/EWAS meta-analysis(Janelle)/data/infinium-methylationepic-v-1-0-b5-manifest-file.csv",  -->

<!--                     data.table = F, skip = 7, fill = T) -->
<!-- dim(annot_file) -->
<!-- annot_file_sub <- annot_file %>% dplyr::select(IlmnID, Infinium_Design_Type, -->
<!--                                         Genome_Build, CHR, MAPINFO, -->
<!--                                         UCSC_RefGene_Name, UCSC_RefGene_Group,  -->
<!--                                         Relation_to_UCSC_CpG_Island) -->
<!-- # Importance to percent -->
<!-- imp_cpgs_annot <- lapply(weights, function(x){ -->
<!--   # x$Importance <- x$Importance*100 -->
<!--   y <- merge(x, annot_file_sub, by = 1, all.x = T) -->
<!--   y[order(y$Importance, decreasing = T), ] -->
<!--   # annot_file[which(annot_file$IlmnID %in% x$Feature), ] -->
<!-- }) -->
<!-- lapply(imp_cpgs_annot, dim) -->
<!-- lapply(imp_cpgs_annot, head) -->
<!-- View(imp_cpgs_annot$`Without NonCpG Probes`) -->
<!-- ``` -->
<!-- ### Gene annotations -->
<!-- ```{r} -->
<!-- # neg_anno <- lapply(list, function) -->
<!-- ``` -->
<!-- ### Pathway analysis -->
<!-- ```{r} -->
<!-- # get cpgs -->
<!-- get_pathways <- function(df, Go=TRUE, kegg= NULL, fract_counts = TRUE){ -->
<!--   probes <- df %>% -->
<!--     select(starts_with(c('cg','ch.'))) -->
<!--   dim(probes) -->
<!--   cpgs <- names(probes) -->
<!--   ann <- getAnnotation(IlluminaHumanMethylationEPICanno.ilm10b2.hg19) -->
<!--   # Check number of genes that significant adj_df are annotated to -->
<!--   # check <- getMappedEntrezIDs(sig.cpg = cpgs) -->
<!--   # length(check$sig.eg) -->
<!--   if(Go & is.null(kegg) & fract_counts){ -->
<!--     message("Testing GO with fraction counts") -->
<!--     gst <- gometh(sig.cpg = cpgs,  -->
<!--                   collection = "GO", -->
<!--                   array.type = "EPIC", -->
<!--                   sig.genes = TRUE, -->
<!--                   anno = ann, -->
<!--                   prior.prob = TRUE, -->
<!--                   fract.counts = TRUE, -->
<!--                   plot.bias = TRUE) -->
<!--   }else if(kegg & fract_counts){ -->
<!--     message("Testing KEGG with fraction counts") -->
<!--     gst <- gometh(sig.cpg=cpgs, -->
<!--                   collection="KEGG", -->
<!--                   array.type = "EPIC", -->
<!--                   sig.genes = TRUE, -->
<!--                   anno = ann, -->
<!--                   prior.prob = TRUE, -->
<!--                   fract.counts = TRUE, -->
<!--                   plot.bias=TRUE) -->
<!--   } else if(Go & is.null(kegg) & !fract_counts) { -->
<!--     message("Testing GO without fraction counts") -->
<!--     gst <- gometh(sig.cpg = cpgs,  -->
<!--                   collection = "GO", -->
<!--                   array.type = "EPIC", -->
<!--                   sig.genes = TRUE, -->
<!--                   anno = ann, -->
<!--                   plot.bias = TRUE) -->
<!--   } -->
<!--   # gst <- gometh(sig.cpg=cpgs, -->
<!--   #               all.cpg = cpgs,  -->
<!--   #               collection="GO", -->
<!--   #               plot.bias=TRUE, -->
<!--   #               sig.genes = TRUE, -->
<!--   #               prior.prob = TRUE, -->
<!--   #               equiv.cpg = TRUE, -->
<!--   #               anno = ann) -->
<!--   #  -->
<!--    # gst_kegg <- gometh(sig.cpg=cpgs, -->
<!--    #            all.cpg = cpgs, -->
<!--    #            collection="KEGG", -->
<!--    #            plot.bias=TRUE, -->
<!--    #            sig.genes = TRUE, -->
<!--    #            prior.prob = TRUE, -->
<!--    #            equiv.cpg = TRUE) -->
<!--   gst -->
<!-- } -->
<!-- ``` -->
<!-- ```{r} -->
<!-- gst_nonCpGXY <- get_pathways(df = adj_sc_df$`Without NonCpGXY Probes`) -->
<!-- top_nonCpGXY <- gst_nonCpGXY[gst_nonCpGXY$P.DE <= 0.05, ] -->
<!-- # top_nonCpGXY <- topGSA(gst_nonCpGXY) -->
<!-- dim(top_nonCpGXY) -->
<!-- kegg_nonCpGXY <- get_pathways(df = adj_sc_df$`Without NonCpGXY Probes`, -->
<!--                               kegg = TRUE) -->
<!-- top_kegg_nonCpGXY <- kegg_nonCpGXY[kegg_nonCpGXY$P.DE <= 0.05, ] -->
<!-- # top_nonCpGXY <- topGSA(gst_nonCpGXY) -->
<!-- dim(top_kegg_nonCpGXY) -->
<!-- top_ls <- list("nonCpGXY_GO" = top_nonCpGXY, -->
<!--                 "nonCpGXY_KEGG" = top_kegg_nonCpGXY -->
<!--                 ) -->
<!-- lapply(top_ls, head) -->
<!-- lapply(top_ls, dim) -->
<!-- top_ls_sorted <- lapply(top_ls, function(x) x[order(x$P.DE, decreasing = F), ]) -->
<!-- lapply(top_ls_sorted, dim) -->
<!-- # write.xlsx(top_ls_sorted, "../data/top_GO_KEGG_NonCpGXY_EN_approach.xlsx",  -->
<!-- #            rowNames = T) -->
<!-- ``` -->
<!-- ### This was run with the settings NOT ACCCOUNTING FOR FRACTION COUNTS, I.e is to account for CpG number and CpGs mapping with multiple genes. -->
<!-- ```{r} -->
<!-- # gst_nonCpG <- get_pathways(df = adj_sc_df$`Without NonCpG Probes`, -->
<!-- #                              fract_counts = FALSE) -->
<!-- # top_nonCpG <- gst_nonCpGXY[gst_nonCpG$P.DE <= 0.05, ] -->
<!-- # # top_nonCpGXY <- topGSA(gst_nonCpGXY) -->
<!-- # dim(top_nonCpG) -->
<!-- #  -->
<!-- # gst_nonCpGXY <- get_pathways(df = adj_sc_df$`Without NonCpGXY Probes`,  -->
<!-- #                             fract_counts = FALSE) -->
<!-- # top_nonCpGXY <- gst_nonCpGXY[gst_nonCpGXY$P.DE <= 0.05, ] -->
<!-- # # top_nonCpGXY <- topGSA(gst_nonCpGXY) -->
<!-- # dim(top_nonCpGXY) -->
<!-- #  -->
<!-- # top_ls <- list("nonCpG" = top_nonCpG, -->
<!-- #                "nonCpGXY" = top_nonCpGXY) -->
<!-- # lapply(top_ls, head) -->
<!-- #  -->
<!-- # top_ls_sorted <- lapply(top_ls, function(x) x[order(x$P.DE, decreasing = F), ]) -->
<!-- # lapply(top_ls_sorted, dim) -->
<!-- # This was run without fraction counts -->
<!-- # write.xlsx(top_ls_sorted, "../data/top_GO_EN_approach.xlsx", rowNames = T) -->
<!-- ``` -->
<!-- ### Kegg pathways -->
<!-- ```{r} -->
<!-- # kegg_nonCpG <- get_pathways(df = adj_sc_df$`Without NonCpG Probes`,  -->
<!-- #                             kegg = TRUE) -->
<!-- # top_kegg_nonCpG <- kegg_nonCpG[kegg_nonCpG$P.DE <= 0.05, ] -->
<!-- # dim(top_kegg_nonCpG) -->
<!-- #  -->
<!-- #  -->
<!-- # kegg_nonCpGXY <- get_pathways(df = adj_sc_df$`Without NonCpGXY Probes`, -->
<!-- #                               kegg = TRUE) -->
<!-- # top_kegg_nonCpGXY <- kegg_nonCpGXY[kegg_nonCpGXY$P.DE <= 0.05, ] -->
<!-- # # top_nonCpGXY <- topGSA(gst_nonCpGXY) -->
<!-- # dim(top_kegg_nonCpGXY) -->
<!-- #  -->
<!-- # top_ls_kegg <- list("nonCpG" = top_kegg_nonCpG, -->
<!-- #                "nonCpGXY" = top_kegg_nonCpGXY) -->
<!-- # lapply(top_ls_kegg, head) -->
<!-- # top_ls_sorted_kegg <- lapply(top_ls_kegg, function(x) x[order(x$P.DE, decreasing = F), ]) -->
<!-- # lapply(top_ls_kegg, dim) -->
<!-- #  -->
<!-- # write.xlsx(top_ls_sorted_kegg, "../data/top_pathways_EN_approach.xlsx", rowNames = T) -->
<!-- ``` -->
<!-- ### Top GO terms ISTSS -->
<!-- ```{r, fig.width=9, fig.height=6.5} -->
<!-- top_ls_sorted <- read_allsheets("../data/top_GO_KEGG_NonCpGXY_EN_approach.xlsx") -->
<!-- colnames(top_ls_sorted$nonCpGXY_GO)[1] <- "GO" -->
<!-- colnames(top_ls_sorted$nonCpGXY_KEGG)[1] <- "KEGG" -->
<!-- top_25 <- top_ls_sorted$nonCpGXY_GO[1:25, ] -->
<!-- top_25$ont_new <- paste0(top_25$ONTOLOGY, ":", top_25$TERM) -->
<!-- plot_bar <- function(df, x, y, clr = NULL, fill = NULL,  -->
<!--                      xlab, ylab, title, fac_names,  -->
<!--                      fig_legend = TRUE, -->
<!--                      angle = FALSE, -->
<!--                      leg_pos = 'right', -->
<!--                      leg_title,  -->
<!--                      italic = FALSE, -->
<!--                      face = NULL){ -->
<!--   p <- df %>% -->
<!--    ggplot( aes_string(x=x, y=y, colour = clr, fill = fill)) + -->
<!--     geom_bar(stat="identity", alpha=.5, width=.3) + -->
<!--     coord_flip() + -->
<!--     xlab(xlab) + -->
<!--     ylab(ylab) + -->
<!--     ggtitle(title) -->
<!--   if(!angle & !italic){ -->
<!--       p = p + theme(axis.text.x = element_text(colour="black"),  -->
<!--             axis.text.y =element_text(colour="black"), -->
<!--             legend.position = leg_pos) + th -->
<!--   } -->
<!--   else if (italic){ -->
<!--     p = p + theme(axis.text.x = element_text(colour="black"),  -->
<!--             axis.text.y = element_text(colour="black", face = face), -->
<!--             legend.position = leg_pos) + th -->
<!--   }else{ -->
<!--         p = p + theme(axis.text.x = element_text(colour="black",  -->
<!--                                              angle = 60, vjust = 0.5),  -->
<!--             axis.text.y = element_text(colour="black"), -->
<!--             legend.position = leg_pos) + th -->
<!--   } -->
<!--  if(!fig_legend){ -->
<!--     p <- p + theme(legend.position = 'none') -->
<!--   } -->
<!--   if(leg_pos == 'top' | leg_pos == 'bottom'){ -->
<!--     print("----------------") -->
<!--     p <- p + guides(fill=guide_legend(nrow=3, byrow=TRUE, -->
<!--                                        title = leg_title)) -->
<!--   }else{ -->
<!--     p <- p + guides(fill=guide_legend(title = leg_title)) -->
<!--   } -->
<!--   p -->
<!-- } -->
<!-- top_25 <- top_25 %>% -->
<!--   mutate(TERM = fct_reorder(TERM, P.DE, .desc = T)) -->
<!-- plot_bar(df = top_25,  -->
<!--          x = "TERM", -->
<!--          y = "P.DE", -->
<!--          fill = "ONTOLOGY", -->
<!--          xlab = "Ontology term",  -->
<!--          ylab = "P value",  -->
<!--          title = "Gene Ontology: top 25", -->
<!--          leg_title = "Ontology") -->
<!-- ``` -->
<!-- ```{r, fig.width=4, fig.height=4} -->
<!-- non_cpgXY_grp <- top_ls_sorted$nonCpGXY_GO %>%  -->
<!--   group_by(ONTOLOGY) %>% -->
<!--   summarise(n = n()) -->
<!-- non_cpgXY_grp <- non_cpgXY_grp %>%  -->
<!--   mutate(Term = case_when( -->
<!--     ONTOLOGY == "BP" ~ "Biological Processes (BP)", -->
<!--     ONTOLOGY == "CC" ~ "Cellular Component (CC)", -->
<!--     ONTOLOGY == "MF" ~ "Molecular Function (MF)")) %>% -->
<!--   mutate(ONTOLOGY = fct_reorder(ONTOLOGY, n, .desc = T)) -->
<!-- plot_bar(df = non_cpgXY_grp, -->
<!--          x = "ONTOLOGY", -->
<!--          y = "n", -->
<!--          fill = "Term", -->
<!--          xlab = "Ontology", -->
<!--          ylab = "Number of terms",  -->
<!--          title = "Ontology", -->
<!--          fig_legend = TRUE, -->
<!--          leg_pos = 'top', -->
<!--          leg_title = '') -->
<!-- ``` -->
<!-- ### Pathways -->
<!-- ```{r, fig.width=9, fig.height=6.5} -->
<!-- top_25_path <- top_ls_sorted$nonCpGXY_KEGG[1:25, ] -->
<!-- top_25_path <- top_25_path %>% -->
<!--   mutate(Description = fct_reorder(Description, DE, .desc = F)) -->
<!-- View(top_25_path) -->
<!-- plot_bar(df = top_25_path, -->
<!--          x = "Description", -->
<!--          y = "DE", -->
<!--          fill = "P.DE", -->
<!--          xlab = "Description", -->
<!--          ylab = "Number of differentialy expressed genes",  -->
<!--          title = "Top 25 pathways", -->
<!--          fig_legend = TRUE, -->
<!--          leg_title = 'pvalue') -->
<!-- ``` -->
<!-- ### Plot top features with effect sizes -->
<!-- ```{r, fig.width=10} -->
<!-- # As annotation file has many duplicate gene -->
<!-- # Lets split them and get only unique ones -->
<!-- imp_cpgs_annot_long <- lapply(imp_cpgs_annot, function(x){ -->
<!--   y <- x %>% separate_rows(UCSC_RefGene_Name) -->
<!--   y[!duplicated(y$UCSC_RefGene_Name, incomparables = NA), ] # mapinfo & gene name -->
<!-- })  -->
<!-- View(imp_cpgs_annot_long$`Without NonCpGXY Probes`) -->
<!-- importance_noncpgxy <- imp_cpgs_annot_long$`Without NonCpGXY Probes` -->
<!-- # top 25  -->
<!-- top_25_es <- rbind(head(importance_noncpgxy, 13), tail(importance_noncpgxy, 12)) -->
<!-- View(top_25_es) -->
<!-- # make annotation column -->
<!-- top_25_es$annotation <- ifelse(is.na(top_25_es$UCSC_RefGene_Name), top_25_es$Feature, top_25_es$UCSC_RefGene_Name) -->
<!-- # top_25_es$annotation <- ifelse(is.na(top_25_es$UCSC_RefGene_Name), top_25_es$Feature, paste0(top_25_es$Feature, ": ", top_25_es$UCSC_RefGene_Name)) -->
<!-- top_25_es <- top_25_es %>% -->
<!--   mutate(annotation = fct_reorder(annotation, Importance, .desc = F)) -->
<!-- # create face - meaing for each label if it is plain or italic -->
<!-- # childhood trauma and trauma should be plain -->
<!-- # genes should be italic -->
<!-- top_25_es <- top_25_es %>% -->
<!--   mutate( face = case_when( -->
<!--     grepl('Child|Trauma', levels(annotation)) ~ "plain", -->
<!--     TRUE ~ "italic" -->
<!--   )) -->
<!-- top_25_es$Relation_to_UCSC_CpG_Island <- ifelse(top_25_es$Relation_to_UCSC_CpG_Island == '', NA, top_25_es$Relation_to_UCSC_CpG_Island) -->
<!-- #%>% -->
<!-- #mutate(face = factor(face, levels = c("plain", "italic"))) -->
<!-- ``` -->
<!-- ```{r, fig.width=9, fig.height=6.5} -->
<!-- ptsd_genes <- read.xlsx("../data/Genes associated with disease.xlsx") -->
<!-- View(ptsd_genes) -->
<!-- ptsd_only <- ptsd_genes[grepl("PTSD", ptsd_genes$Disease_Role), ] -->
<!-- top_25_es_wd_ptsd <- merge(top_25_es, ptsd_only, -->
<!--                    by.x = 'annotation', by.y = "Gene", -->
<!--                    all = T) -->
<!-- top_25_es_wd_ptsd <- top_25_es_wd_ptsd[order(top_25_es_wd_ptsd$Importance, decreasing = T), ] -->
<!-- plot_imp <- plot_bar(top_25_es_wd_ptsd,  -->
<!--          x = "annotation", -->
<!--          y = "Importance",  -->
<!--          fill = "Disease_Role", -->
<!--          xlab = "Features", -->
<!--          ylab = "Weight (effect size)", -->
<!--          title = "Top 25 features", -->
<!--          leg_title = 'Gene associated with:', -->
<!--          italic = TRUE, -->
<!--          face = top_25_es$face) -->
<!-- plot_imp -->
<!-- ``` -->
<!-- ### Top features with annotation for PTSD and others -->
<!-- ```{r, fig.width=10 } -->
<!-- ptsd_genes <- read.xlsx("../data/Genes associated with disease.xlsx") -->
<!-- View(ptsd_genes) -->
<!-- top_25_es_all <- merge(top_25_es, ptsd_genes, -->
<!--                    by.x = 'annotation', by.y = "Gene", -->
<!--                    all = T) -->
<!-- top_25_es_all <- top_25_es_all[order(top_25_es$Importance, decreasing = T), ] -->
<!-- plot_imp <- plot_bar(top_25_es_all,  -->
<!--          x = "annotation", -->
<!--          y = "Importance",  -->
<!--          fill = "Disease_Role", -->
<!--          xlab = "Features", -->
<!--          ylab = "Weight (effect size)", -->
<!--          title = "Top 25 features", -->
<!--          leg_title = 'Involved in:', -->
<!--          italic = TRUE, -->
<!--          face = top_25_es$face) -->
<!-- plot_imp -->
<!-- ``` -->
<!-- ```{r, fig.width=10} -->
<!-- # Top and location based on CpG island -->
<!-- plot_imp <- plot_bar(top_25_es,  -->
<!--          x = "annotation", -->
<!--          y = "Importance",  -->
<!--          fill = "Relation_to_UCSC_CpG_Island", -->
<!--          xlab = "Features", -->
<!--          ylab = "Weight (effect size)", -->
<!--          title = "Top 25 features", -->
<!--          leg_title = 'Location', -->
<!--          italic = TRUE, -->
<!--          face = top_25_es$face) -->
<!-- plot_imp -->
<!-- ``` -->
<!-- ### Pathways for negative and positive coefficient features separately -->
<!-- ```{r} -->
<!-- top_nonCpG_neg <- get_pathways(df = adj_sc_df_neg$`Without NonCpG Probes`) -->
<!-- top_nonCpG_neg -->
<!-- top_nonCpGXY_neg <- get_pathways(df = adj_sc_df_neg$`Without NonCpGXY Probes`) -->
<!-- top_nonCpGXY_neg -->
<!-- top_nonCpG_pos <- get_pathways(df = adj_sc_df_pos$`Without NonCpG Probes`) -->
<!-- top_nonCpG_pos -->
<!-- top_nonCpGXY_pos <- get_pathways(df = adj_sc_df_pos$`Without NonCpGXY Probes`) -->
<!-- top_nonCpGXY_pos -->
<!-- ``` -->
<!-- ### Check how many cpgs are on X/Y chromosomes -->
<!-- ```{r} -->
<!-- dim(annot_file) -->
<!-- # get the important cpgs from `Without NonCpG Probes` -->
<!-- imp_cpgs <- annot_file[which(annot_file$IlmnID %in% colnames(adj_sc_df$`Without NonCpG Probes`)), ] -->
<!-- dim(imp_cpgs) -->

<!-- table(imp_cpgs$IlmnID %in% colnames(adj_sc_df$`Without NonCpG Probes`)) -->
<!-- # get X/Y chromosome CpGs -->
<!-- xy_cpgs <- imp_cpgs %>% filter(CHR == 'X' | CHR == 'Y') -->
<!-- dim(xy_cpgs) -->
<!-- xy_cpgs <- xy_cpgs %>% dplyr::select(IlmnID, MAPINFO, UCSC_RefGene_Name, CHR) -->
<!-- # merge to get feature importance -->
<!-- xy_cpgs <- merge(xy_cpgs, weights$`Without NonCpG Probes`, by = 1) -->
<!-- dim(xy_cpgs) -->
<!-- View(xy_cpgs) -->
<!-- # write.csv(xy_cpgs, file = "../data/XY_chromosome_CpGs_in_important_features_selected_wd_EN.csv", -->
<!-- #           row.names = F) -->
<!-- ``` -->
<!-- ### Check common features between two datasets -->
<!-- ```{r} -->

<!-- comn <- table(adj_sc_df$`Without NonCpG Probes` %in% adj_sc_df$`Without NonCpGXY Probes`) -->
<!-- comn -->
<!-- not_comn <- which(adj_sc_df$`Without NonCpG Probes` %in% adj_sc_df$`Without NonCpGXY Probes`) -->
<!-- # not_comn -->
<!-- ``` -->
<!-- ### Now lets check how many CpGs (important features) are in the significant hits (Seyma) in meta-analysis for PTSD -->
<!-- ```{r} -->
<!-- p <- "../../../SignificantHits_Seyma/" -->
<!-- f_ls <- list.files(p, pattern = ".csv") -->
<!-- sig_hits <- lapply(f_ls, function(x) read.csv(paste0(p, x))) -->
<!-- f_names <- tools::file_path_sans_ext(f_ls) -->
<!-- names(sig_hits) <- f_names -->
<!-- lapply(sig_hits, dim) -->
<!-- # get significant hits from dfs -->
<!-- sig_hits_imp_fea <- lapply(seq_along(sig_hits), function(i){ # loop over sig hits dfs -->
<!--   x <- lapply(adj_sc_df, function(y){ # loop over non-cpgs and non-cpgsxy dfs -->
<!--     d <- sig_hits[[i]] -->
<!--     s <- d[which(d$IlmnID %in% colnames(y)), ] -->
<!--   }) -->
<!--   names(x) <- sheet_names -->
<!--   x -->
<!-- }) -->
<!-- names(sig_hits_imp_fea) <- f_names -->
<!-- print("Overlap between multi-hypo corrected sig hits and important features") -->
<!-- lapply(sig_hits_imp_fea$MainResults_IVW_EpigenomeSig, dim) -->
<!-- print("Overlap between nominally sig hits and important features") -->
<!-- lapply(sig_hits_imp_fea$MainResults_IVW_nominalSig, dim) -->
<!-- ``` -->
<!-- ### Now get these overlapped significant hits including two phenotype vars to check prediction power -->
<!-- ```{r} -->
<!-- add_cols <- cols[1:2] # we need traumanum and childmt -->
<!-- # get the overlapping cpgs plus trauma num and childmt to calculate risk score -->
<!-- adj_sc_df_ovlp <- lapply(seq_along(adj_sc_df), function(i){ -->
<!--   x <- adj_sc_df[[i]] -->
<!--   y <- sig_hits_imp_fea$MainResults_IVW_nominalSig[[i]] -->
<!--   x_sub <- x[, which(colnames(x) %in% y$IlmnID)] -->
<!--   x <- cbind(x_sub, x[, add_cols]) -->
<!-- }) -->
<!-- lapply(adj_sc_df_ovlp, dim) -->
<!-- weights_ovlp <- lapply(seq_along(adj_sc_df_ovlp), function(i){ -->
<!--   x <- adj_sc_df_ovlp[[i]] -->
<!--   y <- weights[[i]] -->
<!--   y[which(y$Feature %in% colnames(x)), ] -->
<!-- }) -->
<!-- lapply(weights_ovlp, dim) -->

<!-- Map(function(x,y) table(colnames(x) == y$Feature), adj_sc_df_ovlp, weights_ovlp) -->
<!-- adj_sc_df_ovlp <- calculate_score(adj_sc_df_ovlp, weights_ovlp, -->
<!--                              adj_df$`Without NonCpG Probes`, -->
<!--                              add_col = 'CurrentPTSD') -->
<!-- lmr_ovlp <- lm_helper(df = adj_sc_df_ovlp, f = f_cur_ptsd) -->
<!-- lmr_ovlp -->
<!-- ``` -->
<!-- ### Lets check the previously found significant hits -->
<!-- ```{r} -->
<!-- prev_cpgs <- read.xlsx("../data/CpGs previosly found PGC.xlsx") -->
<!-- dim(prev_cpgs) -->
<!-- View(prev_cpgs) -->
<!-- prev_cpgs_ovlp <- lapply(adj_sc_df, function(x){ -->
<!--   prev_cpgs[which(prev_cpgs$CPG %in% colnames(x)), ] -->
<!-- }) -->
<!-- lapply(prev_cpgs_ovlp, dim) -->
<!-- ``` -->
<!-- ### How many GRRN genes are on the list -->
<!-- ```{r} -->
<!-- grrn <- read.csv("../data/GRRN_unique_annot_ACB.csv") -->
<!-- grrn <- grrn[!grrn$Gene == "", ] -->
<!-- dim(grrn) -->
<!-- grrn_ovlp <- lapply(imp_cpgs_annot_long, function(x){ -->
<!--   merge(x, grrn, by.x = 'UCSC_RefGene_Name', by.y = 'Gene') -->
<!-- }) -->
<!-- lapply(grrn_ovlp, dim) -->
<!-- print(grrn_ovlp) -->
<!-- ``` -->
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>