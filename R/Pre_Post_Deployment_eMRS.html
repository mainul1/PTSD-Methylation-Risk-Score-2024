<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Agaz Wani">
<meta name="dcterms.date" content="2022-10-17">

<title>Pre and post deployment eMRS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Pre_Post_Deployment_eMRS_files/libs/clipboard/clipboard.min.js"></script>
<script src="Pre_Post_Deployment_eMRS_files/libs/quarto-html/quarto.js"></script>
<script src="Pre_Post_Deployment_eMRS_files/libs/quarto-html/popper.min.js"></script>
<script src="Pre_Post_Deployment_eMRS_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Pre_Post_Deployment_eMRS_files/libs/quarto-html/anchor.min.js"></script>
<link href="Pre_Post_Deployment_eMRS_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Pre_Post_Deployment_eMRS_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Pre_Post_Deployment_eMRS_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Pre_Post_Deployment_eMRS_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Pre_Post_Deployment_eMRS_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Pre and post deployment eMRS</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Agaz Wani </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 17, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="analysis" class="level3">
<h3 class="anchored" data-anchor-id="analysis">Analysis</h3>
<p>Looking at the pre and post depolyment samples in MRS, PRISMO and ArmySTARS cohorts to see how eMRS performs. We performed co-variate adjustment of the data as usual, separately for each cohort. We will add the analysis using models 2 (without exposure variables in the model) and updated weights and model 3 with adjusted exposure variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'arrow' was built under R version 4.3.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsignif)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'pROC' was built under R version 4.3.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'rms' was built under R version 4.3.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Hmisc' was built under R version 4.3.1</code></pre>
</div>
</div>
</section>
<section id="load-phenotype-and-methylation-data" class="level3">
<h3 class="anchored" data-anchor-id="load-phenotype-and-methylation-data">Load phenotype and methylation data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load phenotype </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">"G:/PGC ML/Pre_Processed Data/2021-11-15_21-41-53/"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pheno <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(path, <span class="st">"Pre_Post_MRS_ArmyS_Prismo_Pheno.csv"</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load methylation data</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>meth_data <span class="ot">&lt;-</span> <span class="fu">read_feather</span>(<span class="fu">paste0</span>(path, <span class="st">"Pre_Post_ArmyCohorts_Imputed_Covariate_adjusted_Meth_on_mvals.feather"</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>meth_data_adj_exps <span class="ot">&lt;-</span> <span class="fu">read_feather</span>(<span class="fu">paste0</span>(path, <span class="st">"Pre_Post_ArmyCohorts_Imputed_Covariate_adjusted_Meth_on_mvals_Adj_Exp_Vars.feather"</span>))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>meth_data_adj_exps <span class="ot">&lt;-</span> meth_data_adj_exps <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"__index_level_0__"</span>))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># set index as rownames</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>meth_data <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(meth_data, <span class="at">var =</span> <span class="st">"Index"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>meth_data_adj_exps <span class="ot">&lt;-</span> <span class="fu">column_to_rownames</span>(meth_data_adj_exps, </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">var =</span> <span class="st">"Index"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="explore-data" class="level3">
<h3 class="anchored" data-anchor-id="explore-data">Explore data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># studies</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pheno<span class="sc">$</span>Study)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Armystarrs        MRS     Prismo 
       346        254        117 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># current PTSD</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pheno<span class="sc">$</span>Ptsdpm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
564 128 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lifetime PTSD</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pheno<span class="sc">$</span>Ptsdlife)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
285  61 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine in a list</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>meth_data_ls <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"methdata"</span> <span class="ot">=</span> meth_data,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"meth_adj_exp"</span> <span class="ot">=</span> meth_data_adj_exps)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Methylation data dim</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(meth_data_ls, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$methdata
[1]  716 3728

$meth_adj_exp
[1]  716 4150</code></pre>
</div>
</div>
</section>
<section id="remove-any-samples-with-remitted-ptsd.-mrs-and-prismo-have-no-lifetime-ptsd.-so-well-be-checking-for-armystarrs-only." class="level3">
<h3 class="anchored" data-anchor-id="remove-any-samples-with-remitted-ptsd.-mrs-and-prismo-have-no-lifetime-ptsd.-so-well-be-checking-for-armystarrs-only.">Remove any samples with remitted PTSD. MRS and PRISMO have no lifetime PTSD. So we’ll be checking for ArmySTARRS only.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get remitted samples</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>remitted <span class="ot">&lt;-</span> pheno <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>((Ptsdpm<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> Ptsdlife<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(remitted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  7 26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove remitted from the phenotype file</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>pheno_wo_rem <span class="ot">&lt;-</span> pheno[<span class="fu">which</span>(<span class="sc">!</span>pheno<span class="sc">$</span>Basename <span class="sc">%in%</span> remitted<span class="sc">$</span>Basename), ]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pheno_wo_rem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 710  26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new id, removing substrings (_1/_2 etc) to group</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>pheno_wo_rem <span class="ot">&lt;-</span> pheno_wo_rem <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EWAS_id_new =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">_.*"</span>, <span class="st">""</span>, Ewas_Id), <span class="at">.before =</span> Ewas_Id)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(pheno_wo_rem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remove-missing-entries-in-childhood-trauma-trauma-num-and-ptsd" class="level3">
<h3 class="anchored" data-anchor-id="remove-missing-entries-in-childhood-trauma-trauma-num-and-ptsd">Remove missing entries in childhood trauma, trauma num and PTSD</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>rm_mis_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Childhood_Mt"</span>, <span class="st">"Ptsdpm"</span>, <span class="st">"Traumanum"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>pheno_clean <span class="ot">&lt;-</span> pheno_wo_rem[<span class="fu">complete.cases</span>(pheno_wo_rem[rm_mis_cols]), ]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create pre post column from visit</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>pheno_clean <span class="ot">&lt;-</span> pheno_clean <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">case_when</span>(</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    Visit <span class="sc">==</span> <span class="st">'0.0'</span> <span class="sc">|</span> Visit <span class="sc">==</span> <span class="st">'0'</span> <span class="sc">~</span> <span class="st">"Pre"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Post"</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">.before =</span> Visit)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pheno_clean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 592  28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(pheno_clean)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rename some columns for brevity</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>old_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Ptsdpm'</span>, <span class="st">'Traumanum'</span>, <span class="st">'Childhood_Mt'</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>new_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CurrentPTSD'</span>, <span class="st">'TraumaNumber'</span>, <span class="st">'ChildhoodMaltreatment'</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># function to rename columns</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>pheno_clean <span class="ot">&lt;-</span> pheno_clean <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename_at</span>(<span class="fu">vars</span>(old_cols), <span class="sc">~</span>new_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(old_cols)

  # Now:
  data %&gt;% select(all_of(old_cols))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(pheno_clean)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert some columns to factors</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>fac_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"CurrentPTSD"</span>, <span class="st">"Group"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>pheno_clean[fac_cols] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(pheno_clean[fac_cols], factor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="group-data-on-study-and-id-to-count-the-samples-for-pre-and-post-deployment" class="level3">
<h3 class="anchored" data-anchor-id="group-data-on-study-and-id-to-count-the-samples-for-pre-and-post-deployment">Group data on study and id to count the samples for pre and post deployment</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group and count</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>pheno_clean <span class="ot">&lt;-</span> pheno_clean <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(EWAS_id_new, Study) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.after =</span> Ewas_Id)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(pheno_clean)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to include pairs only</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>pheno_pre_post <span class="ot">&lt;-</span> pheno_clean <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">==</span><span class="dv">2</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(pheno_pre_post)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 524  29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PRISMO trauma burden was assessed at only time point 1</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># so those samples were filtered out when considering only trauma exposed at pre and post</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pheno_pre_post<span class="sc">$</span>Study)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Armystarrs        MRS 
       306        218 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(pheno_pre_post, "/PGC ML/Combined Data/2022-03-30_15-07-11/Pre_Post_pairs_MRS_ArmyS_Prismo.csv", row.names = F)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="split-phenotype-data-into-pre-and-post" class="level3">
<h3 class="anchored" data-anchor-id="split-phenotype-data-into-pre-and-post">Split phenotype data into pre and post</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get pre and post samples in list</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>pre_post_ls <span class="ot">&lt;-</span> <span class="fu">split</span>(pheno_pre_post, pheno_pre_post<span class="sc">$</span>Group)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pre_post_ls, <span class="cf">function</span>(x) <span class="fu">table</span>(x<span class="sc">$</span>Group))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Post

Post  Pre 
 262    0 

$Pre

Post  Pre 
   0  262 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets check if we have the same ids in pre and post</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pre_post_ls<span class="sc">$</span>Pre<span class="sc">$</span>EWAS_id_new <span class="sc">%in%</span> pre_post_ls<span class="sc">$</span>Post<span class="sc">$</span>EWAS_id_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
 262 </code></pre>
</div>
</div>
</section>
<section id="lets-get-the-samples-that-have-phenotype-information" class="level3">
<h3 class="anchored" data-anchor-id="lets-get-the-samples-that-have-phenotype-information">Lets get the samples that have phenotype information</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Also get only those samples that are in phenotype file</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>meth_imp_pre_post <span class="ot">&lt;-</span> <span class="fu">lapply</span>(meth_data_ls, <span class="cf">function</span>(x){</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  x[<span class="fu">which</span>(<span class="fu">rownames</span>(x) <span class="sc">%in%</span> pheno_pre_post<span class="sc">$</span>Basename), ]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>}) </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(meth_imp_pre_post, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$methdata
[1]  524 3728

$meth_adj_exp
[1]  524 4150</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checkf if all are matching</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(meth_imp_pre_post, <span class="cf">function</span>(x) <span class="fu">table</span>(<span class="fu">rownames</span>(x) <span class="sc">%in%</span> pheno_pre_post<span class="sc">$</span>Basename))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$methdata

TRUE 
 524 

$meth_adj_exp

TRUE 
 524 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(meth_imp_pre_post, <span class="cf">function</span>(x) <span class="fu">head</span>(x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$methdata
                    cg08169020 cg14288285 cg06765909 cg27190967 cg16132443
201533580029_R01C01  0.4823798  0.4822649  0.5052773  0.5136416  0.4976700
201533580029_R02C01  0.5336192  0.4926130  0.5304647  0.5292790  0.5131270
201533580029_R03C01  0.4277884  0.5310301  0.4822749  0.4535568  0.4468886
201533580029_R04C01  0.5938900  0.4839205  0.5036474  0.4475116  0.5614577
201533580044_R05C01  0.4927255  0.5247946  0.4844225  0.4200617  0.5488635
201533580044_R06C01  0.4948202  0.4897964  0.4760957  0.4388551  0.4717426

$meth_adj_exp
                    cg13773083 cg25293896 cg08169020 cg20378147 cg22744368
201533580029_R01C01  0.4668014  0.5685555  0.4823723  0.4673739  0.4711745
201533580029_R02C01  0.5159496  0.5020200  0.5348036  0.4061655  0.5328227
201533580029_R03C01  0.5507991  0.5525181  0.4300616  0.5031150  0.5543148
201533580029_R04C01  0.4958851  0.5530743  0.5961792  0.5160894  0.5457269
201533580044_R05C01  0.5197622  0.4790922  0.4958026  0.4886569  0.5110432
201533580044_R06C01  0.5164216  0.4282609  0.4980375  0.4315279  0.5184741</code></pre>
</div>
</div>
</section>
<section id="lets-get-pre-and-post-methylation-data" class="level3">
<h3 class="anchored" data-anchor-id="lets-get-pre-and-post-methylation-data">Lets get pre and post methylation data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split into a list</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>pre_post_meth_ls <span class="ot">&lt;-</span> <span class="fu">lapply</span>(meth_imp_pre_post, <span class="cf">function</span>(x){</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(pre_post_ls, <span class="cf">function</span>(y){</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  x[<span class="fu">which</span>(<span class="fu">rownames</span>(x) <span class="sc">%in%</span> y<span class="sc">$</span>Basename), ]</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pre_post_meth_ls, <span class="cf">function</span>(x){</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(x, dim)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>}) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$methdata
$methdata$Post
[1]  262 3728

$methdata$Pre
[1]  262 3728


$meth_adj_exp
$meth_adj_exp$Post
[1]  262 4150

$meth_adj_exp$Pre
[1]  262 4150</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine methylation and phenotype data</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># map pre methylation with pre pheno </span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and post methylatiomn with post pheno</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Also add childhood mt and trauma num to calculate risk scores</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>ct_trm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Basename"</span>, <span class="st">"ChildhoodMaltreatment"</span>, <span class="st">"TraumaNumber"</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>ct_trm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Basename"              "ChildhoodMaltreatment" "TraumaNumber"         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>pre_post_comb <span class="ot">&lt;-</span> <span class="fu">lapply</span>(pre_post_meth_ls, <span class="cf">function</span>(z){</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Map</span>(<span class="cf">function</span>(x, y) <span class="fu">merge</span>(x, y[, ct_trm],</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by.x =</span> <span class="dv">0</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by.y =</span> <span class="st">'Basename'</span>),</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>      z, </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>      pre_post_ls)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>}) </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pre_post_comb, <span class="cf">function</span>(x) <span class="fu">lapply</span>(x, dim))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$methdata
$methdata$Post
[1]  262 3731

$methdata$Pre
[1]  262 3731


$meth_adj_exp
$meth_adj_exp$Post
[1]  262 4153

$meth_adj_exp$Pre
[1]  262 4153</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(pre_post_comb<span class="sc">$</span>methdata<span class="sc">$</span>Post)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert ids to rownames</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>pre_post_comb <span class="ot">&lt;-</span> <span class="fu">lapply</span>(pre_post_comb, <span class="cf">function</span>(x){</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(x, <span class="cf">function</span>(y){</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(y, <span class="at">var =</span> <span class="st">"Row.names"</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>}) </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pre_post_comb, <span class="cf">function</span>(x) <span class="fu">lapply</span>(x, dim))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$methdata
$methdata$Post
[1]  262 3730

$methdata$Pre
[1]  262 3730


$meth_adj_exp
$meth_adj_exp$Post
[1]  262 4152

$meth_adj_exp$Pre
[1]  262 4152</code></pre>
</div>
</div>
</section>
<section id="scale-data-childhood-mt-and-trauma-num" class="level3">
<h3 class="anchored" data-anchor-id="scale-data-childhood-mt-and-trauma-num">Scale data (childhood mt and Trauma num)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Main function to scale data </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>maxmin <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>){</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(x)<span class="sc">==</span><span class="cn">TRUE</span>){</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    maxs <span class="ot">&lt;-</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    mins <span class="ot">&lt;-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale</span>(x,<span class="at">center=</span>mins,<span class="at">scale=</span>maxs<span class="sc">-</span>mins)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    maxs <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>,max)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    mins <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>,min)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale</span>(x, <span class="at">center =</span> mins, <span class="at">scale =</span> maxs <span class="sc">-</span> mins)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to scale data</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>scale_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols){</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  scale_df <span class="ot">&lt;-</span> df[, <span class="fu">which</span>(<span class="fu">names</span>(df) <span class="sc">%in%</span> (cols))]</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  scale_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">maxmin</span>(<span class="at">x =</span> scale_df, <span class="at">na.rm =</span> T))</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  other_df <span class="ot">&lt;-</span> df[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(df) <span class="sc">%in%</span> (cols))]</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(other_df, scale_df)</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to scale data</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>scale_data_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols){</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(df)){</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) <span class="fu">scale_data</span>(x, cols))</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">lapply</span>(x, dim))</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">scale_data</span>(df, cols)</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">dim</span>(x))</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scale-columns-before-calculating-risk-scores" class="level3">
<h3 class="anchored" data-anchor-id="scale-columns-before-calculating-risk-scores">Scale columns before calculating risk scores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>scale_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TraumaNumber"</span>, <span class="st">"ChildhoodMaltreatment"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>adj_sc_df <span class="ot">&lt;-</span> <span class="fu">lapply</span>(pre_post_comb, <span class="cf">function</span>(x){</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_data_helper</span>(x, scale_cols)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Post
[1]  262 3730

$Pre
[1]  262 3730

$Post
[1]  262 4152

$Pre
[1]  262 4152</code></pre>
</div>
</div>
</section>
<section id="load-feature-weights" class="level3">
<h3 class="anchored" data-anchor-id="load-feature-weights">Load feature weights</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load weights. We will use the weights from the dataset with non CpG and XY chromosome probes removed </span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>weights_wd_exp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../../Combined Data/2022-03-30_15-07-11/Important_features_wo_non_CpGsXY_EN_selected_wd_EN_l1_r_0.1.csv"</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(weights_wd_exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3730    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>weights_wo_exp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../../Combined Data/2022-03-30_15-07-11/Important_features_wo_non_CpGsXY_EN_WO_Exposure_Vars_selected_wd_EN_l1_r_0.1.csv"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>weights_wd_adj_exp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../../../Combined Data/2023-03-08_21-41-11/Important_features_wo_non_CpGsXY_Lasso_selected_wd_EN.csv"</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>weights_wd_exp<span class="sc">$</span>Feature <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(weights_wd_exp<span class="sc">$</span>Feature <span class="sc">==</span> <span class="st">'Traumanum'</span>, <span class="st">'TraumaNumber'</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(weights_wd_exp<span class="sc">$</span>Feature <span class="sc">==</span> <span class="st">'Childhood_Mt'</span>,</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'ChildhoodMaltreatment'</span>, weights_wd_exp<span class="sc">$</span>Feature))</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View(weights_wd_exp)</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># combine weights into a list</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"weights_wd_exp"</span> <span class="ot">=</span> weights_wd_exp,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">"weights_wo_exp"</span> <span class="ot">=</span> weights_wo_exp,</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">"weights_wd_adj_exp"</span> <span class="ot">=</span> weights_wd_adj_exp)</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(weights, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$weights_wd_exp
[1] 3730    2

$weights_wo_exp
[1] 3728    2

$weights_wd_adj_exp
[1] 4150    2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># current - check order</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we have 3730 in meth data and 3728 features in wo exp vars weights</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(weights,<span class="cf">function</span>(x){</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(adj_sc_df, <span class="cf">function</span>(y) {</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(y, <span class="cf">function</span>(z) <span class="fu">table</span>(<span class="fu">colnames</span>(z) <span class="sc">==</span> x<span class="sc">$</span>Feature))</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  }) </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>}) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in colnames(z) == x$Feature: longer object length is not a multiple of
shorter object length

Warning in colnames(z) == x$Feature: longer object length is not a multiple of
shorter object length

Warning in colnames(z) == x$Feature: longer object length is not a multiple of
shorter object length

Warning in colnames(z) == x$Feature: longer object length is not a multiple of
shorter object length

Warning in colnames(z) == x$Feature: longer object length is not a multiple of
shorter object length

Warning in colnames(z) == x$Feature: longer object length is not a multiple of
shorter object length

Warning in colnames(z) == x$Feature: longer object length is not a multiple of
shorter object length

Warning in colnames(z) == x$Feature: longer object length is not a multiple of
shorter object length

Warning in colnames(z) == x$Feature: longer object length is not a multiple of
shorter object length

Warning in colnames(z) == x$Feature: longer object length is not a multiple of
shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$weights_wd_exp
$weights_wd_exp$methdata
$weights_wd_exp$methdata$Post

FALSE 
 3730 

$weights_wd_exp$methdata$Pre

FALSE 
 3730 


$weights_wd_exp$meth_adj_exp
$weights_wd_exp$meth_adj_exp$Post

FALSE 
 4152 

$weights_wd_exp$meth_adj_exp$Pre

FALSE 
 4152 



$weights_wo_exp
$weights_wo_exp$methdata
$weights_wo_exp$methdata$Post

FALSE  TRUE 
 3728     2 

$weights_wo_exp$methdata$Pre

FALSE  TRUE 
 3728     2 


$weights_wo_exp$meth_adj_exp
$weights_wo_exp$meth_adj_exp$Post

FALSE 
 4152 

$weights_wo_exp$meth_adj_exp$Pre

FALSE 
 4152 



$weights_wd_adj_exp
$weights_wd_adj_exp$methdata
$weights_wd_adj_exp$methdata$Post

FALSE  TRUE 
 4149     1 

$weights_wd_adj_exp$methdata$Pre

FALSE  TRUE 
 4149     1 


$weights_wd_adj_exp$meth_adj_exp
$weights_wd_adj_exp$meth_adj_exp$Post

FALSE 
 4152 

$weights_wd_adj_exp$meth_adj_exp$Pre

FALSE 
 4152 </code></pre>
</div>
</div>
</section>
<section id="check-features" class="level3">
<h3 class="anchored" data-anchor-id="check-features">Check features</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(weights, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$weights_wd_exp
[1] 3730    2

$weights_wo_exp
[1] 3728    2

$weights_wd_adj_exp
[1] 4150    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(adj_sc_df<span class="sc">$</span>methdata, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Post
[1]  262 3730

$Pre
[1]  262 3730</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(adj_sc_df<span class="sc">$</span>meth_adj_exp, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Post
[1]  262 4152

$Pre
[1]  262 4152</code></pre>
</div>
</div>
</section>
<section id="calculate-risk-scores" class="level3">
<h3 class="anchored" data-anchor-id="calculate-risk-scores">Calculate Risk Scores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate risk scores </span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>calculate_risk_score <span class="ot">&lt;-</span> <span class="cf">function</span>(weights_ls, df_ls){</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  risk_scores <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights_ls, <span class="cf">function</span>(y){ <span class="co"># loop over weights</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    risk_scores <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df_ls, <span class="cf">function</span>(x) { <span class="co"># loop over dfs</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># meth and pheno risk scores</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>      comn_vars <span class="ot">&lt;-</span> x[, <span class="fu">which</span>(<span class="fu">colnames</span>(x) <span class="sc">%in%</span> y<span class="sc">$</span>Feature)]</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>      ord <span class="ot">&lt;-</span> comn_vars[, <span class="fu">order</span>(<span class="fu">match</span>(<span class="fu">colnames</span>(comn_vars),y<span class="sc">$</span>Feature))]</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># we don't need to run this for df with no exposure variables</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="st">"TraumaNumber"</span> <span class="sc">%in%</span> y<span class="sc">$</span>Feature){</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Ordered: "</span>, </span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">table</span>(<span class="fu">colnames</span>(ord) <span class="sc">==</span> y<span class="sc">$</span>Feature),</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">collapse =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">&lt;-</span> <span class="fu">apply</span>(ord, <span class="dv">1</span>, <span class="cf">function</span>(x)</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sum</span>(x <span class="sc">*</span> y<span class="sc">$</span>Importance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>        ord[[<span class="st">'risk_score'</span>]] <span class="ot">&lt;-</span> s</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>        ord[[<span class="st">'Percentile_risk_score'</span>]] <span class="ot">&lt;-</span> <span class="fu">percent_rank</span>(s)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># meth only risk scores</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>    meth_fea_weights <span class="ot">&lt;-</span> y <span class="sc">%&gt;%</span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^cg|^ch."</span>, Feature))</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>    meth <span class="ot">&lt;-</span> x[, <span class="fu">which</span>(<span class="fu">colnames</span>(x) <span class="sc">%in%</span> meth_fea_weights<span class="sc">$</span>Feature)]</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>    ord_meth <span class="ot">&lt;-</span> meth[, <span class="fu">order</span>(<span class="fu">match</span>(<span class="fu">colnames</span>(meth),meth_fea_weights<span class="sc">$</span>Feature))]</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Ordered: "</span>, <span class="fu">table</span>(<span class="fu">colnames</span>(ord_meth) <span class="sc">==</span> meth_fea_weights<span class="sc">$</span>Feature),<span class="at">collapse =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>    s_meth <span class="ot">&lt;-</span> <span class="fu">apply</span>(ord_meth, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">*</span> meth_fea_weights<span class="sc">$</span>Importance))</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>    ord[[<span class="st">'meth_only_risk_score'</span>]] <span class="ot">&lt;-</span> s_meth</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>    ord[[<span class="st">'Percentile_meth_risk_score'</span>]] <span class="ot">&lt;-</span> <span class="fu">percent_rank</span>(s_meth)<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>    ord</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate risk scores for with exposure and without exposures</span></span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e Model 1 and 2</span></span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>risk_scores <span class="ot">&lt;-</span> <span class="fu">calculate_risk_score</span>(<span class="at">weights_ls =</span> weights[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>],</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">df_ls =</span> adj_sc_df[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3730"
[1] "Ordered:  3728"
[1] "Ordered:  3728"
[1] "Ordered:  3728"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Risk scores with adjusted exposures variables </span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e Model 3</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>risk_scores_adj_exp <span class="ot">&lt;-</span> <span class="fu">calculate_risk_score</span>(<span class="at">weights_ls =</span> weights[<span class="dv">3</span>],</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">df_ls =</span> adj_sc_df[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  4150"
[1] "Ordered:  4150"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the risk scores</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>risk_scores<span class="sc">$</span>weights_wd_adj_exp <span class="ot">&lt;-</span> risk_scores_adj_exp<span class="sc">$</span>weights_wd_adj_exp</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(risk_scores<span class="sc">$</span>weights_wd_exp<span class="sc">$</span>Post)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate mean</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>cpg_p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cg"</span>, <span class="st">"ch."</span>) <span class="co"># pattern</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>calculate_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(df, p){</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(df)){</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) {</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mean_meth =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(cpg_p))))</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mean_meth =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(cpg_p))))</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>risk_scores <span class="ot">&lt;-</span> <span class="fu">lapply</span>(risk_scores, <span class="cf">function</span>(x) </span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_mean</span>(x, cpg_p))</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine risk score with more phenotype information</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>risk_scores_wd_pheno <span class="ot">&lt;-</span> <span class="fu">lapply</span>(risk_scores, <span class="cf">function</span>(z){</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Map</span>(<span class="cf">function</span>(x, y) <span class="fu">merge</span>(x,y,</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by.x =</span> <span class="dv">0</span>,</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>                           <span class="at">by.y =</span> <span class="st">"Basename"</span>),</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>      z, pre_post_ls)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Post
[1]  262 3764

$Pre
[1]  262 3764</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(risk_scores_wd_pheno<span class="sc">$</span>weights_wo_exp, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Post
[1]  262 3760

$Pre
[1]  262 3760</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(risk_scores_wd_pheno<span class="sc">$</span>weights_wd_adj_exp, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Post
[1]  262 4182

$Pre
[1]  262 4182</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if all are in order</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(risk_scores_wd_pheno, <span class="cf">function</span>(x) {</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(x<span class="sc">$</span>Post<span class="sc">$</span>EWAS_id_new <span class="sc">==</span> x<span class="sc">$</span>Pre<span class="sc">$</span>EWAS_id_new)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$weights_wd_exp

TRUE 
 262 

$weights_wo_exp

TRUE 
 262 

$weights_wd_adj_exp

TRUE 
 262 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine pre and post</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>risk_scores_df_long <span class="ot">&lt;-</span> <span class="fu">lapply</span>(risk_scores_wd_pheno, <span class="cf">function</span>(x){</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(x<span class="sc">$</span>Pre,x<span class="sc">$</span>Post)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(risk_scores_df_long, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$weights_wd_exp
[1]  524 3764

$weights_wo_exp
[1]  524 3760

$weights_wd_adj_exp
[1]  524 4182</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sort factor levels</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>risk_scores_df_long <span class="ot">&lt;-</span> <span class="fu">lapply</span>(risk_scores_df_long, <span class="cf">function</span>(x){</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(x<span class="sc">$</span>Group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Pre"</span>, <span class="st">"Post"</span>))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get those who developed PTSD post deployment</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>developed_ptsd <span class="ot">&lt;-</span> <span class="fu">lapply</span>(risk_scores_df_long, <span class="cf">function</span>(x)</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(EWAS_id_new) <span class="sc">%&gt;%</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">n_distinct</span>(CurrentPTSD) <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(developed_ptsd, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$weights_wd_exp
[1]  194 3764

$weights_wo_exp
[1]  194 3760

$weights_wd_adj_exp
[1]  194 4182</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get those who didn't developed PTSD post deployment</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>not_developed_ptsd <span class="ot">&lt;-</span> <span class="fu">lapply</span>(risk_scores_df_long, <span class="cf">function</span>(x)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(EWAS_id_new) <span class="sc">%&gt;%</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">n_distinct</span>(CurrentPTSD) <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(not_developed_ptsd, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$weights_wd_exp
[1]  330 3764

$weights_wo_exp
[1]  330 3760

$weights_wd_adj_exp
[1]  330 4182</code></pre>
</div>
</div>
</section>
<section id="plot-theme" class="level3">
<h3 class="anchored" data-anchor-id="plot-theme">Plot theme</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># theme setting</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span>   <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">17</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">15</span>),</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>( <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linear-model-and-plot" class="level3">
<h3 class="anchored" data-anchor-id="linear-model-and-plot">Linear model and plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to plot with lm line</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>lm_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y, xlab, ylab, title, <span class="at">group=</span><span class="st">'CurrentPTSD'</span>,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">'full'</span>, <span class="at">legend=</span><span class="st">''</span>, <span class="at">fig_legend =</span> <span class="cn">TRUE</span>){</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">'full'</span>){</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df,<span class="fu">aes_string</span>(x, y)) <span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>( <span class="at">color=</span><span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>,</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color=</span><span class="st">"darkred"</span>, <span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.5</span>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df,<span class="fu">aes_string</span>(x, y, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>( <span class="at">size =</span> <span class="dv">3</span>) </span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(fig_legend){</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"================="</span>)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_color_manual</span>(legend,</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"#0072B5FF"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#BC3C29FF"</span>))<span class="sc">+</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> group, <span class="at">color=</span>group),</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method=</span><span class="st">'lm'</span>, <span class="at">linetype=</span><span class="st">"solid"</span>,</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">1.5</span>) <span class="co">#color="blue", fill="blue",</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_color_manual</span>(legend,</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"#0072B5FF"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#BC3C29FF"</span>))<span class="sc">+</span></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)<span class="sc">+</span></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> group, <span class="at">color=</span>group),</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method=</span><span class="st">'lm'</span>, <span class="at">linetype=</span><span class="st">"solid"</span>,</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">1.5</span>) <span class="co">#color="blue", fill="blue",</span></span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(title)<span class="sc">+</span></span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab) <span class="sc">+</span></span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a>    th</span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>fig_legend){</span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb85-41"><a href="#cb85-41" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> p</span>
<span id="cb85-42"><a href="#cb85-42" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="density-plot" class="level3">
<h3 class="anchored" data-anchor-id="density-plot">Density Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot function</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>make_densityplot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y, xlab, ylab, <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">''</span>, <span class="at">legend =</span> <span class="st">''</span>, <span class="at">facet =</span> <span class="cn">FALSE</span>){</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes_string</span>(<span class="at">x=</span>x, <span class="at">group=</span>y, <span class="at">fill=</span>y)) <span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="fl">1.5</span>, <span class="at">alpha=</span>.<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlim</span>(<span class="fu">min</span>(df[[x]]), <span class="fu">max</span>(df[[x]])) <span class="sc">+</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(facet <span class="sc">!=</span> <span class="cn">FALSE</span>){</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">'Adding facet'</span>)</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, facet)))<span class="sc">+</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fig_legend){</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(legend,</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values  =</span> <span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">"#BC3C29FF"</span>))</span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(legend,</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values  =</span> <span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">"#BC3C29FF"</span>)) <span class="sc">+</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(title) <span class="sc">+</span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab)<span class="sc">+</span> th</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exposure-and-methylation-risk-scores" class="level3">
<h3 class="anchored" data-anchor-id="exposure-and-methylation-risk-scores">Exposure and methylation risk scores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function call for pre deployment, risk scores Vs. PTSD</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>p1_sc_d <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp<span class="sc">$</span>Pre, </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span><span class="st">'risk_score'</span>,</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">'eMRS'</span>,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># legend = "Current PTSD",</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Pre deployment"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_sc_d</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function call for post deployment, risk scores Vs. PTSD</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>p1_sc_d1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp<span class="sc">$</span>Post, </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">'eMRS'</span>,</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"PTSD"</span>,</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Post deployment"</span>)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1_sc_d, p1_sc_d1, </span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>),</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="st">'AUTO'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="now-lets-look-at-the-risk-scores-of-those-who-did-and-didnt-developed-ptsd-in-pre-and-post-separately.-for-pre-we-will-be-using-post-ptsd-to-see-who-did-and-didnt-develope-ptsd.-pre---noyes-and-post--noyes" class="level3">
<h3 class="anchored" data-anchor-id="now-lets-look-at-the-risk-scores-of-those-who-did-and-didnt-developed-ptsd-in-pre-and-post-separately.-for-pre-we-will-be-using-post-ptsd-to-see-who-did-and-didnt-develope-ptsd.-pre---noyes-and-post--noyes">Now lets look at the risk scores of those who did and didn’t developed PTSD in pre and post separately. For pre we will be using post ptsd to see who did and didn’t develope PTSD. Pre - no/yes and Post- no/yes</h3>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$weights_wd_exp

TRUE 
 262 

$weights_wo_exp

TRUE 
 262 

$weights_wd_adj_exp

TRUE 
 262 </code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="methylation-only-risk-scores.-we-needed-to-update-the-weights-shown-below" class="level3">
<h3 class="anchored" data-anchor-id="methylation-only-risk-scores.-we-needed-to-update-the-weights-shown-below">Methylation only risk scores. We needed to update the weights, shown below</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pre_p_meth &lt;- make_densityplot(</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   df = risk_scores_wd_pheno$weights_wd_exp$Pre, </span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   x ='meth_only_risk_score',</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   y = 'Dev_PTSD',</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab = '',</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab = "Density",</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   fig_legend = FALSE,</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   legend = "PTSD",</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   title = "Pre deployment")</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # pre_p</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co"># post_p_meth &lt;- make_densityplot(</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   df = risk_scores_wd_pheno$weights_wd_exp$Post, </span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   x ='meth_only_risk_score',</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   y = 'CurrentPTSD',</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab = '',</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab = "",</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   fig_legend = TRUE,</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   legend = "Developed \nPTSD",</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   title = "Post deployment")</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # post_p</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_only &lt;- plot_grid(pre_p_meth, post_p_meth, </span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                    rel_widths = c(1.3, 2),</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                    labels = 'A')</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a><span class="co"># x.grob &lt;- textGrob("MoRS",</span></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a><span class="co">#                    gp=gpar(fontsize=18), vjust = -1)</span></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_only &lt;- grid.arrange(arrangeGrob(p_meth_only, </span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                                         top = title.grob</span></span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                                         bottom = x.grob))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="without-exposure-variables-in-the-model" class="level3">
<h3 class="anchored" data-anchor-id="without-exposure-variables-in-the-model">Without exposure variables in the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>pre_p_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wo_exp<span class="sc">$</span>Pre, </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span><span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'Dev_PTSD'</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"PTSD"</span>,</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Pre deployment"</span>)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="co"># pre_p</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>post_p_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wo_exp<span class="sc">$</span>Post, </span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span><span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"Developed </span><span class="sc">\n</span><span class="st">PTSD"</span>,</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Post deployment"</span>)</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a><span class="co"># post_p</span></span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>p_meth_only_wo_exp <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(pre_p_meth_wo_exp, </span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>                                post_p_meth_wo_exp, </span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.3</span>, <span class="dv">2</span>),</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="st">'A'</span>)</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>x.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"MoRS"</span>,</span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>p_meth_only_wo_exp <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p_meth_only_wo_exp, </span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">bottom =</span> x.grob, </span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">top =</span> title.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="with-adjusted-exposure-variables-in-the-model" class="level3">
<h3 class="anchored" data-anchor-id="with-adjusted-exposure-variables-in-the-model">With adjusted exposure variables in the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>pre_p_meth_wd_adj_exp <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_adj_exp<span class="sc">$</span>Pre, </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span><span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'Dev_PTSD'</span>,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"PTSD"</span>,</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Pre deployment"</span>)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="co"># pre_p</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>post_p_meth_wd_adj_exp <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_adj_exp<span class="sc">$</span>Post, </span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span><span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="st">"Developed </span><span class="sc">\n</span><span class="st">PTSD"</span>,</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Post deployment"</span>)</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a><span class="co"># post_p</span></span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>p_meth_only_wd_adj_exp <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(pre_p_meth_wd_adj_exp, </span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>                                post_p_meth_wd_adj_exp, </span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.3</span>, <span class="dv">2</span>),</span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="st">'A'</span>)</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>x.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"MoRSAE"</span>,</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>p_meth_only_wd_adj_exp <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p_meth_only_wd_adj_exp, </span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">bottom =</span> x.grob, </span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">top =</span> title.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="percentile-risk-score" class="level3">
<h3 class="anchored" data-anchor-id="percentile-risk-score">Percentile risk score</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(p1_sc_d, p1_sc_d1, </span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                    rel_widths = c(1.5, 2),</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                    labels = 'AUTO')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="box-plot" class="level3">
<h3 class="anchored" data-anchor-id="box-plot">Box Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to make box plot </span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>make_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y, xlab, ylab,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>                         test_pval, y_pos, <span class="at">title =</span> <span class="cn">FALSE</span>, </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>                         fill){</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes_string</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> fill)) <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">"#BC3C29FF"</span>)) <span class="sc">+</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="fl">1.7</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span> th </span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (title <span class="sc">!=</span> <span class="cn">FALSE</span>){</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(title) }</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab)</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add significance</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">+</span> <span class="fu">geom_signif</span>(</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation =</span> <span class="fu">formatC</span>(test_pval, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_position =</span> y_pos , <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">textsize =</span> <span class="dv">5</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.02</span>))</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="methylation-and-exposure-risk-score-difference-between-cases-and-controls" class="level3">
<h3 class="anchored" data-anchor-id="methylation-and-exposure-risk-score-difference-between-cases-and-controls">Methylation and exposure risk score difference between cases and controls</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform wilcox test, risk scores Vs. pre/post</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>pre <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(risk_score <span class="sc">~</span> Dev_PTSD,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp<span class="sc">$</span>Pre)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>pre</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  risk_score by Dev_PTSD
W = 1864, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pre<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.629313e-25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform wilcox test, risk scores Vs. pre/post who deloped PTSD</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(risk_score <span class="sc">~</span> CurrentPTSD,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp<span class="sc">$</span>Post)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>post</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  risk_score by CurrentPTSD
W = 389, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>post<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.159888e-38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function call for pre post together</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>plot_pre <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp<span class="sc">$</span>Pre,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">'Dev_PTSD'</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">'Dev_PTSD'</span>,</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">'eMRS'</span>,</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_pval =</span> pre<span class="sc">$</span>p.value,</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_pos =</span> <span class="fl">3.3</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Function call for pre post who developed PTSD</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>plot_post <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp<span class="sc">$</span>Post,</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'risk_score'</span>,</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fill =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">test_pval =</span> post<span class="sc">$</span>p.value,</span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y_pos =</span> <span class="fl">4.5</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>plot_pre_post <span class="ot">&lt;-</span>  <span class="fu">plot_grid</span>(plot_pre, plot_post, <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="st">'B'</span>)</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>x.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Developed PTSD"</span>,</span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a><span class="co"># add title to box plots</span></span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>title.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Difference in risk scores"</span>,</span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>), <span class="at">vjust =</span> .<span class="dv">5</span>)</span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a>plot_pre_post <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(plot_pre_post, </span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">top =</span> title.grob,</span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">bottom =</span> x.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(den_plot, </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>          plot_pre_post,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="box-plot-for-methylation-only-risk-scores" class="level3">
<h3 class="anchored" data-anchor-id="box-plot-for-methylation-only-risk-scores">Box plot for methylation only risk scores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pre_meth &lt;- wilcox.test(meth_only_risk_score ~ Dev_PTSD,</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                         data = risk_scores_wd_pheno$weights_wd_exp$Pre)</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># pre_meth</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pre_meth$p.value</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # Perform wilcox test, risk scores Vs. pre/post who deloped PTSD</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co"># post_meth &lt;- wilcox.test(meth_only_risk_score ~ CurrentPTSD,</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                          data = risk_scores_wd_pheno$weights_wd_exp$Post)</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co"># post_meth</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="co"># post_meth$p.value</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # Function call for pre post together</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_pre &lt;- make_boxplot(</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   df = risk_scores_wd_pheno$weights_wd_exp$Pre,</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   x = 'Dev_PTSD',</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   y = 'meth_only_risk_score',</span></span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   fill = 'Dev_PTSD',</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab = '',</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab = 'MoRS',</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   test_pval = pre_meth$p.value,</span></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   y_pos = 1.9</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # Function call for pre post who developed PTSD</span></span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_post &lt;- make_boxplot(</span></span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   df = risk_scores_wd_pheno$weights_wd_exp$Post,</span></span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   x = 'CurrentPTSD',</span></span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   y = 'meth_only_risk_score',</span></span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   fill = 'CurrentPTSD',</span></span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a><span class="co">#   xlab = '',</span></span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a><span class="co">#   ylab = '',</span></span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a><span class="co">#   test_pval = post_meth$p.value,</span></span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a><span class="co">#   y_pos = 2.9</span></span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_pre_post_meth &lt;-  plot_grid(plot_pre, plot_post,</span></span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  nrow = 1, labels = 'B',</span></span>
<span id="cb106-39"><a href="#cb106-39" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  vjust = .5)</span></span>
<span id="cb106-40"><a href="#cb106-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-41"><a href="#cb106-41" aria-hidden="true" tabindex="-1"></a><span class="co"># x.grob &lt;- textGrob("Developed PTSD",</span></span>
<span id="cb106-42"><a href="#cb106-42" aria-hidden="true" tabindex="-1"></a><span class="co">#                    gp=gpar(fontsize=18), vjust = -1)</span></span>
<span id="cb106-43"><a href="#cb106-43" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-44"><a href="#cb106-44" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-45"><a href="#cb106-45" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_pre_post_meth &lt;- grid.arrange(arrangeGrob(plot_pre_post_meth,</span></span>
<span id="cb106-46"><a href="#cb106-46" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                top = title.grob,</span></span>
<span id="cb106-47"><a href="#cb106-47" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                bottom = x.grob))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p_meth_only, </span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co">#           plot_pre_post_meth,</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co">#           nrow = 2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="without-exposure-variables-in-the-model-1" class="level3">
<h3 class="anchored" data-anchor-id="without-exposure-variables-in-the-model-1">Without exposure variables in the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>pre_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> Dev_PTSD,</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wo_exp<span class="sc">$</span>Pre)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>pre_meth_wo_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by Dev_PTSD
W = 2338, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>pre_meth_wo_exp<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.140514e-21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform wilcox test, risk scores Vs. pre/post who deloped PTSD</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>post_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wo_exp<span class="sc">$</span>Post)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>post_meth_wo_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by CurrentPTSD
W = 402, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>post_meth_wo_exp<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.083543e-37</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function call for pre post together</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>plot_pre_wo_exp <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wo_exp<span class="sc">$</span>Pre,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">'Dev_PTSD'</span>,</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">'Dev_PTSD'</span>,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">'MoRS'</span>,</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_pval =</span> pre_meth_wo_exp<span class="sc">$</span>p.value,</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_pos =</span> <span class="fl">2.5</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Function call for pre post who developed PTSD</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>plot_post_wo_exp <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wo_exp<span class="sc">$</span>Post,</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_pval =</span> post_meth_wo_exp<span class="sc">$</span>p.value,</span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_pos =</span> <span class="dv">3</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>plot_pre_post_meth_wo_exp <span class="ot">&lt;-</span>  <span class="fu">plot_grid</span>(plot_pre_wo_exp,</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>                                        plot_post_wo_exp, </span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels =</span> <span class="st">'B'</span>,</span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">vjust =</span> .<span class="dv">5</span>)</span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a>x.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Developed PTSD"</span>,</span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a>plot_pre_post_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(plot_pre_post_meth_wo_exp,</span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">top =</span> title.grob,</span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">bottom =</span> x.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_meth_only_wo_exp, </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>          plot_pre_post_meth_wo_exp,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="with-adjusted-exposure-variables-in-the-model-1" class="level3">
<h3 class="anchored" data-anchor-id="with-adjusted-exposure-variables-in-the-model-1">With adjusted exposure variables in the model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>pre_meth_wd_adj_exp <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> Dev_PTSD,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_adj_exp<span class="sc">$</span>Pre)</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>pre_meth_wd_adj_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by Dev_PTSD
W = 2205, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>pre_meth_wd_adj_exp<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.269413e-22</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform wilcox test, risk scores Vs. pre/post who deloped PTSD</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>post_meth_wd_adj_exp <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_adj_exp<span class="sc">$</span>Post)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>post_meth_wd_adj_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by CurrentPTSD
W = 474, p-value &lt; 2.2e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>post_meth_wd_adj_exp<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.166633e-37</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function call for pre post together</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>plot_pre_wd_adj_exp <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_adj_exp<span class="sc">$</span>Pre,</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">'Dev_PTSD'</span>,</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">'Dev_PTSD'</span>,</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">'MoRSAE'</span>,</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_pval =</span> pre_meth_wd_adj_exp<span class="sc">$</span>p.value,</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_pos =</span> <span class="fl">2.5</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Function call for pre post who developed PTSD</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>plot_post_wd_adj_exp <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_adj_exp<span class="sc">$</span>Post,</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">''</span>,</span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">test_pval =</span> post_meth_wd_adj_exp<span class="sc">$</span>p.value,</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_pos =</span> <span class="dv">3</span></span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>plot_pre_post_meth_wd_adj_exp <span class="ot">&lt;-</span>  <span class="fu">plot_grid</span>(plot_pre_wd_adj_exp,</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>                                        plot_post_wd_adj_exp, </span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="st">'B'</span>,</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">vjust =</span> .<span class="dv">5</span>)</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>x.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Developed PTSD"</span>,</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">18</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>plot_pre_post_meth_wd_adj_exp <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(plot_pre_post_meth_wd_adj_exp,</span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">top =</span> title.grob,</span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>                                                          <span class="at">bottom =</span> x.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_meth_only_wd_adj_exp, </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>          plot_pre_post_meth_wd_adj_exp,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="linear-model-old" class="level3">
<h3 class="anchored" data-anchor-id="linear-model-old">Linear model old</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sink("G:/PGC ML/Combined Data/2022-03-30_15-07-11/Linear model PTSD summary_coeff_as_weights_selected_wd_EN_lr_0.1.txt")</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>lm_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(df, f){</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"====================================================="</span>)</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  analy <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"Data frame"</span>, <span class="fu">deparse</span>(<span class="fu">substitute</span>(df))), <span class="at">collapse =</span> <span class="st">':'</span>),</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"Formula"</span>, f), <span class="at">collapse =</span> <span class="st">':'</span>)), <span class="at">collapse =</span> <span class="st">', '</span>)</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analy)</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(df) <span class="sc">&amp;</span> <span class="fu">length</span>(df) <span class="sc">&lt;</span> <span class="dv">5</span>){<span class="co"># is.list is true for single df </span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">names</span>(df)</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(f)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>    lmr <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(df), <span class="cf">function</span>(i){</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">lm</span>(f, <span class="at">data =</span> df[[i]])</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(n[i])</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">summary</span>(x))</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>      x</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>    }) </span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(f)</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>    lmr <span class="ot">&lt;-</span> <span class="fu">lm</span>(f, <span class="at">data =</span> df)</span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(<span class="fu">summary</span>(lmr))</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>    lmr</span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a><span class="co"># PTSD formula</span></span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a>f_cur_ptsd <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'risk_score~'</span>, <span class="st">'CurrentPTSD'</span>))</span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>f_cur_ptsd_meth <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'meth_only_risk_score~'</span>, <span class="st">'CurrentPTSD'</span>))</span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a><span class="co"># PTSS formula</span></span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a>f_ptss <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'risk_score~'</span>, <span class="st">'Pts_Severity'</span>))</span>
<span id="cb128-33"><a href="#cb128-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-34"><a href="#cb128-34" aria-hidden="true" tabindex="-1"></a><span class="co"># current PTSD</span></span>
<span id="cb128-35"><a href="#cb128-35" aria-hidden="true" tabindex="-1"></a><span class="co"># lmr_adj &lt;- lm_helper(df = adj_df, f = f_cur_ptsd)</span></span>
<span id="cb128-36"><a href="#cb128-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-37"><a href="#cb128-37" aria-hidden="true" tabindex="-1"></a>lmr_pre_post <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp<span class="sc">$</span>Post, <span class="at">f =</span> f_cur_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:risk_scores_wd_pheno$weights_wd_exp$Post, Formula:risk_score ~ CurrentPTSD"
risk_score ~ CurrentPTSD

Call:
lm(formula = f, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.59661 -0.66773 -0.07463  0.61400  2.52716 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.21003    0.07049  -2.979  0.00316 ** 
CurrentPTSD1  2.63793    0.11585  22.770  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9055 on 260 degrees of freedom
Multiple R-squared:  0.666, Adjusted R-squared:  0.6647 
F-statistic: 518.5 on 1 and 260 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>lmr_pre_post_ptsd <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df =</span> developed_ptsd<span class="sc">$</span>weights_wd_exp, <span class="at">f =</span> f_cur_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:developed_ptsd$weights_wd_exp, Formula:risk_score ~ CurrentPTSD"
risk_score ~ CurrentPTSD

Call:
lm(formula = f, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.5966 -0.6926 -0.1002  0.6763  2.4270 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    1.4811     0.1001  14.789  &lt; 2e-16 ***
CurrentPTSD1   0.9468     0.1416   6.685 2.44e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9864 on 192 degrees of freedom
Multiple R-squared:  0.1888,    Adjusted R-squared:  0.1846 
F-statistic: 44.69 on 1 and 192 DF,  p-value: 2.443e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># without exp in the model</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>lmr_pre_post_wo_exp <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wo_exp<span class="sc">$</span>Post, </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:risk_scores_wd_pheno$weights_wo_exp$Post, Formula:meth_only_risk_score ~ CurrentPTSD"
meth_only_risk_score ~ CurrentPTSD

Call:
lm(formula = f, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.53813 -0.35153  0.08757  0.44930  2.23835 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.14329    0.05795  -2.473    0.014 *  
CurrentPTSD1  2.26947    0.09524  23.830   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7444 on 260 degrees of freedom
Multiple R-squared:  0.6859,    Adjusted R-squared:  0.6847 
F-statistic: 567.9 on 1 and 260 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>lmr_pre_post_ptsd_wo_exp <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df =</span> developed_ptsd<span class="sc">$</span>weights_wo_exp, </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:developed_ptsd$weights_wo_exp, Formula:meth_only_risk_score ~ CurrentPTSD"
meth_only_risk_score ~ CurrentPTSD

Call:
lm(formula = f, data = df)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.53813 -0.30994  0.07026  0.47150  1.93746 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    1.2726     0.0733  17.361  &lt; 2e-16 ***
CurrentPTSD1   0.8535     0.1037   8.233 2.74e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.722 on 192 degrees of freedom
Multiple R-squared:  0.2609,    Adjusted R-squared:  0.2571 
F-statistic: 67.79 on 1 and 192 DF,  p-value: 2.745e-14</code></pre>
</div>
</div>
</section>
<section id="check-if-risk-scores-from-pre-predict-ptsd-at-post" class="level3">
<h3 class="anchored" data-anchor-id="check-if-risk-scores-from-pre-predict-ptsd-at-post">Check if risk scores from pre predict PTSD at post</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine required columns from pre, post</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>pre_post_sub <span class="ot">&lt;-</span> <span class="fu">lapply</span>(risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp, <span class="cf">function</span>(x){</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EWAS_id_new, risk_score, meth_only_risk_score,</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>         mean_meth, CurrentPTSD)</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pre_post_sub, head)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Post
  EWAS_id_new risk_score meth_only_risk_score mean_meth CurrentPTSD
1        4317  0.7130171           -0.4763601 0.5052245           0
2        4334  1.1917987           -0.4431202 0.5005001           0
3        4303  1.5794572           -0.5575090 0.5067465           1
4        4254  0.4438776           -1.6149051 0.4931315           0
5       12415  2.4050997            1.1556875 0.5051139           1
6       12626  0.8973687           -0.5052931 0.4959614           0

$Pre
  EWAS_id_new risk_score meth_only_risk_score mean_meth CurrentPTSD
1        4317 -0.1363863           -1.2301662 0.4994477           0
2        4334  1.6594501            0.1201286 0.5015175           0
3        4303  1.0906777           -0.6638992 0.5018571           0
4        4254  0.8607826           -0.7200135 0.4968567           0
5       12415  0.5739843           -0.3408372 0.5019123           0
6       12626  0.9753855           -0.4272763 0.5012530           0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if all are matching</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pre_post_sub<span class="sc">$</span>Pre<span class="sc">$</span>EWAS_id_new <span class="sc">==</span> pre_post_sub<span class="sc">$</span>Post<span class="sc">$</span>EWAS_id_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
 262 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>pre_post_sub_comb <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, pre_post_sub)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="co"># predict pre deployment risk scores using post deployment PTSD</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>lmr_pred_pre_rs <span class="ot">&lt;-</span> <span class="fu">lm</span>(Pre.risk_score <span class="sc">~</span> Post.CurrentPTSD, </span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> pre_post_sub_comb )</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmr_pred_pre_rs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Pre.risk_score ~ Post.CurrentPTSD, data = pre_post_sub_comb)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.1688 -0.6105 -0.1097  0.5388  2.2455 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       0.005431   0.067336   0.081    0.936    
Post.CurrentPTSD1 1.475637   0.110665  13.334   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8649 on 260 degrees of freedom
Multiple R-squared:  0.4061,    Adjusted R-squared:  0.4038 
F-statistic: 177.8 on 1 and 260 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict post risk scores using post deployment PTSD</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>lmr_pred_post_rs <span class="ot">&lt;-</span> <span class="fu">lm</span>(Post.risk_score <span class="sc">~</span> Post.CurrentPTSD,</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> pre_post_sub_comb)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmr_pred_post_rs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Post.risk_score ~ Post.CurrentPTSD, data = pre_post_sub_comb)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.59661 -0.66773 -0.07463  0.61400  2.52716 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       -0.21003    0.07049  -2.979  0.00316 ** 
Post.CurrentPTSD1  2.63793    0.11585  22.770  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9055 on 260 degrees of freedom
Multiple R-squared:  0.666, Adjusted R-squared:  0.6647 
F-statistic: 518.5 on 1 and 260 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict post risk scores using pre deployment risk scores</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>lmr_pred_post_wd_pre_rs <span class="ot">&lt;-</span> <span class="fu">lm</span>(Post.risk_score <span class="sc">~</span> Pre.risk_score,</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> pre_post_sub_comb)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmr_pred_post_wd_pre_rs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Post.risk_score ~ Pre.risk_score, data = pre_post_sub_comb)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.80957 -0.52709 -0.03623  0.45661  2.40004 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     0.09661    0.05324   1.814   0.0708 .  
Pre.risk_score  1.21431    0.04270  28.436   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7728 on 260 degrees of freedom
Multiple R-squared:  0.7567,    Adjusted R-squared:  0.7558 
F-statistic: 808.6 on 1 and 260 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict post PTSD using pre deployment risk scores</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>lmr_pred_post_ptsd_wd_pre_rs <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.numeric</span>(Post.CurrentPTSD) <span class="sc">~</span> Pre.risk_score, </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">data =</span> pre_post_sub_comb)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmr_pred_post_ptsd_wd_pre_rs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = as.numeric(Post.CurrentPTSD) ~ Pre.risk_score, data = pre_post_sub_comb)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.83787 -0.27103 -0.06718  0.28911  0.97091 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     1.21837    0.02573   47.34   &lt;2e-16 ***
Pre.risk_score  0.27522    0.02064   13.33   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3735 on 260 degrees of freedom
Multiple R-squared:  0.4061,    Adjusted R-squared:  0.4038 
F-statistic: 177.8 on 1 and 260 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict post PTSD using pre deployment methylation only risk scores</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>lmr_pred_post_ptsd_wd_pre_meth_rs <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.numeric</span>(Post.CurrentPTSD) <span class="sc">~</span> Pre.meth_only_risk_score, <span class="at">data =</span> pre_post_sub_comb)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmr_pred_post_ptsd_wd_pre_meth_rs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = as.numeric(Post.CurrentPTSD) ~ Pre.meth_only_risk_score, 
    data = pre_post_sub_comb)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.88367 -0.30407 -0.05706  0.28887  0.96254 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               1.39224    0.02415   57.64   &lt;2e-16 ***
Pre.meth_only_risk_score  0.33535    0.02815   11.91   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3898 on 260 degrees of freedom
Multiple R-squared:  0.3532,    Adjusted R-squared:  0.3507 
F-statistic:   142 on 1 and 260 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="lets-use-logistic-model-to-predict-post-deployment-ptsd-using-pre-deployment-emrs-and-mrs-from-model-1" class="level3">
<h3 class="anchored" data-anchor-id="lets-use-logistic-model-to-predict-post-deployment-ptsd-using-pre-deployment-emrs-and-mrs-from-model-1">Lets use logistic model to predict post deployment PTSD using pre deployment eMRS and MRS from model 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exposure and methylation risk scores</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>Postptsd_vs_pre_rs_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Post.CurrentPTSD <span class="sc">~</span> Pre.risk_score, </span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> pre_post_sub_comb, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Postptsd_vs_pre_rs_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Post.CurrentPTSD ~ Pre.risk_score, family = "binomial", 
    data = pre_post_sub_comb)

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)     -1.8457     0.2466  -7.483 7.24e-14 ***
Pre.risk_score   1.9206     0.2428   7.910 2.58e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 345.36  on 261  degrees of freedom
Residual deviance: 215.61  on 260  degrees of freedom
AIC: 219.61

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using rms package to get pseud rsquared</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Pseudo RSquared ..................."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Pseudo RSquared ...................</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lrm</span>(Post.CurrentPTSD <span class="sc">~</span> Pre.risk_score, </span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> pre_post_sub_comb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model

lrm(formula = Post.CurrentPTSD ~ Pre.risk_score, data = pre_post_sub_comb)

                       Model Likelihood      Discrimination    Rank Discrim.    
                             Ratio Test             Indexes          Indexes    
Obs           262    LR chi2     129.74      R2       0.533    C       0.884    
 0            165    d.f.             1      R2(1,262)0.388    Dxy     0.767    
 1             97    Pr(&gt; chi2) &lt;0.0001    R2(1,183.3)0.505    gamma   0.767    
max |deriv| 6e-07                            Brier    0.135    tau-a   0.359    

               Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept      -1.8457 0.2466 -7.48  &lt;0.0001 
Pre.risk_score  1.9206 0.2428  7.91  &lt;0.0001 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>rs_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(Postptsd_vs_pre_rs_model, pre_post_sub_comb, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(pre_post_sub_comb<span class="sc">$</span>Post.CurrentPTSD, rs_predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8835</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># methylation risk scores</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>Postptsd_vs_pre_mrs_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Post.CurrentPTSD <span class="sc">~</span> Pre.meth_only_risk_score, </span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> pre_post_sub_comb, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Postptsd_vs_pre_mrs_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Post.CurrentPTSD ~ Pre.meth_only_risk_score, family = "binomial", 
    data = pre_post_sub_comb)

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -0.6942     0.1678  -4.136 3.53e-05 ***
Pre.meth_only_risk_score   2.1554     0.2716   7.935 2.10e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 345.36  on 261  degrees of freedom
Residual deviance: 234.22  on 260  degrees of freedom
AIC: 238.22

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Pseudo RSquared ..................."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Pseudo RSquared ...................</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lrm</span>(Post.CurrentPTSD <span class="sc">~</span> Pre.meth_only_risk_score, </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> pre_post_sub_comb))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model

lrm(formula = Post.CurrentPTSD ~ Pre.meth_only_risk_score, data = pre_post_sub_comb)

                       Model Likelihood      Discrimination    Rank Discrim.    
                             Ratio Test             Indexes          Indexes    
Obs           262    LR chi2     111.13      R2       0.472    C       0.859    
 0            165    d.f.             1      R2(1,262)0.343    Dxy     0.718    
 1             97    Pr(&gt; chi2) &lt;0.0001    R2(1,183.3)0.452    gamma   0.718    
max |deriv| 2e-08                            Brier    0.145    tau-a   0.336    

                         Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept                -0.6942 0.1678 -4.14  &lt;0.0001 
Pre.meth_only_risk_score  2.1554 0.2716  7.94  &lt;0.0001 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>mrs_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(Postptsd_vs_pre_mrs_model, pre_post_sub_comb, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(pre_post_sub_comb<span class="sc">$</span>Post.CurrentPTSD, mrs_predicted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1
Setting direction: controls &lt; cases</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.8592</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model 1 emrs vs model 1 mrs</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we do this test to see if there is a significant differene </span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co"># between two models</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>anv_tst <span class="ot">&lt;-</span> <span class="fu">anova</span>(Postptsd_vs_pre_rs_model, </span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>                 Postptsd_vs_pre_mrs_model,</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">test=</span><span class="st">"Chisq"</span>)</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>anv_tst</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: Post.CurrentPTSD ~ Pre.risk_score
Model 2: Post.CurrentPTSD ~ Pre.meth_only_risk_score
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1       260     215.61                     
2       260     234.22  0   -18.61         </code></pre>
</div>
</div>
</section>
<section id="logistic-model-for-mrs-from-model-2-same-features-but-updated-weights" class="level3">
<h3 class="anchored" data-anchor-id="logistic-model-for-mrs-from-model-2-same-features-but-updated-weights">Logistic model for MRS from model 2 (same features but updated weights)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine required columns from pre, post</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>pre_post_sub_model2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(risk_scores_wd_pheno<span class="sc">$</span>weights_wo_exp, <span class="cf">function</span>(x){</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EWAS_id_new, meth_only_risk_score,</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>         mean_meth, CurrentPTSD)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pre_post_sub_model2, head)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Post
  EWAS_id_new meth_only_risk_score mean_meth CurrentPTSD
1        4317           0.21283166 0.5052245           0
2        4334           0.04053421 0.5005001           0
3        4303           0.12952653 0.5067465           1
4        4254          -1.07507132 0.4931315           0
5       12415           1.87217596 0.5051139           1
6       12626           0.01521823 0.4959614           0

$Pre
  EWAS_id_new meth_only_risk_score mean_meth CurrentPTSD
1        4317          -0.59669905 0.4994477           0
2        4334           0.72850755 0.5015175           0
3        4303          -0.02420541 0.5018571           0
4        4254          -0.07810475 0.4968567           0
5       12415           0.30703773 0.5019123           0
6       12626           0.16998094 0.5012530           0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if all are matching</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pre_post_sub_model2<span class="sc">$</span>Pre<span class="sc">$</span>EWAS_id_new <span class="sc">==</span> pre_post_sub_model2<span class="sc">$</span>Post<span class="sc">$</span>EWAS_id_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
 262 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>pre_post_sub_comb_model2 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, pre_post_sub_model2)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="co"># model </span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="co"># exposure and methylation risk scores</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>Postptsd_vs_pre_rs_model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Post.CurrentPTSD <span class="sc">~</span> Pre.meth_only_risk_score, </span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> pre_post_sub_comb_model2, </span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Postptsd_vs_pre_rs_model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Post.CurrentPTSD ~ Pre.meth_only_risk_score, family = "binomial", 
    data = pre_post_sub_comb_model2)

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.9731     0.2605  -7.575 3.58e-14 ***
Pre.meth_only_risk_score   1.9933     0.2520   7.908 2.61e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 345.36  on 261  degrees of freedom
Residual deviance: 236.46  on 260  degrees of freedom
AIC: 240.46

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Pseudo RSquared ..................."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Pseudo RSquared ...................</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lrm</span>(Post.CurrentPTSD <span class="sc">~</span> Pre.meth_only_risk_score, </span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> pre_post_sub_comb_model2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model

lrm(formula = Post.CurrentPTSD ~ Pre.meth_only_risk_score, data = pre_post_sub_comb_model2)

                       Model Likelihood      Discrimination    Rank Discrim.    
                             Ratio Test             Indexes          Indexes    
Obs           262    LR chi2     108.90      R2       0.464    C       0.854    
 0            165    d.f.             1      R2(1,262)0.338    Dxy     0.708    
 1             97    Pr(&gt; chi2) &lt;0.0001    R2(1,183.3)0.445    gamma   0.708    
max |deriv| 9e-09                            Brier    0.146    tau-a   0.331    

                         Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept                -1.9731 0.2605 -7.58  &lt;0.0001 
Pre.meth_only_risk_score  1.9933 0.2520  7.91  &lt;0.0001 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model 1 emrs vs model 2 mrs</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>anv_tst_1_vs_2 <span class="ot">&lt;-</span> <span class="fu">anova</span>(Postptsd_vs_pre_rs_model, </span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>                 Postptsd_vs_pre_rs_model2,</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">test=</span><span class="st">"Chisq"</span>)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>anv_tst_1_vs_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: Post.CurrentPTSD ~ Pre.risk_score
Model 2: Post.CurrentPTSD ~ Pre.meth_only_risk_score
  Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
1       260     215.61                     
2       260     236.46  0  -20.843         </code></pre>
</div>
</div>
</section>
<section id="logistic-model-for-mrs-from-model-3-adjusted-exposure-variables" class="level3">
<h3 class="anchored" data-anchor-id="logistic-model-for-mrs-from-model-3-adjusted-exposure-variables">Logistic model for MRS from model 3 (adjusted exposure variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine required columns from pre, post</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>pre_post_sub_model3 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(risk_scores_wd_pheno<span class="sc">$</span>weights_wd_adj_exp, <span class="cf">function</span>(x){</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(EWAS_id_new, meth_only_risk_score,</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>         mean_meth, CurrentPTSD)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pre_post_sub_model3, head)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Post
  EWAS_id_new meth_only_risk_score mean_meth CurrentPTSD
1        4317           0.06283213 0.5065094           0
2        4334          -0.22159717 0.4997949           0
3        4303           0.03485500 0.5070850           1
4        4254          -0.76668817 0.4907805           0
5       12415           0.82833814 0.5090503           1
6       12626          -0.43164586 0.4964306           0

$Pre
  EWAS_id_new meth_only_risk_score mean_meth CurrentPTSD
1        4317            0.9428973 0.4969417           0
2        4334           -0.6582107 0.5011060           0
3        4303            0.5057378 0.5007159           0
4        4254           -0.5681724 0.4967537           0
5       12415           -0.6977690 0.5030954           0
6       12626            0.3491446 0.5015881           0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if all are matching</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(pre_post_sub_model3<span class="sc">$</span>Pre<span class="sc">$</span>EWAS_id_new <span class="sc">==</span> pre_post_sub_model3<span class="sc">$</span>Post<span class="sc">$</span>EWAS_id_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
 262 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>pre_post_sub_comb_model3 <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, pre_post_sub_model3)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="co"># model </span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="co"># exposure and methylation risk scores</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>Postptsd_vs_pre_rs_model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Post.CurrentPTSD <span class="sc">~</span> Pre.meth_only_risk_score, </span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> pre_post_sub_comb_model3, </span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Postptsd_vs_pre_rs_model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Post.CurrentPTSD ~ Pre.meth_only_risk_score, family = "binomial", 
    data = pre_post_sub_comb_model3)

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               -1.2986     0.1997  -6.504 7.83e-11 ***
Pre.meth_only_risk_score   1.7768     0.2257   7.874 3.44e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 345.36  on 261  degrees of freedom
Residual deviance: 232.09  on 260  degrees of freedom
AIC: 236.09

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Pseudo RSquared ..................."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Pseudo RSquared ...................</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">lrm</span>(Post.CurrentPTSD <span class="sc">~</span> Pre.meth_only_risk_score, </span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> pre_post_sub_comb_model3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Logistic Regression Model

lrm(formula = Post.CurrentPTSD ~ Pre.meth_only_risk_score, data = pre_post_sub_comb_model3)

                       Model Likelihood      Discrimination    Rank Discrim.    
                             Ratio Test             Indexes          Indexes    
Obs           262    LR chi2     113.26      R2       0.479    C       0.862    
 0            165    d.f.             1      R2(1,262)0.349    Dxy     0.725    
 1             97    Pr(&gt; chi2) &lt;0.0001    R2(1,183.3)0.458    gamma   0.725    
max |deriv| 5e-08                            Brier    0.143    tau-a   0.339    

                         Coef    S.E.   Wald Z Pr(&gt;|Z|)
Intercept                -1.2986 0.1997 -6.50  &lt;0.0001 
Pre.meth_only_risk_score  1.7768 0.2257  7.87  &lt;0.0001 </code></pre>
</div>
</div>
<p><br>
<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># lm with pre and post risk scores</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>lm_pre_post_rs <span class="ot">&lt;-</span> <span class="fu">lm_plot</span>(<span class="at">df =</span> pre_post_sub_comb, </span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">'Pre.risk_score'</span>,</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Post.risk_score'</span>,</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">"Pre risk score"</span>,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab  =</span> <span class="st">"Post risk score"</span>,</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">model =</span> <span class="st">'seperate'</span>,</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group =</span> <span class="st">"Post.CurrentPTSD"</span>,</span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend =</span> <span class="st">'PTSD'</span>,</span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Relationship between </span><span class="sc">\n</span><span class="st">Pre and Post risk scores"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "================="</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>lm_pre_post_rs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="line-plot" class="level3">
<h3 class="anchored" data-anchor-id="line-plot">Line Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>line_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y, group, color,</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>                      legend, <span class="at">title =</span> <span class="cn">NULL</span>, </span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">xlab =</span> <span class="cn">NULL</span>, <span class="at">ylab =</span> <span class="cn">NULL</span>,</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig_legend =</span> <span class="cn">TRUE</span>){</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>( <span class="fu">aes_string</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">group=</span>group,</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> color)) <span class="sc">+</span> </span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span><span class="dv">1</span>) </span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span>  <span class="fu">scale_color_manual</span>(<span class="st">"PTSD"</span>, <span class="at">values =</span> </span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"#0072B5FF"</span>, </span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#BC3C29FF"</span>)) </span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb198-14"><a href="#cb198-14" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(title)<span class="sc">+</span></span>
<span id="cb198-15"><a href="#cb198-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb198-16"><a href="#cb198-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab) <span class="sc">+</span></span>
<span id="cb198-17"><a href="#cb198-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb198-18"><a href="#cb198-18" aria-hidden="true" tabindex="-1"></a>    th</span>
<span id="cb198-19"><a href="#cb198-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb198-20"><a href="#cb198-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>fig_legend){</span>
<span id="cb198-21"><a href="#cb198-21" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb198-22"><a href="#cb198-22" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> p</span>
<span id="cb198-23"><a href="#cb198-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb198-24"><a href="#cb198-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-25"><a href="#cb198-25" aria-hidden="true" tabindex="-1"></a><span class="fu">line_plot</span>(<span class="at">df =</span> pre_post_sub_comb,</span>
<span id="cb198-26"><a href="#cb198-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> <span class="st">"Pre.risk_score"</span>,</span>
<span id="cb198-27"><a href="#cb198-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Post.risk_score"</span>,</span>
<span id="cb198-28"><a href="#cb198-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">group =</span> <span class="st">"Post.CurrentPTSD"</span>,</span>
<span id="cb198-29"><a href="#cb198-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"Post.CurrentPTSD"</span>,</span>
<span id="cb198-30"><a href="#cb198-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend =</span> <span class="st">"Post PTSD"</span>,</span>
<span id="cb198-31"><a href="#cb198-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Pre Vs Post deployment risk scores"</span>,</span>
<span id="cb198-32"><a href="#cb198-32" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Pre risk score"</span>,</span>
<span id="cb198-33"><a href="#cb198-33" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Post risk score"</span></span>
<span id="cb198-34"><a href="#cb198-34" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</section>
<section id="correlation-plot" class="level3">
<h3 class="anchored" data-anchor-id="correlation-plot">Correlation plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>get_correlation <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols, new_names){</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">ungroup</span>(df)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(cols)</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>  indx <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df, is.factor)</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>  df[indx] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df[indx], <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(x)))</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> new_names</span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>  cor_df <span class="ot">&lt;-</span> <span class="fu">cor</span>(df)</span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">cor.mtest</span>(df, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adjusted pvalues</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>  p_adj <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">p.adjust</span>(<span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(p<span class="sc">$</span>p)),</span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method=</span><span class="st">'fdr'</span>),</span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ncol=</span><span class="fu">ncol</span>(cor_df))</span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(p_adj) <span class="ot">&lt;-</span> new_names</span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(p_adj) <span class="ot">&lt;-</span> new_names</span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a>  df_ls <span class="ot">&lt;-</span> <span class="fu">list</span>(cor_df, p_adj)</span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(df_ls) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cor"</span>, <span class="st">"padj"</span>)</span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_ls)</span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-22"><a href="#cb199-22" aria-hidden="true" tabindex="-1"></a>get_correlation_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols, new_names){</span>
<span id="cb199-23"><a href="#cb199-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.list</span>(df)) {</span>
<span id="cb199-24"><a href="#cb199-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Processing list ..."</span>)</span>
<span id="cb199-25"><a href="#cb199-25" aria-hidden="true" tabindex="-1"></a>    x_cor <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) <span class="fu">get_correlation</span>(x, cols, new_names))</span>
<span id="cb199-26"><a href="#cb199-26" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb199-27"><a href="#cb199-27" aria-hidden="true" tabindex="-1"></a>    x_cor <span class="ot">&lt;-</span> <span class="fu">get_correlation</span>(df, cols, new_names)</span>
<span id="cb199-28"><a href="#cb199-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb199-29"><a href="#cb199-29" aria-hidden="true" tabindex="-1"></a>  x_cor</span>
<span id="cb199-30"><a href="#cb199-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb199-31"><a href="#cb199-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-32"><a href="#cb199-32" aria-hidden="true" tabindex="-1"></a><span class="co"># color palette</span></span>
<span id="cb199-33"><a href="#cb199-33" aria-hidden="true" tabindex="-1"></a>colrs <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">'#7F0000'</span>,</span>
<span id="cb199-34"><a href="#cb199-34" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'#FF7F00'</span>, <span class="st">'orange'</span>,</span>
<span id="cb199-35"><a href="#cb199-35" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'cyan'</span>, <span class="st">'#007FFF'</span>, <span class="st">'blue'</span>, <span class="st">'#00007F'</span>,</span>
<span id="cb199-36"><a href="#cb199-36" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"#BC3C29FF"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TraumaNumber.x"</span>, <span class="st">"ChildhoodMaltreatment.x"</span>, <span class="st">"risk_score"</span>,</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"CurrentPTSD"</span>, <span class="st">"mean_meth"</span>)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>new_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cumulative trauma"</span>, <span class="st">"Childhood maltreatment"</span>, </span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Risk score"</span>, <span class="st">"Current PTSD"</span>, <span class="st">"Mean methylation"</span>)</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="co"># risk scores of pre post</span></span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>cor_dfs <span class="ot">&lt;-</span> <span class="fu">get_correlation</span>(<span class="at">df =</span> risk_scores_df_long<span class="sc">$</span>weights_wd_exp ,</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">cols =</span> cols,</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">new_names =</span> new_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(cols)

  # Now:
  data %&gt;% select(all_of(cols))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(cor_dfs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "cor"  "padj"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># risk scores of those who didn't developed ptsd </span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>cor_dfs_noptsd <span class="ot">&lt;-</span>  <span class="fu">get_correlation</span>(<span class="at">df =</span> not_developed_ptsd<span class="sc">$</span>weights_wd_exp,</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">cols =</span> cols,</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">new_names =</span> new_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(df): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(x, y): the standard deviation is zero

Warning in cor(x, y): the standard deviation is zero

Warning in cor(x, y): the standard deviation is zero

Warning in cor(x, y): the standard deviation is zero</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># risk scores of those who developed ptsd between pre and post</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>cor_dfs_ptsd <span class="ot">&lt;-</span>  <span class="fu">get_correlation</span>(<span class="at">df =</span> developed_ptsd<span class="sc">$</span>weights_wd_exp,</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">cols =</span> cols,</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">new_names =</span> new_names)</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="co"># risk scores of pre deployment</span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>cor_dfs_pre <span class="ot">&lt;-</span>  <span class="fu">get_correlation</span>(<span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp<span class="sc">$</span>Pre,</span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cols =</span> cols,</span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">new_names =</span> new_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># risk scores of post deployment</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>cor_dfs_post <span class="ot">&lt;-</span>  <span class="fu">get_correlation</span>(<span class="at">df =</span> risk_scores_wd_pheno<span class="sc">$</span>weights_wd_exp<span class="sc">$</span>Post,</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cols =</span> cols,</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">new_names =</span> new_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plots" class="level3">
<h3 class="anchored" data-anchor-id="plots">Plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get correlation between different variables</span></span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>correlation_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(cor_df, title){</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(cor_df<span class="sc">$</span>cor,</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.mat =</span> cor_df<span class="sc">$</span>padj,</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"pie"</span>,</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span>,  <span class="at">number.cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex =</span> <span class="fl">1.4</span>, <span class="at">cl.cex =</span> <span class="fl">1.4</span>,</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>),</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch.cex =</span> <span class="fl">1.4</span>,<span class="at">insig =</span> <span class="st">'label_sig'</span>,</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cl.ratio =</span> <span class="fl">0.4</span>,</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>),</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">colrs</span>(<span class="dv">10</span>),</span>
<span id="cb210-14"><a href="#cb210-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> title)</span>
<span id="cb210-15"><a href="#cb210-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recordPlot</span>()</span>
<span id="cb210-16"><a href="#cb210-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-call-for-correlation-plots" class="level3">
<h3 class="anchored" data-anchor-id="function-call-for-correlation-plots">Function call for correlation plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>p_adj <span class="ot">&lt;-</span> <span class="fu">correlation_plot</span>(cor_dfs, <span class="at">title =</span> <span class="st">'All from pre and post'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>p_adj_noptsd <span class="ot">&lt;-</span> <span class="fu">correlation_plot</span>(cor_dfs_noptsd, <span class="at">title =</span> <span class="st">"Didn't develope PTSD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-44-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>p_adj_ptsd <span class="ot">&lt;-</span> <span class="fu">correlation_plot</span>(cor_dfs_ptsd, <span class="at">title =</span> <span class="st">'Developed PTSD'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-44-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="pre-and-post-deployment-plots" class="level3">
<h3 class="anchored" data-anchor-id="pre-and-post-deployment-plots">Pre and post deployment plots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>cor_dfs_pre <span class="ot">&lt;-</span> <span class="fu">correlation_plot</span>(cor_dfs_pre, </span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">title =</span> <span class="st">'Pre deployment'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>cor_dfs_post <span class="ot">&lt;-</span>  <span class="fu">correlation_plot</span>(cor_dfs_post, </span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">title =</span> <span class="st">'Post deployment'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Pre_Post_Deployment_eMRS_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   correlation_plot(cor_dfs_pre, </span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                               title = 'Pre deployment'),</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   correlation_plot(cor_dfs_post, </span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                               title = 'Post deployment')</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>