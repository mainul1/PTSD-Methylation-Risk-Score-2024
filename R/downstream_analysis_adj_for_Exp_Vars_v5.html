<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Agaz Wani">

<title>Downstream analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="downstream_analysis_adj_for_Exp_Vars_v5_files/libs/clipboard/clipboard.min.js"></script>
<script src="downstream_analysis_adj_for_Exp_Vars_v5_files/libs/quarto-html/quarto.js"></script>
<script src="downstream_analysis_adj_for_Exp_Vars_v5_files/libs/quarto-html/popper.min.js"></script>
<script src="downstream_analysis_adj_for_Exp_Vars_v5_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="downstream_analysis_adj_for_Exp_Vars_v5_files/libs/quarto-html/anchor.min.js"></script>
<link href="downstream_analysis_adj_for_Exp_Vars_v5_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="downstream_analysis_adj_for_Exp_Vars_v5_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="downstream_analysis_adj_for_Exp_Vars_v5_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="downstream_analysis_adj_for_Exp_Vars_v5_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="downstream_analysis_adj_for_Exp_Vars_v5_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Downstream analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Agaz Wani </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="note-some-features-have-0-importance-in-random-forest-a-case-when-a-feature-is-not-used-to-make-a-spilit.-these-features-are-still-important-because-their-presence-influences-how-the-splits-occur-even-if-they-are-not-involved-in-any-splits." class="level3">
<h3 class="anchored" data-anchor-id="note-some-features-have-0-importance-in-random-forest-a-case-when-a-feature-is-not-used-to-make-a-spilit.-these-features-are-still-important-because-their-presence-influences-how-the-splits-occur-even-if-they-are-not-involved-in-any-splits.">Note: Some features have 0 importance in Random Forest, a case when a feature is not used to make a spilit. These features are still important because their presence influences how the splits occur, even if they are not involved in any splits.</h3>
<section id="this-version-has-weights-from-other-approachs-coefficients-to-improve-the-risk-scores" class="level4">
<h4 class="anchored" data-anchor-id="this-version-has-weights-from-other-approachs-coefficients-to-improve-the-risk-scores">This version has weights from other approachs (coefficients) to improve the risk scores</h4>
</section>
</section>
<section id="code-to-test-correlationassociation-between-mrs-and-ptsd-and-perform-enrichment-analysis." class="level3">
<h3 class="anchored" data-anchor-id="code-to-test-correlationassociation-between-mrs-and-ptsd-and-perform-enrichment-analysis.">Code to test correlation/association between MRS and PTSD and perform enrichment analysis.</h3>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section">————————————————</h4>
</section>
<section id="note-this-notebook-uses-important-features-using-kbest-and-elastic-net-approach-and-trauma-and-childhood-trauma-as-covariates-in-data-adjustment" class="level4">
<h4 class="anchored" data-anchor-id="note-this-notebook-uses-important-features-using-kbest-and-elastic-net-approach-and-trauma-and-childhood-trauma-as-covariates-in-data-adjustment">Note: This notebook uses important features using (kbest and elastic net approach) and trauma and childhood trauma as covariates in data adjustment</h4>
<div class="cell">

</div>
</section>
</section>
<section id="risk-scores-on-test-set" class="level3">
<h3 class="anchored" data-anchor-id="risk-scores-on-test-set">risk scores on test set</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2021-10-02_23-12-43 previous path</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="st">"G:/PGC ML/Combined Data/2023-03-08_21-41-11/Elasticnet risk scores ptsdpm test data.xlsx"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get trauma and childhood trauma from the previous file to look at the correlation</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>fname_old <span class="ot">&lt;-</span> <span class="st">"G:/PGC ML/Combined Data/2022-03-30_15-07-11/Elasticnet risk scores ptsdpm test data.xlsx"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>sheet_names <span class="ot">&lt;-</span> <span class="fu">getSheetNames</span>(fname)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># function to read all sheets</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>read_allsheets <span class="ot">&lt;-</span> <span class="cf">function</span>(path){</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  sheet_nms <span class="ot">&lt;-</span> <span class="fu">getSheetNames</span>(path)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  sheets <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sheet_nms, read.xlsx, <span class="at">xlsxFile =</span> path)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(sheets) <span class="ot">&lt;-</span> sheet_nms</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sheets)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># call function for current and lifetime PTSD</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co">#current</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">&lt;-</span> <span class="fu">read_allsheets</span>(<span class="at">path =</span> fname)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>adj_df_old <span class="ot">&lt;-</span> <span class="fu">read_allsheets</span>(<span class="at">path =</span> fname_old)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>adj_df_old <span class="ot">&lt;-</span> <span class="fu">lapply</span>(adj_df_old, <span class="cf">function</span>(x) x[, <span class="fu">c</span>(<span class="st">"Basename"</span>, <span class="st">"Traumanum"</span>, <span class="st">"Childhood_Mt"</span>)])</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">&lt;-</span> <span class="fu">Map</span>(<span class="cf">function</span>(x, y) <span class="fu">merge</span>(x, y), adj_df, adj_df_old)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># lifetime is in two different files (noncpgs and noncpgsXY)</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>feapath <span class="ot">&lt;-</span> <span class="st">"G:/PGC ML/Combined Data/2023-03-08_21-41-11/"</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>file_ls <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> feapath,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pattern =</span> <span class="st">".csv"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>ptsdlife_file_ls <span class="ot">&lt;-</span> file_ls[<span class="fu">grepl</span>(<span class="st">"^ElasticNet_ptsdlife"</span>, file_ls)]</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>adj_df_life <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ptsdlife_file_ls, <span class="cf">function</span>(x) <span class="fu">read.csv</span>(<span class="fu">paste0</span>(feapath, x)))</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(adj_df_life) <span class="ot">&lt;-</span> sheet_names</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># rename some columns for brevity</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>ptsd_old_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'ptsdpm'</span>, <span class="st">'Traumanum'</span>, <span class="st">'Childhood_Mt'</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>ptsd_new_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'CurrentPTSD'</span>, <span class="st">'TraumaNumber'</span>, <span class="st">'ChildhoodMaltreatment'</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># function to rename columns</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>replace_names <span class="ot">&lt;-</span> <span class="cf">function</span>(df, old_cols, new_cols, fac_col){</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x){</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">rename_at</span>(<span class="fu">vars</span>(old_cols), <span class="sc">~</span>new_cols)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  x[[fac_col]] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(x[[fac_col]])</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(fac_col)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">lapply</span>(df, dim))</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  df</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Current PTSD</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">&lt;-</span> <span class="fu">replace_names</span>(adj_df, ptsd_old_cols, ptsd_new_cols, <span class="st">"CurrentPTSD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(old_cols)

  # Now:
  data %&gt;% select(all_of(old_cols))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CurrentPTSD"
$`Without NonCpG Probes`
[1]  307 4255

$`Without NonCpGXY Probes`
[1]  307 4155</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(adj_df$`Without NonCpGXY Probes`)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lifetime</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>ptsdl_old_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"PtsdLife"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>ptsdl_new_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'LifetimePTSD'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>lifetime_df <span class="ot">&lt;-</span> <span class="fu">replace_names</span>(adj_df_life, ptsdl_old_cols, ptsdl_new_cols,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'LifetimePTSD'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LifetimePTSD"
$`Without NonCpG Probes`
[1]  308 4252

$`Without NonCpGXY Probes`
[1]  308 4152</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(lifetime_df, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  308 4252

$`Without NonCpGXY Probes`
[1]  308 4152</code></pre>
</div>
</div>
</section>
<section id="after-kurt-ran-the-analysis-we-want-to-investigate-why-the-direction-of-effect-change-between-discovery-cohots-and-the-replication-cohort.-we-will-run-stratified-test-for-army-and-civilian-cohorts." class="level3">
<h3 class="anchored" data-anchor-id="after-kurt-ran-the-analysis-we-want-to-investigate-why-the-direction-of-effect-change-between-discovery-cohots-and-the-replication-cohort.-we-will-run-stratified-test-for-army-and-civilian-cohorts.">After kurt ran the analysis we want to investigate why the direction of effect change between discovery cohots and the replication cohort. We will run stratified test for army and civilian cohorts.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data from all chorts</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>all_cohorts <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"G:/PGC ML/Pre_Processed Data/2021-11-15_21-41-53/DNHS_GTP_MRS_ArmyS_Prismo_Pheno.csv"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Now add Ptss and gender information to test sets</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">=</span> <span class="fu">lapply</span>(adj_df, <span class="cf">function</span>(x){</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(x, all_cohorts[, <span class="fu">c</span>(<span class="st">"Basename"</span>, <span class="st">"Pts_Severity"</span>, <span class="st">"Gender"</span>, <span class="st">"Study"</span>)],</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> <span class="st">"Basename"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(adj_df, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  307 4258

$`Without NonCpGXY Probes`
[1]  307 4158</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>lifetime_df <span class="ot">=</span> <span class="fu">lapply</span>(lifetime_df, <span class="cf">function</span>(x){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(x, all_cohorts[, <span class="fu">c</span>(<span class="st">"Basename"</span>, <span class="st">"Pts_Severity"</span>, <span class="st">"Gender"</span>, <span class="st">"Study"</span>)],</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> <span class="st">"Basename"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(lifetime_df, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  308 4255

$`Without NonCpGXY Probes`
[1]  308 4155</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a copy of test set for individual analysis for just one dataset</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>individual_cohorts_testset <span class="ot">&lt;-</span> adj_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># remove scaled columns from test set for individual cohort analysis for test set</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># individual_cohorts_testset &lt;- individual_cohorts_testset %&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(-c("ChildhoodMaltreatment", "TraumaNumber"))</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># individual_cohorts_testset &lt;- merge(individual_cohorts_testset, </span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     all_cohorts[, c("Basename", </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                     "Childhood_Mt", </span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                     "Traumanum")],</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                                     by = "Basename")</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># individual_cohorts_testset &lt;- individual_cohorts_testset %&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(ChildhoodMaltreatment = Childhood_Mt,</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#          TraumaNumber = Traumanum)</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># remove some columns that we already have</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>all_cohorts <span class="ot">&lt;-</span> all_cohorts <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"Childhood_Mt"</span>, <span class="st">"Traumanum"</span>))</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># View(all_cohorts)</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Important features for current and lifetime PTSD datasets (both train and test)</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="co"># we need this information to check if we have remitted in lifetime ptsd </span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>current <span class="ot">&lt;-</span> <span class="fu">read_allsheets</span>(<span class="at">path =</span> <span class="fu">paste0</span>(feapath,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"ElasticNet_Current_ptsd_important_features_Adj_wd_Exp_Vars.xlsx"</span>))</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co"># lets get  trauma variables from this file</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>feapath_old <span class="ot">&lt;-</span> <span class="st">"G:/PGC ML/Combined Data/2022-03-30_15-07-11/"</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>current_old <span class="ot">&lt;-</span> <span class="fu">read_allsheets</span>(<span class="at">path =</span> <span class="fu">paste0</span>(feapath_old,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"ElasticNet_Current_ptsd_important_features.xlsx"</span>))</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>current_old <span class="ot">&lt;-</span> <span class="fu">lapply</span>(current_old, <span class="cf">function</span>(x) x[, <span class="fu">c</span>(<span class="st">"Basename"</span>, <span class="st">"Traumanum"</span>, <span class="st">"Childhood_Mt"</span>)])</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>current <span class="ot">&lt;-</span> <span class="fu">Map</span>(<span class="cf">function</span>(x, y) <span class="fu">merge</span>(x, y), current, current_old)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>lifetime <span class="ot">&lt;-</span> <span class="fu">read_allsheets</span>(<span class="at">path =</span> <span class="fu">paste0</span>(feapath,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"ElasticNet_Lifetime_ptsd_important_features_Adj_wd_Exp_Vars.xlsx"</span>)) </span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co"># combine current and lifetime to check if we have remitted for lifetime</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>cur_life_comn <span class="ot">&lt;-</span> <span class="fu">merge</span>(all_cohorts,</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>                       lifetime<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">by =</span> <span class="st">"Basename"</span>)</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>cur_life_comn <span class="ot">&lt;-</span> cur_life_comn <span class="sc">%&gt;%</span> <span class="fu">select</span>(Basename, Ptsdpm, Ptsdlife, Pts_Severity)</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cur_life_comn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1229    4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remitted</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>remitted <span class="ot">&lt;-</span> cur_life_comn <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Ptsdpm <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> Ptsdlife <span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(remitted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 219   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Remitted samples in lifetime PTSD: "</span>, <span class="fu">nrow</span>(remitted)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Remitted samples in lifetime PTSD: 219"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(remitted)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># important features should match between current and lifetime PTSD</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># one column - current with lifetime PTSD will not match - that is ok </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">colnames</span>(current<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>) <span class="sc">==</span> <span class="fu">colnames</span>(lifetime<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in colnames(current$`Without NonCpG Probes`) ==
colnames(lifetime$`Without NonCpG Probes`): longer object length is not a
multiple of shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
    3  4251 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">colnames</span>(current<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>) <span class="sc">==</span> <span class="fu">colnames</span>(lifetime<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in colnames(current$`Without NonCpGXY Probes`) ==
colnames(lifetime$`Without NonCpGXY Probes`): longer object length is not a
multiple of shorter object length</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
    3  4151 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to load the train test set for current ptsd to get gender information</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This is from earlier version where we had gender as important feature</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>train_test <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"G:/PGC ML/Combined Data/2021-11-27_19-16-35/Current_ptsd_important_features.csv"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Now combine to get additional helpful information such as basename/gender</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and order data based on sample ids (i.e Basename)</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>current_comb <span class="ot">&lt;-</span> <span class="fu">lapply</span>(current, <span class="cf">function</span>(x){</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">merge</span>(x, all_cohorts, <span class="at">by =</span> <span class="st">"Basename"</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y[<span class="fu">order</span>(<span class="fu">match</span>(y<span class="sc">$</span>Basename, train_test<span class="sc">$</span>Basename)), ]</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>} )</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample ids should match</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(current_comb<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>Basename <span class="sc">==</span> train_test<span class="sc">$</span>Basename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
1226 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(current_comb<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Basename <span class="sc">==</span> train_test<span class="sc">$</span>Basename)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
1226 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace old columns with new </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ptsd_cur_old_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'current_ptsd'</span>, ptsd_old_cols[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>current_comb <span class="ot">&lt;-</span> <span class="fu">replace_names</span>(current_comb, ptsd_cur_old_cols, ptsd_new_cols, <span class="st">"CurrentPTSD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "CurrentPTSD"
$`Without NonCpG Probes`
[1] 1226 4274

$`Without NonCpGXY Probes`
[1] 1226 4174</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(current_comb)</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># To get each Army cohort separately. Also get CpGs and important phenotype.</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>army_p <span class="ot">&lt;-</span> <span class="st">'Armystarrs|MRS|Prismo'</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'cg'</span>, <span class="st">'ch'</span>, <span class="st">'trauma'</span>, </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">'childhood'</span>, <span class="st">'CurrentPTSD'</span>, </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">'LifetimePTSD'</span>, <span class="st">"Basename"</span>, </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Gender"</span>, <span class="st">"Pts_Severity"</span>, <span class="st">"Study"</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get studies of interest</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>filter_study <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols, p){</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">grepl</span>(<span class="st">"Current"</span>, <span class="fu">colnames</span>(df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>), <span class="at">ignore.case =</span> T))){</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Current PTSD....."</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> {<span class="fu">print</span>(<span class="st">"Lifetime PTSD ......"</span>)}</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Studies :"</span>, p))</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> </span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">filter</span>(<span class="fu">grepl</span>(p, Study)) <span class="sc">%&gt;%</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(<span class="fu">contains</span>(cols)))</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">lapply</span>(x, dim))</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">grepl</span>(p, Study)) <span class="sc">%&gt;%</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">contains</span>(cols)) </span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">dim</span>(x))</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="co"># get individual cohorts. We will use only the dataset without non-cpg and xy probes </span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>individual_cohorts <span class="ot">&lt;-</span> current_comb<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span> <span class="sc">%&gt;%</span> </span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">which</span>(<span class="fu">grepl</span>(<span class="st">"Base|cg|Gender|Childhood|Trauma|CurrentPTSD|Pts_Sev|Study"</span>,<span class="fu">colnames</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(<span class="at">f =</span> <span class="fu">as.factor</span>(.<span class="sc">$</span>Study))</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(individual_cohorts, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1]  153 4157

$DNHS
[1]  416 4157

$GTP
[1]  484 4157

$MRS
[1]  123 4157

$Prismo
[1]   50 4157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># individual cohorts form test set</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>individual_cohorts_testset <span class="ot">&lt;-</span> individual_cohorts_testset <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">which</span>(<span class="fu">grepl</span>(<span class="st">"Base|cg|Gender|Childhood|Trauma|CurrentPTSD|Pts_Sev|Study"</span>,<span class="fu">colnames</span>(.)))) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(<span class="at">f =</span> <span class="fu">as.factor</span>(.<span class="sc">$</span>Study))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(individual_cohorts_testset, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1]   39 4157

$DNHS
[1]  113 4157

$GTP
[1]  119 4157

$MRS
[1]   28 4157

$Prismo
[1]    8 4157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cur_army <span class="ot">&lt;-</span> <span class="fu">filter_study</span>(current_comb, <span class="fu">c</span>(cols, <span class="st">"Study"</span>), army_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Current PTSD....."
[1] "Studies : Armystarrs|MRS|Prismo"
$`Without NonCpG Probes`
[1]  326 4257

$`Without NonCpGXY Probes`
[1]  326 4157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(cur_army)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>civ_p <span class="ot">&lt;-</span> <span class="st">'DNHS|GTP'</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>cur_civ <span class="ot">&lt;-</span> <span class="fu">filter_study</span>(current_comb, <span class="fu">c</span>(cols, <span class="st">"Study"</span>), civ_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Current PTSD....."
[1] "Studies : DNHS|GTP"
$`Without NonCpG Probes`
[1]  900 4257

$`Without NonCpGXY Probes`
[1]  900 4157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lifetime --------------------</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>lifetime_comb <span class="ot">&lt;-</span> <span class="fu">lapply</span>(lifetime, <span class="cf">function</span>(x) <span class="fu">merge</span>(x, all_cohorts,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">by =</span> <span class="st">"Basename"</span>))</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>lifetime_old_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'lifetime_ptsd'</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>lifetime_comb <span class="ot">&lt;-</span> <span class="fu">replace_names</span>(lifetime_comb, lifetime_old_cols,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                               ptsdl_new_cols, <span class="st">'LifetimePTSD'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "LifetimePTSD"
$`Without NonCpG Probes`
[1] 1229 4272

$`Without NonCpGXY Probes`
[1] 1229 4172</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>life_army <span class="ot">&lt;-</span> <span class="fu">filter_study</span>(lifetime_comb, cols, army_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lifetime PTSD ......"
[1] "Studies : Armystarrs|MRS|Prismo"
$`Without NonCpG Probes`
[1]  173 4255

$`Without NonCpGXY Probes`
[1]  173 4155</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(life_army)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>life_civ <span class="ot">&lt;-</span> <span class="fu">filter_study</span>(lifetime_comb, cols, civ_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Lifetime PTSD ......"
[1] "Studies : DNHS|GTP"
$`Without NonCpG Probes`
[1] 1056 4255

$`Without NonCpGXY Probes`
[1] 1056 4155</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now to calculate risk scores on both training and test sets</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>current_all <span class="ot">&lt;-</span> <span class="fu">lapply</span>(current_comb, <span class="cf">function</span>(x) x <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(cols)))</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(current_all, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 1226 4257

$`Without NonCpGXY Probes`
[1] 1226 4157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>life_all <span class="ot">&lt;-</span> <span class="fu">lapply</span>(lifetime_comb, <span class="cf">function</span>(x) x<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">contains</span>(cols)))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(life_all, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 1229 4255

$`Without NonCpGXY Probes`
[1] 1229 4155</code></pre>
</div>
</div>
</section>
<section id="correlation-on-covariate-unadjusted-data" class="level3">
<h3 class="anchored" data-anchor-id="correlation-on-covariate-unadjusted-data">Correlation on covariate unadjusted data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unadj &lt;- arrow::read_feather("G:/PGC ML/Pre_Processed Data/2021-11-15_21-41-53/Imputed_DNHS_GTP_MRS_ArmyS_Prsm.feather")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="to-calculate-risk-scores-from-data-remove-the-risk-scores-in-ml-python-code-and-ptsd" class="level3">
<h3 class="anchored" data-anchor-id="to-calculate-risk-scores-from-data-remove-the-risk-scores-in-ml-python-code-and-ptsd">To calculate risk scores from data remove the risk scores (in ML python code) and ptsd</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to remove some columns</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>remove_columns <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols){</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) x[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(x) <span class="sc">%in%</span> cols)])</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">lapply</span>(x, dim))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> df[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(df) <span class="sc">%in%</span> cols)]</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">dim</span>(x))</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># calling function</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns to remove from current and lifetime ptsd</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>rm_cur_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"risk_score"</span>, <span class="st">"Basename"</span>, <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Gender"</span>, <span class="st">"Pts_Severity"</span>, <span class="st">"Study"</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>rm_life_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'LifetimePTSD'</span>, <span class="st">'Basename'</span>,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Gender"</span>, <span class="st">"Pts_Severity"</span>, <span class="st">"Study"</span>)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>test_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(adj_df, rm_cur_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  307 4252

$`Without NonCpGXY Probes`
[1]  307 4152</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>individual_sc_test <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(individual_cohorts_testset,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(rm_cur_cols, <span class="st">"Study"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1]   39 4152

$DNHS
[1]  113 4152

$GTP
[1]  119 4152

$MRS
[1]   28 4152

$Prismo
[1]    8 4152</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>individual_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(individual_cohorts, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">c</span>(rm_cur_cols, <span class="st">"Study"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1]  153 4152

$DNHS
[1]  416 4152

$GTP
[1]  484 4152

$MRS
[1]  123 4152

$Prismo
[1]   50 4152</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>army_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(cur_army, rm_cur_cols[<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  326 4252

$`Without NonCpGXY Probes`
[1]  326 4152</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>civ_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(cur_civ, rm_cur_cols[<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  900 4252

$`Without NonCpGXY Probes`
[1]  900 4152</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>army_life_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(life_army, rm_life_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  173 4250

$`Without NonCpGXY Probes`
[1]  173 4150</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>test_life_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(lifetime_df, rm_life_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  308 4250

$`Without NonCpGXY Probes`
[1]  308 4150</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>current_all_sc <span class="ot">&lt;-</span> <span class="fu">remove_columns</span>(current_all, rm_cur_cols[<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 1226 4252

$`Without NonCpGXY Probes`
[1] 1226 4152</code></pre>
</div>
</div>
</section>
<section id="function-to-scale-the-data-between-0-1" class="level3">
<h3 class="anchored" data-anchor-id="function-to-scale-the-data-between-0-1">function to scale the data between 0-1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>maxmin <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>){</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.vector</span>(x)<span class="sc">==</span><span class="cn">TRUE</span>){</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    maxs <span class="ot">&lt;-</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    mins <span class="ot">&lt;-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale</span>(x,<span class="at">center=</span>mins,<span class="at">scale=</span>maxs<span class="sc">-</span>mins)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    maxs <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>,max, <span class="at">na.rm=</span> na.rm)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    mins <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="dv">2</span>,min, <span class="at">na.rm =</span> na.rm)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale</span>(x, <span class="at">center =</span> mins, <span class="at">scale =</span> maxs <span class="sc">-</span> mins)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="we-will-scale-trauma-and-childhoodmaltreatment-columns" class="level3">
<h3 class="anchored" data-anchor-id="we-will-scale-trauma-and-childhoodmaltreatment-columns">We will scale trauma and childhoodmaltreatment columns</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>scale_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TraumaNumber"</span>, <span class="st">"ChildhoodMaltreatment"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># current</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>scale_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols){</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the columns with unique values, for e.g in ArmyStarrs cohort </span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># all trauma values are one, so don't scale that </span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># so we need to remove such columns before scaling</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  col_wd_unq_vals <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df[, cols], <span class="cf">function</span>(x) x[<span class="fu">length</span>(<span class="fu">unique</span>(x)) <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  col_wd_unq_vals <span class="ot">&lt;-</span> <span class="fu">Filter</span>(length, col_wd_unq_vals)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  col_wd_unq_vals <span class="ot">&lt;-</span> <span class="fu">names</span>(col_wd_unq_vals)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  cols <span class="ot">&lt;-</span> cols[<span class="sc">!</span>cols <span class="sc">%in%</span> col_wd_unq_vals]</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Scaling columns:"</span>, cols, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>  scale_df <span class="ot">&lt;-</span> df[, <span class="fu">which</span>(<span class="fu">names</span>(df) <span class="sc">%in%</span> (cols)), <span class="cn">TRUE</span>]</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  scale_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">maxmin</span>(<span class="at">x =</span> scale_df, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># code to handle one column</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">ncol</span>(scale_df) <span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(scale_df) <span class="ot">&lt;-</span> cols</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    scale_df <span class="ot">&lt;-</span> scale_df[, <span class="fu">match</span>(<span class="fu">colnames</span>(scale_df), cols)]</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check if cols are in order before renaming</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">all</span>(<span class="fu">colnames</span>(scale_df) <span class="sc">==</span> cols)){</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"columns in order"</span>)</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">colnames</span>(scale_df) <span class="ot">&lt;-</span> cols</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{<span class="fu">stop</span>(<span class="st">"columns are NOT in order"</span>)}</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>  other_df <span class="ot">&lt;-</span> df[, <span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(df) <span class="sc">%in%</span> (cols)), <span class="cn">TRUE</span>]</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(other_df, scale_df)</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>scale_data_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(df,  cols){</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) <span class="fu">scale_data</span>(x, cols))</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">lapply</span>(x, dim))</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">scale_data</span>(df, cols)</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">dim</span>(x))</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a><span class="co"># we dont have to scale here because we don't have exposure variables ---------------</span></span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>adj_sc_df <span class="ot">&lt;-</span> test_sc</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a><span class="co"># # View(adj_sc_df)</span></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>ind_sc_df_test <span class="ot">&lt;-</span> individual_sc_test</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>ind_sc_df <span class="ot">&lt;-</span> individual_sc</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a><span class="co"># # army</span></span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a>army_sc_df <span class="ot">&lt;-</span> army_sc</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a><span class="co"># lifetime</span></span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a>army_life_sc_df <span class="ot">&lt;-</span> army_life_sc</span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a>adj_life_sc_df <span class="ot">&lt;-</span> test_life_sc</span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true" tabindex="-1"></a><span class="co"># # all data</span></span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true" tabindex="-1"></a><span class="co"># # View(cur_sc_df)</span></span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true" tabindex="-1"></a>cur_sc_df <span class="ot">&lt;-</span> current_all_sc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="now-calculate-risk-scores" class="level3">
<h3 class="anchored" data-anchor-id="now-calculate-risk-scores">Now calculate risk scores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load feature importance</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>weights_file_ls <span class="ot">&lt;-</span> file_ls[<span class="fu">grepl</span>(<span class="st">"EN_selected_wd_EN_l1_r_0.1"</span>, file_ls)]</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add feature weights from model without exposure variables</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights_file_ls , <span class="cf">function</span>(x) <span class="fu">read.csv</span>(<span class="fu">paste0</span>(feapath, x)))</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(weights) <span class="ot">&lt;-</span> sheet_names</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(weights,dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 4250    2

$`Without NonCpGXY Probes`
[1] 4150    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save weights in one .xls sheet for sharing to run on independent cohorts</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write.xlsx(weights, "../../../Combined Data/2023-03-08_21-41-11/EN_selected_wd_EN_l1_r_0.1.xlsx",</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co">#            rowNames = FALSE)</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lets get old weights to see how many are matching</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>weights_old_path <span class="ot">&lt;-</span> <span class="st">"G:/PGC ML/Combined Data/2022-03-30_15-07-11/"</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>weights_old <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights_file_ls , <span class="cf">function</span>(x) <span class="fu">read.csv</span>(<span class="fu">paste0</span>(weights_old_path, x)))</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(weights_old) <span class="ot">&lt;-</span> sheet_names</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(weights_old,dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 2780    2

$`Without NonCpGXY Probes`
[1] 3730    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check common</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(weights_old<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Feature <span class="sc">%in%</span> weights<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Feature)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
 1725  2005 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lets get the mean and std deviation of risk scores</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># comn_features &lt;- lapply(weights, function(x){</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   weights[which(weights$`Feature` %in%  weights$`Without NonCpGXY Probes`$Feature), ]</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># })</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply(comn_features, dim)</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>mean_sd <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights, <span class="cf">function</span>(x) <span class="fu">summary</span>(x[, <span class="dv">2</span>]))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>mean_sd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.5884847 -0.0370248  0.0000000  0.0007638  0.0501623  0.7101673 

$`Without NonCpGXY Probes`
      Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-0.6041251 -0.0375794  0.0000000  0.0006889  0.0500066  0.7061281 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to rename some rows </span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>rename_importance_rows <span class="ot">&lt;-</span> <span class="cf">function</span>(weights_df){</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  weights_df<span class="sc">$</span>Feature <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(weights_df<span class="sc">$</span>Feature <span class="sc">==</span> <span class="st">'Traumanum'</span>, <span class="st">'TraumaNumber'</span>,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(weights_df<span class="sc">$</span>Feature <span class="sc">==</span> <span class="st">'Childhood_Mt'</span>,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">'ChildhoodMaltreatment'</span>, weights_df<span class="sc">$</span>Feature))</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  weights_df</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>rename_importance_rows_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(weights_df){</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(weights_df, <span class="st">"list"</span>)){</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights_df, <span class="cf">function</span>(x) <span class="fu">rename_importance_rows</span>(x))</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">lapply</span>(x, dim))</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rename_importance_rows</span>(weights_df)</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">dim</span>(x))</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">rename_importance_rows_helper</span>(<span class="at">weights_df =</span> weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 4250    2

$`Without NonCpGXY Probes`
[1] 4150    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># current - check order, -2 for excluding exposure variables</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Map</span>(<span class="cf">function</span>(x, y) <span class="fu">table</span>(<span class="fu">colnames</span>(x[, <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(x)<span class="sc">-</span><span class="dv">2</span>)]) <span class="sc">==</span> y<span class="sc">$</span>Feature), adj_sc_df, weights)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`

TRUE 
4250 

$`Without NonCpGXY Probes`

TRUE 
4150 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get features with negative and positive coefficients separately</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>neg_weights <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights, <span class="cf">function</span>(x) x[x<span class="sc">$</span>Importance <span class="sc">&lt;</span> <span class="dv">0</span>, ])</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(neg_weights, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 1368    2

$`Without NonCpGXY Probes`
[1] 1334    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>pos_weights <span class="ot">&lt;-</span> <span class="fu">lapply</span>(weights, <span class="cf">function</span>(x) x[x<span class="sc">$</span>Importance <span class="sc">&gt;</span> <span class="dv">0</span>, ])</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(pos_weights, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1] 1539    2

$`Without NonCpGXY Probes`
[1] 1489    2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now get the features from test dataset</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>adj_sc_df_neg <span class="ot">&lt;-</span> <span class="fu">Map</span>((<span class="cf">function</span>(x,y) x[, <span class="fu">colnames</span>(x) <span class="sc">%in%</span> y<span class="sc">$</span>Feature]),</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                     adj_sc_df, neg_weights)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(adj_sc_df_neg, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  307 1368

$`Without NonCpGXY Probes`
[1]  307 1334</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>adj_sc_df_pos <span class="ot">&lt;-</span> <span class="fu">Map</span>((<span class="cf">function</span>(x,y) x[, <span class="fu">colnames</span>(x) <span class="sc">%in%</span> y<span class="sc">$</span>Feature]), </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                     adj_sc_df, pos_weights)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(adj_sc_df_pos, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Without NonCpG Probes`
[1]  307 1539

$`Without NonCpGXY Probes`
[1]  307 1489</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to calculate risk scores. </span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It will check order of columns first and the calculate risk scores</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>calculate_score <span class="ot">&lt;-</span> <span class="cf">function</span>(df, weights, additional_cols_df, </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                            add_col, <span class="at">sheet_names =</span> sheet_names){</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(df), <span class="cf">function</span>(i) {</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># check if weights is a list or not and take appropriate action</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">inherits</span>(weights, <span class="st">"list"</span>)){</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>        weights_df <span class="ot">=</span> weights[[i]]</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{weights_df <span class="ot">=</span> weights}</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>        comn_vars <span class="ot">&lt;-</span> df[[i]][, <span class="fu">which</span>(<span class="fu">colnames</span>(df[[i]]) <span class="sc">%in%</span> weights_df<span class="sc">$</span>Feature)]</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>        ord <span class="ot">&lt;-</span> comn_vars[, <span class="fu">order</span>(<span class="fu">match</span>(<span class="fu">colnames</span>(comn_vars), weights_df<span class="sc">$</span>Feature))]</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># we don't need to run this for df with no exposure variables</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="st">"TraumaNumber"</span> <span class="sc">%in%</span> weights_df<span class="sc">$</span>Feature){</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Ordered: "</span>, <span class="fu">table</span>(<span class="fu">colnames</span>(ord) <span class="sc">==</span> weights_df<span class="sc">$</span>Feature),</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">collapse =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>        s <span class="ot">&lt;-</span> <span class="fu">apply</span>(ord, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">*</span> weights_df<span class="sc">$</span>Importance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>        ord[[<span class="st">'risk_score'</span>]] <span class="ot">&lt;-</span> s</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>      <span class="co"># meth only risk scores</span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>      meth_fea_weights <span class="ot">&lt;-</span> weights_df <span class="sc">%&gt;%</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"^cg|^ch."</span>, Feature))</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>      df_x <span class="ot">&lt;-</span> df[[i]]</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>      meth <span class="ot">&lt;-</span> df_x[, <span class="fu">which</span>(<span class="fu">colnames</span>(df_x) <span class="sc">%in%</span> meth_fea_weights<span class="sc">$</span>Feature)]</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>      ord_meth <span class="ot">&lt;-</span> meth[, <span class="fu">order</span>(<span class="fu">match</span>(<span class="fu">colnames</span>(meth),meth_fea_weights<span class="sc">$</span>Feature))]</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Ordered: "</span>, </span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">table</span>(<span class="fu">colnames</span>(ord_meth) <span class="sc">==</span></span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a>                          meth_fea_weights<span class="sc">$</span>Feature),<span class="at">collapse =</span> <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>))</span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a>      s_meth <span class="ot">&lt;-</span> <span class="fu">apply</span>(ord_meth, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">*</span> meth_fea_weights<span class="sc">$</span>Importance, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>      ord[[<span class="st">'meth_only_risk_score'</span>]] <span class="ot">&lt;-</span> s_meth </span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>       <span class="co"># check if from df is a list</span></span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">inherits</span>(additional_cols_df, <span class="st">"list"</span>)){</span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>        from_df <span class="ot">&lt;-</span> additional_cols_df[[i]] </span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>        from_df <span class="ot">&lt;-</span> additional_cols_df</span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(add_col) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a>        ord[add_col] <span class="ot">&lt;-</span> from_df[add_col]</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a>        ord[[add_col]] <span class="ot">&lt;-</span> from_df[[add_col]]</span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a>      ord</span>
<span id="cb87-59"><a href="#cb87-59" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb87-60"><a href="#cb87-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(x) <span class="ot">&lt;-</span> sheet_names</span>
<span id="cb87-61"><a href="#cb87-61" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb87-62"><a href="#cb87-62" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb87-63"><a href="#cb87-63" aria-hidden="true" tabindex="-1"></a>    from_df <span class="ot">=</span> additional_cols_df</span>
<span id="cb87-64"><a href="#cb87-64" aria-hidden="true" tabindex="-1"></a>    comn_vars <span class="ot">&lt;-</span> df[, <span class="fu">which</span>(<span class="fu">colnames</span>(df) <span class="sc">%in%</span> weights_df<span class="sc">$</span>Feature)]</span>
<span id="cb87-65"><a href="#cb87-65" aria-hidden="true" tabindex="-1"></a>    ord <span class="ot">&lt;-</span> comn_vars[, <span class="fu">order</span>(<span class="fu">match</span>(<span class="fu">colnames</span>(comn_vars),weights<span class="sc">$</span>Feature))]</span>
<span id="cb87-66"><a href="#cb87-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Ordered"</span>, <span class="fu">table</span>(<span class="fu">colnames</span>(ord) <span class="sc">==</span> weights<span class="sc">$</span>Feature)))</span>
<span id="cb87-67"><a href="#cb87-67" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">apply</span>(ord, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">*</span> weights<span class="sc">$</span>Importance))</span>
<span id="cb87-68"><a href="#cb87-68" aria-hidden="true" tabindex="-1"></a>   ord[[<span class="st">'risk_score'</span>]] <span class="ot">&lt;-</span> s</span>
<span id="cb87-69"><a href="#cb87-69" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb87-70"><a href="#cb87-70" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(<span class="fu">length</span>(add_col) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb87-71"><a href="#cb87-71" aria-hidden="true" tabindex="-1"></a>        ord[add_col] <span class="ot">&lt;-</span> from_df[add_col]</span>
<span id="cb87-72"><a href="#cb87-72" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb87-73"><a href="#cb87-73" aria-hidden="true" tabindex="-1"></a>        ord[[add_col]] <span class="ot">&lt;-</span> from_df[[add_col]]</span>
<span id="cb87-74"><a href="#cb87-74" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb87-75"><a href="#cb87-75" aria-hidden="true" tabindex="-1"></a>   ord</span>
<span id="cb87-76"><a href="#cb87-76" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb87-77"><a href="#cb87-77" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-78"><a href="#cb87-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-79"><a href="#cb87-79" aria-hidden="true" tabindex="-1"></a><span class="co"># add childhood trauma and trauma num to get correlation</span></span>
<span id="cb87-80"><a href="#cb87-80" aria-hidden="true" tabindex="-1"></a>add_cur_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TraumaNumber"</span>, <span class="st">"ChildhoodMaltreatment"</span>,</span>
<span id="cb87-81"><a href="#cb87-81" aria-hidden="true" tabindex="-1"></a>                  rm_cur_cols[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb87-82"><a href="#cb87-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-83"><a href="#cb87-83" aria-hidden="true" tabindex="-1"></a>adj_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(adj_sc_df, weights,</span>
<span id="cb87-84"><a href="#cb87-84" aria-hidden="true" tabindex="-1"></a>                             adj_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb87-85"><a href="#cb87-85" aria-hidden="true" tabindex="-1"></a>                             <span class="at">add_col =</span> add_cur_cols,</span>
<span id="cb87-86"><a href="#cb87-86" aria-hidden="true" tabindex="-1"></a>                             sheet_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  4250"
[1] "Ordered:  4150"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>adj_sc_df_neg <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(adj_sc_df_neg, neg_weights,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                             adj_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>                             sheet_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  1368"
[1] "Ordered:  1334"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>adj_sc_df_pos <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(adj_sc_df_pos, pos_weights,</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>                             adj_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                             sheet_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  1539"
[1] "Ordered:  1489"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual cohorts</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>ind_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(ind_sc_df, weights<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>                         individual_cohorts, </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sheet_names =</span> <span class="fu">names</span>(individual_cohorts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  4150"
[1] "Ordered:  4150"
[1] "Ordered:  4150"
[1] "Ordered:  4150"
[1] "Ordered:  4150"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual cohorts in test set only</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>ind_sc_df_test <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(ind_sc_df_test, weights<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>                         individual_cohorts_testset, </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">sheet_names =</span> <span class="fu">names</span>(individual_cohorts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  4150"
[1] "Ordered:  4150"
[1] "Ordered:  4150"
[1] "Ordered:  4150"
[1] "Ordered:  4150"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Army ---------------</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>army_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(army_sc_df, weights,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                         cur_army<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">add_col =</span> add_cur_cols,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>                         sheet_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  4250"
[1] "Ordered:  4150"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lifetime</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="co"># army_life_sc_df = order_data(army_life_sc_df)</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co"># table(colnames(army_life_sc_df) == weights$Feature)</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># army_life_sc_df$risk_score &lt;- calculate_score(army_life_sc_df)</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co"># army_life_sc_df$LifetimePTSD &lt;- army_life_sc_df$LifetimePTSD</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>add_life_cols <span class="ot">&lt;-</span> rm_life_cols</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>adj_life_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(adj_life_sc_df, weights,</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>                         lifetime_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">add_col =</span> add_life_cols, </span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>                         sheet_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  4250"
[1] "Ordered:  4150"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>cur_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_score</span>(cur_sc_df, weights,</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>                         current_all<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">add_col =</span> add_cur_cols, </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>                         sheet_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ordered:  4250"
[1] "Ordered:  4150"</code></pre>
</div>
</div>
</section>
<section id="calculate-mean-methylation-of-samples-for-significant-cpgs" class="level3">
<h3 class="anchored" data-anchor-id="calculate-mean-methylation-of-samples-for-significant-cpgs">calculate mean methylation of samples for significant cpgs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>cpg_p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cg"</span>, <span class="st">"ch."</span>) <span class="co"># pattern</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate mean</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>calculate_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(df, p){</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) {</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>      x <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mean_meth =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(cpg_p))))</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>      })</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mean_meth =</span> <span class="fu">rowMeans</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(cpg_p))))</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>adj_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(adj_df, cpg_p)</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>adj_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(adj_sc_df, cpg_p)</span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>adj_sc_df_neg <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(adj_sc_df_neg, cpg_p)</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>adj_sc_df_pos <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(adj_sc_df_pos, cpg_p)</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>ind_sc_df_test <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(ind_sc_df_test, cpg_p)</span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a>ind_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(ind_sc_df, cpg_p)</span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a>army_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(army_sc_df, cpg_p)</span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a>adj_life_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(adj_life_sc_df, cpg_p)</span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a>cur_sc_df <span class="ot">&lt;-</span> <span class="fu">calculate_mean</span>(cur_sc_df, cpg_p)</span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a><span class="co"># get males from individual cohorts to see if we have negative correlation </span></span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a>ind_sc_df_test_males <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ind_sc_df_test, <span class="cf">function</span>(x) x[x<span class="sc">$</span>Gender<span class="sc">==</span><span class="st">'1'</span>, ])</span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(ind_sc_df_test_males, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1]   39 4159

$DNHS
[1]   42 4159

$GTP
[1]   26 4159

$MRS
[1]   28 4159

$Prismo
[1]    8 4159</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>ind_sc_df_test_females <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ind_sc_df_test[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="cf">function</span>(x) x[x<span class="sc">$</span>Gender<span class="sc">==</span><span class="st">'2'</span>, ])</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(ind_sc_df_test_females, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$DNHS
[1]   71 4159

$GTP
[1]   93 4159</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all test males together</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>test_df_males <span class="ot">&lt;-</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Gender <span class="sc">==</span> <span class="st">'1'</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(test_df_males)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  143 4159</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>test_df_females <span class="ot">&lt;-</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Gender <span class="sc">==</span> <span class="st">'2'</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(test_df_females)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  164 4159</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>test_df_males_females <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Males"</span> <span class="ot">=</span> test_df_males,</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Females"</span> <span class="ot">=</span> test_df_females</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(test_df_males_females, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Males
[1]  143 4159

$Females
[1]  164 4159</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all train test males and females</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>cur_all_males <span class="ot">&lt;-</span> cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">filter</span>(Gender <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>cur_all_females <span class="ot">&lt;-</span> cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">filter</span>(Gender <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>cur_all_males_females <span class="ot">=</span> <span class="fu">list</span>(<span class="st">"Males"</span> <span class="ot">=</span> cur_all_males,</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Females"</span> <span class="ot">=</span> cur_all_females)</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(cur_all_males_females, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Males
[1]  629 4159

$Females
[1]  597 4159</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># all individual cohorts males </span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>stdy <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Study))</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>all_individual_males <span class="ot">&lt;-</span> <span class="fu">lapply</span>(stdy, <span class="cf">function</span>(x) {</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">filter</span>(Gender <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Study <span class="sc">==</span> x)</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(all_individual_males) <span class="ot">&lt;-</span> stdy</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(all_individual_males, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1]  153 4159

$DNHS
[1]  171 4159

$GTP
[1]  132 4159

$MRS
[1]  123 4159

$Prismo
[1]   50 4159</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># all individual cohorts females </span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>all_individual_females <span class="ot">&lt;-</span> <span class="fu">lapply</span>(stdy[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="cf">function</span>(x) {</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">filter</span>(Gender <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> Study <span class="sc">==</span> x )</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(all_individual_females) <span class="ot">&lt;-</span> stdy[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(all_individual_females, dim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$DNHS
[1]  245 4159

$GTP
[1]  352 4159</code></pre>
</div>
</div>
</section>
<section id="correlation-plot" class="level3">
<h3 class="anchored" data-anchor-id="correlation-plot">Correlation plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation columns</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"TraumaNumber"</span>, <span class="st">"ChildhoodMaltreatment"</span>, <span class="st">"risk_score"</span>, </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"meth_only_risk_score"</span>, <span class="st">"CurrentPTSD"</span>, <span class="st">"mean_meth"</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>cols_life <span class="ot">&lt;-</span> <span class="fu">c</span>(cols[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="st">"LifetimePTSD"</span>, cols[<span class="dv">6</span>])</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>new_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cumulative trauma"</span>, <span class="st">"Childhood maltreatment"</span>, </span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Risk score"</span>, <span class="st">"Meth Risk score"</span>,</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Current PTSD"</span>, <span class="st">"Mean methylation"</span>)</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>new_names_life <span class="ot">&lt;-</span> <span class="fu">c</span>(new_names[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="st">"Lifetime PTSD"</span>, new_names[<span class="dv">6</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="function-to-get-correlation-and-adjusted-pvalue.-input-is-data-frame-columns-we-want-to-get-correlation-for-and-new-names-to-assign-for-columns." class="level2">
<h2 class="anchored" data-anchor-id="function-to-get-correlation-and-adjusted-pvalue.-input-is-data-frame-columns-we-want-to-get-correlation-for-and-new-names-to-assign-for-columns.">Function to get correlation and adjusted pvalue. Input is data frame, columns we want to get correlation for and new names to assign for columns.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>get_correlation <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols, new_names){</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># As we have many dfs, lets check which cols are present</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># and use those cols</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  cols_present <span class="ot">&lt;-</span> <span class="fu">which</span>(cols <span class="sc">%in%</span> <span class="fu">colnames</span>(df))</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  cols <span class="ot">&lt;-</span> cols[cols_present]</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  new_names <span class="ot">&lt;-</span> new_names[cols_present]</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get the cols from df and correlation</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(cols)</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(colnames(df))</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>  indx <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df, is.factor)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>  df[indx] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df[indx], <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(x)))</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> new_names</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>  cor_df <span class="ot">&lt;-</span> <span class="fu">cor</span>(df)</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">cor.mtest</span>(df, <span class="at">conf.level =</span> <span class="fl">0.95</span>) <span class="co"># added na.rm </span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># adjusted pvalues</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>  p_adj <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">p.adjust</span>(<span class="fu">as.vector</span>(<span class="fu">as.matrix</span>(p<span class="sc">$</span>p)),</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method=</span><span class="st">'fdr'</span>),</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ncol=</span><span class="fu">ncol</span>(cor_df))</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(p_adj) <span class="ot">&lt;-</span> new_names</span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(p_adj) <span class="ot">&lt;-</span> new_names</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>  df_ls <span class="ot">&lt;-</span> <span class="fu">list</span>(cor_df, p_adj, p<span class="sc">$</span>p)</span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(df_ls) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"cor"</span>, <span class="st">"padj"</span>, <span class="st">"pval"</span>)</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_ls)</span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a>get_correlation_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols, new_names){</span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">inherits</span>(df, <span class="st">"list"</span>)) {</span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>    x_cor <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df, <span class="cf">function</span>(x) <span class="fu">get_correlation</span>(x, cols, new_names))</span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a>    x_cor <span class="ot">&lt;-</span> <span class="fu">get_correlation</span>(df, cols, new_names)</span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a>  x_cor</span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a><span class="co"># color palette</span></span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a>colrs <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">'#7F0000'</span>,</span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'#FF7F00'</span>, <span class="st">'orange'</span>,</span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'cyan'</span>, <span class="st">'#007FFF'</span>, <span class="st">'blue'</span>, <span class="st">'#00007F'</span>,</span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"#BC3C29FF"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="now-call-the-function-to-get-correlation-for-data" class="level2">
<h2 class="anchored" data-anchor-id="now-call-the-function-to-get-correlation-for-data">Now call the function to get correlation for data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariate adjusted data</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>dfs <span class="ot">&lt;-</span> <span class="fu">list</span>(adj_sc_df, </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>            ind_sc_df_test, </span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>            ind_sc_df,</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>            army_sc_df, </span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>            cur_sc_df,</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>            ind_sc_df_test_males,</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>            ind_sc_df_test_females,</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>            test_df_males_females,</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>            all_individual_males,</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>            all_individual_females,</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>            cur_all_males_females,</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>            adj_life_sc_df)</span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>dfs_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Test set Current PTSD'</span>, </span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Individual Cohorts Test'</span>,</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Individual Cohorts'</span>,</span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Army cohorts'</span>, </span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>               <span class="st">"All cohorts"</span>,</span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Individual males Test"</span>,</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Individual females Test"</span>,</span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a>               <span class="st">"All test"</span>, </span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>               <span class="st">"All individual males"</span>,</span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a>               <span class="st">"All individual females"</span>,</span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a>               <span class="st">"All"</span>,</span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>               <span class="st">'Test set Lifetime PTSD'</span>)</span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a>cor_dfs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(dfs), <span class="cf">function</span>(i){</span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)){</span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Processing ..."</span>, i)</span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_correlation_helper</span>(<span class="at">df =</span> dfs[[i]], <span class="at">cols =</span> cols,</span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a>                           <span class="at">new_names =</span> new_names)</span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">get_correlation_helper</span>(<span class="at">df =</span> dfs[[i]], <span class="at">cols =</span> cols_life,                 </span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a>                           <span class="at">new_names =</span> new_names_life)</span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(cols)

  # Now:
  data %&gt;% select(all_of(cols))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(df): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(x, y): the standard deviation is zero

Warning in cor(x, y): the standard deviation is zero

Warning in cor(x, y): the standard deviation is zero

Warning in cor(x, y): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."
[1] "Processing ..."
[1] "Processing ..."</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."
[1] "Processing ..."
[1] "Processing ..."</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero

Warning in cor(df): the standard deviation is zero</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processing ..."
[1] "Processing ..."</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cor_dfs) <span class="ot">&lt;-</span> dfs_names</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(cor_dfs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Test set Current PTSD"   "Individual Cohorts Test"
 [3] "Individual Cohorts"      "Army cohorts"           
 [5] "All cohorts"             "Individual males Test"  
 [7] "Individual females Test" "All test"               
 [9] "All individual males"    "All individual females" 
[11] "All"                     "Test set Lifetime PTSD" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save correlation information</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>df_n <span class="ot">&lt;-</span> <span class="st">"Test set Current PTSD"</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>list_of_datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"nonCpG Cor"</span> <span class="ot">=</span> cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>cor,</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"nonCpG Padj"</span> <span class="ot">=</span> cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>padj,</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"nonCpGXY Cor"</span> <span class="ot">=</span> cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>cor,</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"nonCpGXY Padj"</span> <span class="ot">=</span> cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>padj)</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(list_of_datasets, <span class="at">file =</span> <span class="st">"../data/Adj_wd_Exp_Vars_Correlation_EN_lr_0.1.xlsx"</span>, <span class="at">rowNames =</span> T)</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Independent Cohorts</span><span class="st">`</span>, <span class="at">file =</span> <span class="st">"../data/Adj_wd_Exp_Vars_Correlation_EN_lr_0.1_independent_cohorts.xlsx"</span>, <span class="at">rowNames =</span> T)</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="co"># cor_army_life_df &lt;- get_correlation(df = army_life_sc_df, cols = cols_life,</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 new_names = new_names_life)</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get correlation between different variables</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>correlation_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(cor_df, pval_name, title){</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">=</span> cor_df[[pval_name]]</span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">corrplot</span>(cor_df<span class="sc">$</span>cor,</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.mat =</span> pval,</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">method =</span> <span class="st">"pie"</span>,</span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span>,  <span class="at">number.cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">tl.cex =</span> <span class="fl">1.2</span>, <span class="at">cl.cex =</span> <span class="fl">1.2</span>,</span>
<span id="cb136-25"><a href="#cb136-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">sig.level =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>),</span>
<span id="cb136-26"><a href="#cb136-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch.cex =</span> <span class="fl">1.4</span>,<span class="at">insig =</span> <span class="st">'label_sig'</span>,</span>
<span id="cb136-27"><a href="#cb136-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">cl.ratio =</span> <span class="fl">0.4</span>,</span>
<span id="cb136-28"><a href="#cb136-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>),</span>
<span id="cb136-29"><a href="#cb136-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">colrs</span>(<span class="dv">10</span>),</span>
<span id="cb136-30"><a href="#cb136-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> title)</span>
<span id="cb136-31"><a href="#cb136-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recordPlot</span>()</span>
<span id="cb136-32"><a href="#cb136-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-33"><a href="#cb136-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-34"><a href="#cb136-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-35"><a href="#cb136-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get correlation between variable. </span></span>
<span id="cb136-36"><a href="#cb136-36" aria-hidden="true" tabindex="-1"></a><span class="co"># It will run the above correlation function for all the data </span></span>
<span id="cb136-37"><a href="#cb136-37" aria-hidden="true" tabindex="-1"></a>correlation_plot_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(cor_df, pval_name, title){</span>
<span id="cb136-38"><a href="#cb136-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(cor_df, <span class="st">"list"</span>)){</span>
<span id="cb136-39"><a href="#cb136-39" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">names</span>(cor_dfs)</span>
<span id="cb136-40"><a href="#cb136-40" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(cor_df), <span class="cf">function</span>(i) {</span>
<span id="cb136-41"><a href="#cb136-41" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">inherits</span>(cor_df[[i]], <span class="st">"list"</span>)){</span>
<span id="cb136-42"><a href="#cb136-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(cor_df[[i]])</span></span>
<span id="cb136-43"><a href="#cb136-43" aria-hidden="true" tabindex="-1"></a>        n1 <span class="ot">&lt;-</span> <span class="fu">names</span>(cor_df[[i]])</span>
<span id="cb136-44"><a href="#cb136-44" aria-hidden="true" tabindex="-1"></a>        p1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(cor_df[[i]]), <span class="cf">function</span>(j){</span>
<span id="cb136-45"><a href="#cb136-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">correlation_plot</span>(cor_df[[i]][[j]], pval_name,</span>
<span id="cb136-46"><a href="#cb136-46" aria-hidden="true" tabindex="-1"></a>                           <span class="at">title =</span> <span class="fu">paste0</span>(n[i], <span class="st">":</span><span class="sc">\n</span><span class="st">"</span>,n1[j]))</span>
<span id="cb136-47"><a href="#cb136-47" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb136-48"><a href="#cb136-48" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb136-49"><a href="#cb136-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">names</span>(p1) <span class="ot">&lt;-</span> n1</span>
<span id="cb136-50"><a href="#cb136-50" aria-hidden="true" tabindex="-1"></a>        p1</span>
<span id="cb136-51"><a href="#cb136-51" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb136-52"><a href="#cb136-52" aria-hidden="true" tabindex="-1"></a>        p <span class="ot">&lt;-</span> <span class="fu">correlation_plot</span>(cor_df[[i]], pval_name, <span class="at">title =</span> n[i])</span>
<span id="cb136-53"><a href="#cb136-53" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb136-54"><a href="#cb136-54" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb136-55"><a href="#cb136-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(p) <span class="ot">&lt;-</span> n</span>
<span id="cb136-56"><a href="#cb136-56" aria-hidden="true" tabindex="-1"></a>    p</span>
<span id="cb136-57"><a href="#cb136-57" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb136-58"><a href="#cb136-58" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">correlation_plot</span>(x, pval_name, <span class="at">title =</span> title)</span>
<span id="cb136-59"><a href="#cb136-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb136-60"><a href="#cb136-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-61"><a href="#cb136-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-62"><a href="#cb136-62" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation is FDR corrected with "padj"</span></span>
<span id="cb136-63"><a href="#cb136-63" aria-hidden="true" tabindex="-1"></a>p_adj <span class="ot">&lt;-</span> <span class="fu">correlation_plot_helper</span>(cor_dfs, <span class="st">"padj"</span>, <span class="at">title =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-6.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-7.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-8.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-9.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-10.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-11.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-12.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-13.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-14.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-15.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-16.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-17.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-18.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-19.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-20.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-21.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-22.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-23.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-24.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-25.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-26.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-27.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-28.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-29.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-30.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-31.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-32.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-33.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-34.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-35.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-12-36.png" class="img-fluid" width="576"></p>
</div>
</div>
<section id="plot-correlation-with-nominally-pvalue" class="level3">
<h3 class="anchored" data-anchor-id="plot-correlation-with-nominally-pvalue">Plot correlation with nominally pvalue</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>cor_p_nominal <span class="ot">&lt;-</span> <span class="fu">correlation_plot_helper</span>(cor_dfs, <span class="st">"pval"</span>, <span class="at">title =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-6.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-7.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-8.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-9.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-10.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-11.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-12.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-13.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-14.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-15.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-16.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-17.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-18.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-19.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-20.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-21.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-22.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-23.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-24.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-25.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-26.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-27.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-28.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-29.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-30.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-31.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-32.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-33.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-34.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-35.png" class="img-fluid" width="576"></p>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-13-36.png" class="img-fluid" width="576"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="cn">NULL</span>, </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>          p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">''</span>, <span class="st">'B'</span>), <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Army cohorts</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="cn">NULL</span>, </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>          p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Army cohorts</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">''</span>, <span class="st">'B'</span>), <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Test set Lifetime PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, <span class="cn">NULL</span>, </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>          p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Test set Lifetime PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'A'</span>, <span class="st">''</span>, <span class="st">'B'</span>), <span class="at">align =</span> <span class="st">"hv"</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section>
<section id="plot-individual-cohorts-in-one-plot" class="level3">
<h3 class="anchored" data-anchor-id="plot-individual-cohorts-in-one-plot">Plot Individual Cohorts in one plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(<span class="at">plotlist =</span> p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Individual Cohorts</span><span class="st">`</span>[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Individual Cohorts</span><span class="st">`</span><span class="sc">$</span>Armystarrs, <span class="cn">NULL</span>,</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>          p_adj<span class="sc">$</span><span class="st">`</span><span class="at">Individual Cohorts</span><span class="st">`</span><span class="sc">$</span>DNHS, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="plot-for-istss" class="level3">
<h3 class="anchored" data-anchor-id="plot-for-istss">Plot for ISTSS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation_plot</span>(cor_dfs<span class="sc">$</span><span class="st">`</span><span class="at">Test set Current PTSD</span><span class="st">`</span><span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">'padj'</span>,</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">title =</span> <span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="theme-and-linear-model-plot-function" class="level3">
<h3 class="anchored" data-anchor-id="theme-and-linear-model-plot-function">Theme and linear model plot function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># theme setting</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span>   <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span><span class="dv">18</span>),</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title =</span> <span class="fu">element_text</span>( <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="co"># function to plot with lm line</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>lm_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y, xlab, ylab, title, <span class="at">group=</span><span class="st">'ptsdpm'</span>,</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">'full'</span>, <span class="at">legend=</span><span class="st">''</span>, <span class="at">fig_legend =</span> <span class="cn">TRUE</span>){</span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (model <span class="sc">==</span> <span class="st">'full'</span>){</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df,<span class="fu">aes_string</span>(x, y)) <span class="sc">+</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>( <span class="at">color=</span><span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>,</span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color=</span><span class="st">"darkred"</span>, <span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.5</span>)</span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df,<span class="fu">aes_string</span>(x, y, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>( <span class="at">size =</span> <span class="dv">3</span>) </span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(fig_legend){</span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">"================="</span>)</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_color_manual</span>(legend,</span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"#0072B5FF"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#BC3C29FF"</span>))<span class="sc">+</span></span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> group, <span class="at">color=</span>group),</span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method=</span><span class="st">'lm'</span>, <span class="at">linetype=</span><span class="st">"solid"</span>,</span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">1.5</span>) <span class="co">#color="blue", fill="blue",</span></span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_color_manual</span>(legend,</span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"#0072B5FF"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"#BC3C29FF"</span>))<span class="sc">+</span></span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)<span class="sc">+</span></span>
<span id="cb144-32"><a href="#cb144-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">group =</span> group, <span class="at">color=</span>group),</span>
<span id="cb144-33"><a href="#cb144-33" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method=</span><span class="st">'lm'</span>, <span class="at">linetype=</span><span class="st">"solid"</span>,</span>
<span id="cb144-34"><a href="#cb144-34" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">1.5</span>) <span class="co">#color="blue", fill="blue",</span></span>
<span id="cb144-35"><a href="#cb144-35" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb144-36"><a href="#cb144-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-37"><a href="#cb144-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-38"><a href="#cb144-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-39"><a href="#cb144-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb144-40"><a href="#cb144-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-41"><a href="#cb144-41" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(title)<span class="sc">+</span></span>
<span id="cb144-42"><a href="#cb144-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb144-43"><a href="#cb144-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab) <span class="sc">+</span></span>
<span id="cb144-44"><a href="#cb144-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb144-45"><a href="#cb144-45" aria-hidden="true" tabindex="-1"></a>    th</span>
<span id="cb144-46"><a href="#cb144-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-47"><a href="#cb144-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span>fig_legend){</span>
<span id="cb144-48"><a href="#cb144-48" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb144-49"><a href="#cb144-49" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> p</span>
<span id="cb144-50"><a href="#cb144-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#linear model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sink</span>(<span class="st">"G:/PGC ML/Combined Data/2023-03-08_21-41-11//Adj_wd_Exp_Vars Linear model PTSD summary_coeff_as_weights_selected_wd_EN_lr_0.1.txt"</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>lm_helper <span class="ot">&lt;-</span> <span class="cf">function</span>(df, f){</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"====================================================="</span>)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  analy <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(</span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"Data frame"</span>, <span class="fu">deparse</span>(<span class="fu">substitute</span>(df))), <span class="at">collapse =</span> <span class="st">':'</span>),</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"Formula"</span>, f), <span class="at">collapse =</span> <span class="st">':'</span>)), <span class="at">collapse =</span> <span class="st">', '</span>)</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(analy)</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">inherits</span>(df, <span class="st">"list"</span>)){</span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">names</span>(df)</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>    lmr <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(df), <span class="cf">function</span>(i){</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">lm</span>(f, <span class="at">data =</span> df[[i]])</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(n[i])</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">summary</span>(x))</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>      x</span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>    }) </span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>    lmr <span class="ot">&lt;-</span> <span class="fu">lm</span>(f, <span class="at">data =</span> df)</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>     <span class="fu">print</span>(<span class="fu">summary</span>(lmr))</span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>    lmr</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a><span class="co"># PTSD formula</span></span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a>f_cur_ptsd_meth <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'meth_only_risk_score~'</span>, <span class="st">'CurrentPTSD'</span>))</span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a><span class="co"># PTSS formula</span></span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a>f_ptss_meth <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'meth_only_risk_score~'</span>, <span class="st">'Pts_Severity'</span>))</span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-32"><a href="#cb145-32" aria-hidden="true" tabindex="-1"></a><span class="co"># current PTSD</span></span>
<span id="cb145-33"><a href="#cb145-33" aria-hidden="true" tabindex="-1"></a>lmr_scaled_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>( <span class="at">df =</span> adj_sc_df, <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df, Formula:meth_only_risk_score ~ CurrentPTSD"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-5.3475 -0.6286  0.1316  0.8053  2.4274 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.26605    0.07461   16.97   &lt;2e-16 ***
CurrentPTSD1  1.45905    0.14709    9.92   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.127 on 305 degrees of freedom
Multiple R-squared:  0.2439,    Adjusted R-squared:  0.2414 
F-statistic:  98.4 on 1 and 305 DF,  p-value: &lt; 2.2e-16

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-5.2087 -0.6634  0.1057  0.7903  2.4387 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.07814    0.07479  14.416   &lt;2e-16 ***
CurrentPTSD1  1.45672    0.14743   9.881   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.129 on 305 degrees of freedom
Multiple R-squared:  0.2425,    Adjusted R-squared:   0.24 
F-statistic: 97.63 on 1 and 305 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>lmr_indep_meth <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df=</span> ind_sc_df, <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:ind_sc_df, Formula:meth_only_risk_score ~ CurrentPTSD"
[1] "Armystarrs"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.42589 -0.41187  0.02037  0.42887  1.65118 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.72299    0.06714   10.77   &lt;2e-16 ***
CurrentPTSD1  2.64184    0.12815   20.61   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7074 on 151 degrees of freedom
Multiple R-squared:  0.7378,    Adjusted R-squared:  0.7361 
F-statistic:   425 on 1 and 151 DF,  p-value: &lt; 2.2e-16

[1] "DNHS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.42499 -0.42915 -0.00134  0.43405  1.88374 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.12178    0.03491   32.13   &lt;2e-16 ***
CurrentPTSD1  2.83308    0.12788   22.15   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.685 on 414 degrees of freedom
Multiple R-squared:  0.5424,    Adjusted R-squared:  0.5413 
F-statistic: 490.8 on 1 and 414 DF,  p-value: &lt; 2.2e-16

[1] "GTP"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-4.7391 -0.4185  0.1081  0.5868  3.3809 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.60857    0.05385   11.30   &lt;2e-16 ***
CurrentPTSD1  2.84298    0.09337   30.45   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9678 on 482 degrees of freedom
Multiple R-squared:  0.658, Adjusted R-squared:  0.6572 
F-statistic: 927.2 on 1 and 482 DF,  p-value: &lt; 2.2e-16

[1] "MRS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-3.2378 -0.4516  0.0996  0.6325  2.7881 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -0.1102     0.1289  -0.855    0.394    
CurrentPTSD1   3.1140     0.1800  17.296   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9981 on 121 degrees of freedom
Multiple R-squared:  0.712, Adjusted R-squared:  0.7096 
F-statistic: 299.2 on 1 and 121 DF,  p-value: &lt; 2.2e-16

[1] "Prismo"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.39063 -0.15448  0.07003  0.47997  1.01733 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    0.7283     0.1250   5.824 4.65e-07 ***
CurrentPTSD1   2.1437     0.2144   9.997 2.56e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7183 on 48 degrees of freedom
Multiple R-squared:  0.6755,    Adjusted R-squared:  0.6688 
F-statistic: 99.94 on 1 and 48 DF,  p-value: 2.56e-13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>lmr_indep_meth_test <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df=</span> ind_sc_df_test, <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:ind_sc_df_test, Formula:meth_only_risk_score ~ CurrentPTSD"
[1] "Armystarrs"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-1.62476 -0.44734 -0.02849  0.42051  1.35230 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    1.0219     0.1394   7.330 1.04e-08 ***
CurrentPTSD1   2.0806     0.2513   8.278 6.06e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7244 on 37 degrees of freedom
Multiple R-squared:  0.6494,    Adjusted R-squared:  0.6399 
F-statistic: 68.53 on 1 and 37 DF,  p-value: 6.058e-10

[1] "DNHS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-2.0664 -0.5065  0.1004  0.5411  1.4977 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.50780    0.07749   19.46  &lt; 2e-16 ***
CurrentPTSD1  2.15520    0.29124    7.40 2.79e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7941 on 111 degrees of freedom
Multiple R-squared:  0.3304,    Adjusted R-squared:  0.3243 
F-statistic: 54.76 on 1 and 111 DF,  p-value: 2.789e-11

[1] "GTP"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-4.9086 -0.5528  0.1847  0.7927  2.5122 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    0.7780     0.1451   5.361 4.21e-07 ***
CurrentPTSD1   1.6906     0.2443   6.921 2.56e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.273 on 117 degrees of freedom
Multiple R-squared:  0.2905,    Adjusted R-squared:  0.2844 
F-statistic:  47.9 on 1 and 117 DF,  p-value: 2.56e-10

[1] "MRS"

Call:
lm(formula = f, data = df[[i]])

Residuals:
     Min       1Q   Median       3Q      Max 
-2.01403 -0.65735  0.06922  0.77169  2.00154 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.01384    0.29026  -0.048 0.962341    
CurrentPTSD1  1.79395    0.41049   4.370 0.000177 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.086 on 26 degrees of freedom
Multiple R-squared:  0.4235,    Adjusted R-squared:  0.4013 
F-statistic:  19.1 on 1 and 26 DF,  p-value: 0.0001771

[1] "Prismo"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-1.7006 -0.5061  0.0847  0.6712  1.2819 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   0.03823    0.46080   0.083   0.9366  
CurrentPTSD1  1.66745    0.75249   2.216   0.0686 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.03 on 6 degrees of freedom
Multiple R-squared:  0.4501,    Adjusted R-squared:  0.3584 
F-statistic:  4.91 on 1 and 6 DF,  p-value: 0.06858</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>lmr_meth <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>( <span class="at">df =</span> adj_sc_df, <span class="at">f =</span> f_cur_ptsd_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df, Formula:meth_only_risk_score ~ CurrentPTSD"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-5.3475 -0.6286  0.1316  0.8053  2.4274 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.26605    0.07461   16.97   &lt;2e-16 ***
CurrentPTSD1  1.45905    0.14709    9.92   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.127 on 305 degrees of freedom
Multiple R-squared:  0.2439,    Adjusted R-squared:  0.2414 
F-statistic:  98.4 on 1 and 305 DF,  p-value: &lt; 2.2e-16

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-5.2087 -0.6634  0.1057  0.7903  2.4387 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.07814    0.07479  14.416   &lt;2e-16 ***
CurrentPTSD1  1.45672    0.14743   9.881   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.129 on 305 degrees of freedom
Multiple R-squared:  0.2425,    Adjusted R-squared:   0.24 
F-statistic: 97.63 on 1 and 305 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>lmr_scaled_ptss_wo_exp_in_model <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>( <span class="at">df =</span> adj_sc_df, <span class="at">f =</span> f_ptss_meth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df, Formula:meth_only_risk_score ~ Pts_Severity"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-5.4261 -0.7275  0.0157  0.8118  3.3860 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.975551   0.166152   5.871 1.46e-08 ***
Pts_Severity 0.017576   0.003869   4.542 8.90e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.251 on 235 degrees of freedom
  (70 observations deleted due to missingness)
Multiple R-squared:  0.08071,   Adjusted R-squared:  0.0768 
F-statistic: 20.63 on 1 and 235 DF,  p-value: 8.901e-06

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
    Min      1Q  Median      3Q     Max 
-5.2900 -0.6892  0.0150  0.8581  3.3899 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.788366   0.165852   4.753 3.49e-06 ***
Pts_Severity 0.017673   0.003863   4.576 7.69e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.249 on 235 degrees of freedom
  (70 observations deleted due to missingness)
Multiple R-squared:  0.0818,    Adjusted R-squared:  0.0779 
F-statistic: 20.94 on 1 and 235 DF,  p-value: 7.691e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># association between mean methylation in datasets with </span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="co"># positive and negative coefficients</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>f_pos <span class="ot">=</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'mean_meth~'</span>, <span class="st">'CurrentPTSD'</span>))</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>lmr_pos <span class="ot">=</span> <span class="fu">lm_helper</span>(adj_sc_df_pos, f_pos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df_pos, Formula:mean_meth ~ CurrentPTSD"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0273810 -0.0050519 -0.0004105  0.0051345  0.0237888 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.498818   0.000576 866.012  &lt; 2e-16 ***
CurrentPTSD1 0.005899   0.001136   5.196 3.74e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.008697 on 305 degrees of freedom
Multiple R-squared:  0.08131,   Adjusted R-squared:  0.0783 
F-statistic: 26.99 on 1 and 305 DF,  p-value: 3.742e-07

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0273912 -0.0049083 -0.0002748  0.0052570  0.0236605 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.4988540  0.0005736  869.68  &lt; 2e-16 ***
CurrentPTSD1 0.0058115  0.0011308    5.14 4.93e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.008661 on 305 degrees of freedom
Multiple R-squared:  0.0797,    Adjusted R-squared:  0.07669 
F-statistic: 26.41 on 1 and 305 DF,  p-value: 4.928e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>lmr_neg <span class="ot">=</span> <span class="fu">lm_helper</span>(adj_sc_df_neg, f_pos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df_neg, Formula:mean_meth ~ CurrentPTSD"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0215003 -0.0050987  0.0000651  0.0049069  0.0255699 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.5000685  0.0005175 966.302   &lt;2e-16 ***
CurrentPTSD1 0.0005533  0.0010202   0.542    0.588    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007814 on 305 degrees of freedom
Multiple R-squared:  0.0009635, Adjusted R-squared:  -0.002312 
F-statistic: 0.2942 on 1 and 305 DF,  p-value: 0.588

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0213154 -0.0050703  0.0000329  0.0046270  0.0256661 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.5000551  0.0005185 964.469   &lt;2e-16 ***
CurrentPTSD1 0.0005814  0.0010221   0.569     0.57    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007829 on 305 degrees of freedom
Multiple R-squared:  0.00106,   Adjusted R-squared:  -0.002215 
F-statistic: 0.3236 on 1 and 305 DF,  p-value: 0.5699</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># risk scores vs mean methylation</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>f_rc <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">'mean_meth~'</span>, <span class="st">'meth_only_risk_score'</span>))</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>lmr_meth_sc <span class="ot">&lt;-</span> <span class="fu">lm_helper</span>(<span class="at">df =</span> adj_sc_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">f =</span>f_rc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "====================================================="
[1] "Data frame:adj_sc_df[1:2], Formula:mean_meth ~ meth_only_risk_score"
[1] "Without NonCpG Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0236258 -0.0048779 -0.0001145  0.0047583  0.0258983 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          0.4967171  0.0007258 684.363  &lt; 2e-16 ***
meth_only_risk_score 0.0021250  0.0003475   6.115 2.95e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007863 on 305 degrees of freedom
Multiple R-squared:  0.1092,    Adjusted R-squared:  0.1063 
F-statistic:  37.4 on 1 and 305 DF,  p-value: 2.949e-09

[1] "Without NonCpGXY Probes"

Call:
lm(formula = f, data = df[[i]])

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0240352 -0.0047661 -0.0003072  0.0048084  0.0259764 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          0.4972179  0.0006775 733.878   &lt;2e-16 ***
meth_only_risk_score 0.0020527  0.0003483   5.893    1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007892 on 305 degrees of freedom
Multiple R-squared:  0.1022,    Adjusted R-squared:  0.09929 
F-statistic: 34.73 on 1 and 305 DF,  p-value: 1.001e-08</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sink()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="lm-for-mean-methylation-and-risk-scores" class="level1">
<h1>lm for mean methylation and risk scores</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>p_meth_adj_sep <span class="ot">&lt;-</span> <span class="fu">lm_plot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'mean_meth'</span>,</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">"Risk score (methylation)"</span>,</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab  =</span> <span class="st">"Mean methylation"</span>,</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">model =</span> <span class="st">'seperate'</span>,</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend =</span> <span class="st">''</span>,</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Test set adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpG Probes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation ideoms with `aes()`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>p_meth_adj_sep1 <span class="ot">&lt;-</span> <span class="fu">lm_plot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> <span class="st">'mean_meth'</span>,</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">xlab  =</span> <span class="st">"Risk score (methylation)"</span>,</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">model =</span> <span class="st">'seperate'</span>,</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">group =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">legend =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">title =</span> <span class="st">"Test set adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpGXY Probes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "================="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_adj_sep</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>p_meth_adj_ptss <span class="ot">&lt;-</span> <span class="fu">lm_plot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">"Risk score (methylation)"</span>,</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab  =</span> <span class="st">"PTSS"</span>,</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">model =</span> <span class="st">'seperate'</span>,</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend =</span> <span class="st">''</span>,</span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Test set adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpG Probes"</span>)</span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>p_meth_adj_ptss1 <span class="ot">&lt;-</span> <span class="fu">lm_plot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab  =</span> <span class="st">"Risk score (methylation)"</span>,</span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">model =</span> <span class="st">'seperate'</span>,</span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">legend =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Test set adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpGXY Probes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "================="</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_meth_adj_sep, p_meth_adj_sep1, </span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>),</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="st">'AUTO'</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p_meth_adj_ptss, p_meth_adj_ptss1,</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>),</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="st">'AUTO'</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>          )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 70 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 70 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 70 rows containing non-finite values (`stat_smooth()`).
Removed 70 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="1152"></p>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p_meth_sep, p_meth_adj_sep, </span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           p_meth_sep_l, p_meth_adj_sep_l, labels = 'AUTO'</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="co">#           )</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------lm for negative and positive coeff</span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_adj_neg &lt;- lm_plot(df = adj_sc_df_neg$`Without NonCpG Probes`, x = 'risk_score',</span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                           y = 'mean_meth',</span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                           xlab = "Risk score",</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab  = "Mean methylation",</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                           model = 'seperate',</span></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                           group = "CurrentPTSD",</span></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                           fig_legend = FALSE,</span></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                           legend = '',</span></span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                           title = "Test set adjusted and scaled: \n Without NonCpG Probes")</span></span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_adj_neg1 &lt;- lm_plot(df = adj_sc_df_neg$`Without NonCpGXY Probes`, x = 'risk_score',</span></span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                           y = 'mean_meth',</span></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                           xlab  = "Risk score",</span></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "",</span></span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a><span class="co">#                           model = 'seperate',</span></span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                           group = "CurrentPTSD",</span></span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                           fig_legend = TRUE,</span></span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                           legend = 'Current PTSD',</span></span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                           title = "Test set adjusted and scaled: \n Without NonCpGXY Probes")</span></span>
<span id="cb177-28"><a href="#cb177-28" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb177-29"><a href="#cb177-29" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p_meth_adj_neg, p_meth_adj_neg1,</span></span>
<span id="cb177-30"><a href="#cb177-30" aria-hidden="true" tabindex="-1"></a><span class="co">#            labels = 'AUTO'</span></span>
<span id="cb177-31"><a href="#cb177-31" aria-hidden="true" tabindex="-1"></a><span class="co">#           )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="plot-for-sobp-poster" class="level3">
<h3 class="anchored" data-anchor-id="plot-for-sobp-poster">Plot for SOBP poster</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_adj_sep &lt;- lm_plot(df = adj_sc_df, x = 'risk_score',</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                           y = 'mean_meth',</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                           xlab = "Risk score",</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                           ylab = "Mean methylation",</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                           model = 'seperate',</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                           group = "CurrentPTSD",</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                           legend = 'Current PTSD',</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                           title = "")</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="co"># p_meth_adj_sep</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="density-plot-function" class="level3">
<h3 class="anchored" data-anchor-id="density-plot-function">Density plot function</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>make_densityplot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y, xlab, ylab, <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">''</span>, <span class="at">legend =</span> <span class="st">''</span>, <span class="at">facet =</span> <span class="cn">FALSE</span>){</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.numeric</span>(df[[x]])){</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">seq</span>(<span class="fu">min</span>(df[, x], <span class="at">na.rm =</span> T), <span class="fu">max</span>(df[, x], <span class="at">na.rm =</span> T), <span class="dv">1</span>))</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes_string</span>(<span class="at">x=</span>x, <span class="at">group=</span>y, <span class="at">fill=</span>y)) <span class="sc">+</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="fl">1.5</span>, <span class="at">alpha=</span>.<span class="dv">8</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> b)</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>df, <span class="fu">aes_string</span>(<span class="at">x=</span>x, <span class="at">group=</span>y, <span class="at">fill=</span>y)) <span class="sc">+</span></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">adjust=</span><span class="fl">1.5</span>, <span class="at">alpha=</span>.<span class="dv">8</span>)</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#theme_classic()</span></span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(facet <span class="sc">!=</span> <span class="cn">FALSE</span>){</span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">'Adding facet'</span>)</span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"~"</span>, facet)))<span class="sc">+</span></span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>))</span>
<span id="cb179-20"><a href="#cb179-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb179-21"><a href="#cb179-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-22"><a href="#cb179-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb179-23"><a href="#cb179-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fig_legend){</span>
<span id="cb179-24"><a href="#cb179-24" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(legend,</span>
<span id="cb179-25"><a href="#cb179-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values  =</span> <span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">"#BC3C29FF"</span>))</span>
<span id="cb179-26"><a href="#cb179-26" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb179-27"><a href="#cb179-27" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">scale_fill_manual</span>(legend,</span>
<span id="cb179-28"><a href="#cb179-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">values  =</span> <span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">"#BC3C29FF"</span>)) <span class="sc">+</span></span>
<span id="cb179-29"><a href="#cb179-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">'none'</span>)</span>
<span id="cb179-30"><a href="#cb179-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb179-31"><a href="#cb179-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-32"><a href="#cb179-32" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ggtitle</span>(title) <span class="sc">+</span></span>
<span id="cb179-33"><a href="#cb179-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb179-34"><a href="#cb179-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab)<span class="sc">+</span> th</span>
<span id="cb179-35"><a href="#cb179-35" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for risk scores</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>p1_sc_d <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># legend = "Current PTSD",</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">"Test set covariate adjusted :</span><span class="sc">\n</span><span class="st">Without NonCpG Probes"</span>)</span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_sc_d</span></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a>p1_sc_d1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">legend =</span> <span class="st">"Current PTSD"</span>,</span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">"Test set covariate adjusted :</span><span class="sc">\n</span><span class="st">Without NonCpGXY Probes"</span>)</span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a>p1_army_sc_d <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> army_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb180-26"><a href="#cb180-26" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb180-27"><a href="#cb180-27" aria-hidden="true" tabindex="-1"></a>                                 <span class="co"># legend = "Current PTSD",</span></span>
<span id="cb180-28"><a href="#cb180-28" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"Covariate adjusted: </span><span class="sc">\n</span><span class="st"> Without NonCpG Probes </span><span class="sc">\n</span><span class="st"> (3 Army cohorts) "</span>)</span>
<span id="cb180-29"><a href="#cb180-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-30"><a href="#cb180-30" aria-hidden="true" tabindex="-1"></a>p1_army_sc_d1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> army_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb180-31"><a href="#cb180-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb180-32"><a href="#cb180-32" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb180-33"><a href="#cb180-33" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb180-34"><a href="#cb180-34" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb180-35"><a href="#cb180-35" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">legend =</span> <span class="st">"Current PTSD"</span>,</span>
<span id="cb180-36"><a href="#cb180-36" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="st">"Covariate adjusted: </span><span class="sc">\n</span><span class="st"> Without NonCpGXY Probes </span><span class="sc">\n</span><span class="st"> (3 Army cohorts) "</span>)</span>
<span id="cb180-37"><a href="#cb180-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-38"><a href="#cb180-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-39"><a href="#cb180-39" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1_sc_d, p1_sc_d1, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.3</span>, <span class="dv">2</span>),</span>
<span id="cb180-40"><a href="#cb180-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="st">'AUTO'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="1248"></p>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(p1_army_sc_d, p1_army_sc_d1, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="dv">2</span>),</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="st">'AUTO'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="1248"></p>
</div>
</div>
</section>
<section id="density-plots-for-individual-cohorts" class="level3">
<h3 class="anchored" data-anchor-id="density-plots-for-individual-cohorts">Density plots for Individual Cohorts</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for risk scores</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>risk_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"meth_only_risk_score"</span>)</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>independent_plots <span class="ot">&lt;-</span> <span class="cf">function</span>(vars, indp_dfs, <span class="at">wo_exp=</span><span class="cn">FALSE</span>){</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(vars), <span class="cf">function</span>(j){</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print("Risk scores variables :", x)</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a>  ind_den_plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(indp_dfs), <span class="cf">function</span>(i){</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">==</span> <span class="dv">5</span>){</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>    fig_legend <span class="ot">=</span> <span class="cn">TRUE</span> <span class="co"># change this to true for legend later</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>    legend <span class="ot">=</span> <span class="st">"Current PTSD"</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>    fig_legend <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>    legend <span class="ot">=</span> <span class="st">"test"</span></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(wo_exp <span class="sc">|</span> j <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>      xlab <span class="ot">=</span> <span class="st">'Methylation risk score'</span></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> <span class="cf">if</span> (j <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a>      xlab <span class="ot">=</span> <span class="st">'Risk score (methylation)'</span></span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">make_densityplot</span>(<span class="at">df =</span> indp_dfs[[i]], </span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x =</span> vars[j],</span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> xlab,</span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb182-28"><a href="#cb182-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fig_legend =</span> fig_legend,</span>
<span id="cb182-29"><a href="#cb182-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">legend =</span> legend,</span>
<span id="cb182-30"><a href="#cb182-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">title =</span> <span class="fu">names</span>(indp_dfs)[i])</span>
<span id="cb182-31"><a href="#cb182-31" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb182-32"><a href="#cb182-32" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb182-33"><a href="#cb182-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb182-34"><a href="#cb182-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb182-35"><a href="#cb182-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-36"><a href="#cb182-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-37"><a href="#cb182-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-38"><a href="#cb182-38" aria-hidden="true" tabindex="-1"></a><span class="co"># ind_den_plots</span></span>
<span id="cb182-39"><a href="#cb182-39" aria-hidden="true" tabindex="-1"></a>ind_den_plots <span class="ot">&lt;-</span> <span class="fu">independent_plots</span>(<span class="at">vars =</span> risk_vars, <span class="at">indp_dfs =</span> ind_sc_df)</span>
<span id="cb182-40"><a href="#cb182-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-41"><a href="#cb182-41" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_den_plots[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb182-42"><a href="#cb182-42" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_den_plots[[<span class="dv">1</span>]][<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb182-43"><a href="#cb182-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb182-44"><a href="#cb182-44" aria-hidden="true" tabindex="-1"></a>p1_p2_ind <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb182-45"><a href="#cb182-45" aria-hidden="true" tabindex="-1"></a>indp_cohorts.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Individual cohorts, adjusted for exposures"</span>, </span>
<span id="cb182-46"><a href="#cb182-46" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>))</span>
<span id="cb182-47"><a href="#cb182-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-48"><a href="#cb182-48" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p1_p2_ind, <span class="at">top =</span> indp_cohorts.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="independent-cohorts-test-set" class="level3">
<h3 class="anchored" data-anchor-id="independent-cohorts-test-set">independent cohorts test set</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>ind_test_den_plots <span class="ot">&lt;-</span> <span class="fu">independent_plots</span>(<span class="at">vars =</span> risk_vars, <span class="at">indp_dfs =</span> ind_sc_df_test)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_test_den_plots[[<span class="dv">1</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> ind_test_den_plots[[<span class="dv">1</span>]][<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>), <span class="at">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>indp_cohorts_test.grob <span class="ot">&lt;-</span> <span class="fu">textGrob</span>(<span class="st">"Individual cohorts testset , adjusted for exposures"</span>, </span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">20</span>))</span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>p1_p2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1,p2, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(p1_p2, <span class="at">top =</span> indp_cohorts_test.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="case-controls-and-males-females-in-train-test" class="level3">
<h3 class="anchored" data-anchor-id="case-controls-and-males-females-in-train-test">Case, controls and males, females in train test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>CurrentPTSD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
228  79 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>CurrentPTSD)<span class="sc">/</span><span class="fu">nrow</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      0       1 
74.2671 25.7329 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2 
143 164 </code></pre>
</div>
</div>
</section>
<section id="to-confirm-if-females-have-high-scores-compared-to-males-as-in-va-samples" class="level3">
<h3 class="anchored" data-anchor-id="to-confirm-if-females-have-high-scores-compared-to-males-as-in-va-samples">To confirm if females have high scores compared to males (as in VA samples)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we'll get the sex info from the earlier dataset </span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="co"># when we had gender as significant feature</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co"># It </span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sex_info &lt;- read.csv("G:/PGC ML/Combined Data/2021-11-27_19-16-35/risk scores ptsdpm test data.csv")</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(adj_sc_df$`Without NonCpG Probes`)</span></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # all should be True</span></span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a><span class="co"># table(adj_sc_df$`Without NonCpG Probes`$CurrentPTSD == sex_info$ptsdpm)</span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a><span class="co"># table(as.integer(adj_sc_df$`Without NonCpG Probes`$TraumaNumber) == as.integer(sex_info$Traumanum))</span></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df$`Without NonCpG Probes`$Gender &lt;- as.factor(sex_info$Gender)</span></span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df$`Without NonCpGXY Probes`$Gender &lt;- as.factor(sex_info$Gender)</span></span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a>adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>Gender)</span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a>adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>Gender)</span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>mf_rsk_p <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>,</span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>                             <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb190-25"><a href="#cb190-25" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb190-26"><a href="#cb190-26" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb190-27"><a href="#cb190-27" aria-hidden="true" tabindex="-1"></a>                             <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb190-28"><a href="#cb190-28" aria-hidden="true" tabindex="-1"></a>                             <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb190-29"><a href="#cb190-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title =</span> <span class="st">"Test set, controls and cases separately </span><span class="sc">\n</span><span class="st">(Without NonCpG Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_p1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">title =</span> <span class="st">"Test set, controls and cases together </span><span class="sc">\n</span><span class="st">(Without NonCpG Probes)"</span>)</span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_p, mf_rsk_p1, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_p2 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">title =</span> <span class="st">"Test set, controls and cases separately </span><span class="sc">\n</span><span class="st">(Without NonCpGXY Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_p3 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">title =</span> <span class="st">"Controls and cases together </span><span class="sc">\n</span><span class="st">(Without NonCpGXY Probes)"</span>)</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_p2, mf_rsk_p3, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---------------- check if females have higher symptom severity</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Non CPG probes separate and together</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a>mf_rsk_ptss <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">x =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">xlab =</span> <span class="st">'PTSS'</span>,</span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">title =</span> <span class="st">"Test set, controls and cases separately </span><span class="sc">\n</span><span class="st">(Without NonCpG Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_ptss1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">xlab =</span> <span class="st">'PTSS'</span>,</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"Test set, controls and cases together </span><span class="sc">\n</span><span class="st">(Without NonCpG Probes)"</span>)</span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_ptss, mf_rsk_ptss1, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 70 rows containing non-finite values (`stat_density()`).
Removed 70 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Non CPG and XY probes separate and together</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>mf_rsk_ptss2 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">xlab =</span> <span class="st">'PTSS'</span>,</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"Test set, controls and cases separately </span><span class="sc">\n</span><span class="st">(Without NonCpGXY Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_ptss3 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">'Pts_Severity'</span>,</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">xlab =</span> <span class="st">'PTSS'</span>,</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"Test set, controls and cases together </span><span class="sc">\n</span><span class="st">(Without NonCpGXY Probes)"</span>)</span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_ptss2, mf_rsk_ptss3, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 70 rows containing non-finite values (`stat_density()`).
Removed 70 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-26-4.png" class="img-fluid" width="1344"></p>
</div>
</div>
</section>
<section id="check-risk-scores-for-males-and-females-in-train-and-test-current-ptsd" class="level3">
<h3 class="anchored" data-anchor-id="check-risk-scores-for-males-and-females-in-train-and-test-current-ptsd">Check risk scores for males and females in train and test (current ptsd)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>test_df <span class="ot">&lt;-</span> current_all_sc<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>CurrentPTSD <span class="sc">==</span> train_test<span class="sc">$</span>current_ptsd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
1226 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(test_df<span class="sc">$</span>TraumaNumber <span class="sc">==</span> train_test<span class="sc">$</span>Traumanum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
1226 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">as.integer</span>(test_df<span class="sc">$</span>ChildhoodMaltreatment) <span class="sc">==</span> <span class="fu">as.integer</span>(train_test<span class="sc">$</span>Childhood_Mt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
TRUE 
1226 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span><span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train_test<span class="sc">$</span>Gender)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span><span class="sc">$</span>Gender <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(train_test<span class="sc">$</span>Gender)</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>mf_rsk_all_p <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">xlab =</span> <span class="st">'Risk score (methylation) '</span>,</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb210-11"><a href="#cb210-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb210-12"><a href="#cb210-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb210-13"><a href="#cb210-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">title =</span> <span class="st">"Controls and cases separately </span><span class="sc">\n</span><span class="st"> ( in train and test Without NonCpG Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_all_p1 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">fig_legend =</span> <span class="cn">TRUE</span>,</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="st">"Controls and cases together </span><span class="sc">\n</span><span class="st">(in train and test Without NonCpG Probes)"</span>)</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_all_p, mf_rsk_all_p1, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="1344"></p>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_all_p2 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">fig_legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">legend =</span> <span class="st">""</span>,</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">facet =</span> <span class="st">"CurrentPTSD"</span>,</span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="st">"Controls and cases separately </span><span class="sc">\n</span><span class="st"> ( in train and test - Without NonCpGXY Probes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Adding facet"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>mf_rsk_all_p3 <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> cur_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="st">'Gender'</span>,</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">legend =</span> <span class="st">"Gender"</span>,</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="st">"Controls and cases together </span><span class="sc">\n</span><span class="st">(in train and test - Without NonCpGXY Probes)"</span>)</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mf_rsk_all_p2, mf_rsk_all_p3, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">1.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid" width="1344"></p>
</div>
</div>
<section id="distribution-of-mean-methylation-of-positive-and-negative-coefficient-features-for-cases-and-controls" class="level4">
<h4 class="anchored" data-anchor-id="distribution-of-mean-methylation-of-positive-and-negative-coefficient-features-for-cases-and-controls">Distribution of mean methylation of positive and negative coefficient features for cases and controls</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Positive coefficient features</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_pos_meth &lt;- make_densityplot(df = adj_sc_df_pos$`Without NonCpG Probes`,</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 x = 'mean_meth',</span></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 y = 'CurrentPTSD',</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 xlab = 'Mean methylation',</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 ylab = "Density",</span></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 fig_legend = FALSE,</span></span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 # legend = "Current PTSD",</span></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 title = "Covariate adjusted and scaled: \n Without NonCpG Probes \n (positive coefficient) ")</span></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a><span class="co"># p2_pos_meth &lt;- make_densityplot(df = adj_sc_df_pos$`Without NonCpGXY Probes`, x = 'mean_meth',</span></span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'CurrentPTSD',</span></span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Mean methylation',</span></span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "",</span></span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "Current PTSD",</span></span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Covariate adjusted and scaled: \n Without NonCpGXY Probes \n (positive coefficient) ")</span></span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(p1_pos_meth, p2_pos_meth, rel_widths = c(2, 1.3))</span></span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # ---------------------------------------------------</span></span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # Negative coefficient features</span></span>
<span id="cb216-23"><a href="#cb216-23" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_neg_meth &lt;- make_densityplot(df = adj_sc_df_neg$`Without NonCpG Probes`, x = 'mean_meth',</span></span>
<span id="cb216-24"><a href="#cb216-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'CurrentPTSD',</span></span>
<span id="cb216-25"><a href="#cb216-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Mean methylation',</span></span>
<span id="cb216-26"><a href="#cb216-26" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb216-27"><a href="#cb216-27" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = FALSE,</span></span>
<span id="cb216-28"><a href="#cb216-28" aria-hidden="true" tabindex="-1"></a><span class="co">#                          # legend = "Current PTSD",</span></span>
<span id="cb216-29"><a href="#cb216-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Covariate adjusted and scaled: \n Without NonCpG Probes \n (negative coefficient) ")</span></span>
<span id="cb216-30"><a href="#cb216-30" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-31"><a href="#cb216-31" aria-hidden="true" tabindex="-1"></a><span class="co"># p2_neg_meth &lt;- make_densityplot(df = adj_sc_df_neg$`Without NonCpGXY Probes`, x = 'mean_meth',</span></span>
<span id="cb216-32"><a href="#cb216-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'CurrentPTSD',</span></span>
<span id="cb216-33"><a href="#cb216-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Mean methylation',</span></span>
<span id="cb216-34"><a href="#cb216-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "",</span></span>
<span id="cb216-35"><a href="#cb216-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "Current PTSD",</span></span>
<span id="cb216-36"><a href="#cb216-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Covariate adjusted and scaled: \n Without NonCpGXY Probes \n (negative coefficient) ")</span></span>
<span id="cb216-37"><a href="#cb216-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-38"><a href="#cb216-38" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(p1_neg_meth, p2_neg_meth, rel_widths = c(2, 1.3))</span></span>
<span id="cb216-39"><a href="#cb216-39" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-40"><a href="#cb216-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-41"><a href="#cb216-41" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-42"><a href="#cb216-42" aria-hidden="true" tabindex="-1"></a><span class="co"># # --------------------------------------------------------</span></span>
<span id="cb216-43"><a href="#cb216-43" aria-hidden="true" tabindex="-1"></a><span class="co"># # positive coefficient features for males and females separately</span></span>
<span id="cb216-44"><a href="#cb216-44" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df_pos$`Without NonCpG Probes`$Gender &lt;- as.factor(adj_sc_df_pos$`Without NonCpG Probes`$Gender)</span></span>
<span id="cb216-45"><a href="#cb216-45" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df_pos$`Without NonCpGXY Probes`$Gender &lt;- as.factor(adj_sc_df_pos$`Without NonCpGXY Probes`$Gender)</span></span>
<span id="cb216-46"><a href="#cb216-46" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-47"><a href="#cb216-47" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_pos_meth_sep &lt;- make_densityplot(df = adj_sc_df_pos$`Without NonCpG Probes`, x = 'meth_only_risk_score',</span></span>
<span id="cb216-48"><a href="#cb216-48" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb216-49"><a href="#cb216-49" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb216-50"><a href="#cb216-50" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb216-51"><a href="#cb216-51" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = FALSE,</span></span>
<span id="cb216-52"><a href="#cb216-52" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "",</span></span>
<span id="cb216-53"><a href="#cb216-53" aria-hidden="true" tabindex="-1"></a><span class="co">#                          facet = "CurrentPTSD",</span></span>
<span id="cb216-54"><a href="#cb216-54" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases separately \n ( positive coef - Without NonCpG Probes)")</span></span>
<span id="cb216-55"><a href="#cb216-55" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-56"><a href="#cb216-56" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_pos_meth_sep1 &lt;- make_densityplot(df = adj_sc_df_pos$`Without NonCpGXY Probes`, x = 'meth_only_risk_score',</span></span>
<span id="cb216-57"><a href="#cb216-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb216-58"><a href="#cb216-58" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb216-59"><a href="#cb216-59" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb216-60"><a href="#cb216-60" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = TRUE,</span></span>
<span id="cb216-61"><a href="#cb216-61" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "Gender",</span></span>
<span id="cb216-62"><a href="#cb216-62" aria-hidden="true" tabindex="-1"></a><span class="co">#                          facet = "CurrentPTSD",</span></span>
<span id="cb216-63"><a href="#cb216-63" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases separately \n ( positive coef - Without NonCpGXY Probes)")</span></span>
<span id="cb216-64"><a href="#cb216-64" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-65"><a href="#cb216-65" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(p1_pos_meth_sep, p1_pos_meth_sep1, rel_widths = c(1.5, 2))</span></span>
<span id="cb216-66"><a href="#cb216-66" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-67"><a href="#cb216-67" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-68"><a href="#cb216-68" aria-hidden="true" tabindex="-1"></a><span class="co"># # -----------------------------------------</span></span>
<span id="cb216-69"><a href="#cb216-69" aria-hidden="true" tabindex="-1"></a><span class="co"># # Negative coefficient features for males and females separately </span></span>
<span id="cb216-70"><a href="#cb216-70" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df_neg$`Without NonCpG Probes`$Gender &lt;- as.factor(adj_sc_df_neg$`Without NonCpG Probes`$Gender)</span></span>
<span id="cb216-71"><a href="#cb216-71" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_sc_df_neg$`Without NonCpGXY Probes`$Gender &lt;- as.factor(adj_sc_df_neg$`Without NonCpGXY Probes`$Gender)</span></span>
<span id="cb216-72"><a href="#cb216-72" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-73"><a href="#cb216-73" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_neg_meth_sep &lt;- make_densityplot(df = adj_sc_df_neg$`Without NonCpG Probes`, x = 'meth_only_risk_score',</span></span>
<span id="cb216-74"><a href="#cb216-74" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb216-75"><a href="#cb216-75" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb216-76"><a href="#cb216-76" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb216-77"><a href="#cb216-77" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = FALSE,</span></span>
<span id="cb216-78"><a href="#cb216-78" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "",</span></span>
<span id="cb216-79"><a href="#cb216-79" aria-hidden="true" tabindex="-1"></a><span class="co">#                          facet = "CurrentPTSD",</span></span>
<span id="cb216-80"><a href="#cb216-80" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases separately \n ( negative coef - Without NonCpG Probes)")</span></span>
<span id="cb216-81"><a href="#cb216-81" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-82"><a href="#cb216-82" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_neg_meth_sep1 &lt;- make_densityplot(df = adj_sc_df_neg$`Without NonCpGXY Probes`, x = 'meth_only_risk_score',</span></span>
<span id="cb216-83"><a href="#cb216-83" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb216-84"><a href="#cb216-84" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb216-85"><a href="#cb216-85" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb216-86"><a href="#cb216-86" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = TRUE,</span></span>
<span id="cb216-87"><a href="#cb216-87" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "Gender",</span></span>
<span id="cb216-88"><a href="#cb216-88" aria-hidden="true" tabindex="-1"></a><span class="co">#                          facet = "CurrentPTSD",</span></span>
<span id="cb216-89"><a href="#cb216-89" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases separately \n ( negative coef - Without NonCpGXY Probes)")</span></span>
<span id="cb216-90"><a href="#cb216-90" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb216-91"><a href="#cb216-91" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(p1_neg_meth_sep, p1_neg_meth_sep1, rel_widths = c(1.5, 2))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="without-using-gender-in-estimating-risk-scores-check-risk-scores-for-males-and-females-in-train-and-test-current-ptsd" class="level3">
<h3 class="anchored" data-anchor-id="without-using-gender-in-estimating-risk-scores-check-risk-scores-for-males-and-females-in-train-and-test-current-ptsd">Without using gender in estimating risk scores, check risk scores for males and females in train and test (current ptsd)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cur_sc_df_gen$Gender &lt;- as.factor(cur_sc_df_gen$Gender)</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mf_rsk_all_gen_p &lt;- make_densityplot(df = cur_sc_df_gen, x = 'meth_only_risk_score',</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "Density",</span></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = FALSE,</span></span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "",</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                          facet = "CurrentPTSD",</span></span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases seprately \n ( in train and test)")</span></span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a><span class="co"># mf_rsk_all_gen_p1 &lt;- make_densityplot(df = cur_sc_df_gen, x = 'meth_only_risk_score',</span></span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                          y = 'Gender',</span></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                          xlab = 'Risk score',</span></span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                          ylab = "",</span></span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                          fig_legend = TRUE,</span></span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                          legend = "Gender",</span></span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                          title = "Controls and cases together \n(in train and test)")</span></span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a><span class="co"># cowplot::plot_grid(mf_rsk_all_gen_p, mf_rsk_all_gen_p1, rel_widths = c(2, 1.3))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="box-plot-function" class="level2">
<h2 class="anchored" data-anchor-id="box-plot-function">Box plot function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>make_boxplot <span class="ot">&lt;-</span> <span class="cf">function</span>(df, x, y, xlab, ylab,</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>                         test_pval, y_pos, <span class="at">title =</span> <span class="st">""</span>){</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes_string</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> x)) <span class="sc">+</span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">lwd =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#0072B5FF"</span>, <span class="st">"#BC3C29FF"</span>)) <span class="sc">+</span></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">size=</span><span class="fl">1.7</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span> th <span class="sc">+</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(title) <span class="sc">+</span></span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(xlab) <span class="sc">+</span></span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(ylab)</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add significance</span></span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">+</span> <span class="fu">geom_signif</span>(</span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation =</span> <span class="fu">formatC</span>(test_pval, <span class="at">digits =</span> <span class="dv">2</span>),</span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_position =</span> y_pos , <span class="at">xmin =</span> <span class="dv">1</span>, <span class="at">xmax =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">textsize =</span> <span class="dv">5</span>, <span class="at">tip_length =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.02</span>))</span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-1" class="level1">
<h1>———————————————</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>wcox_test_sc <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>wcox_test_sc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by CurrentPTSD
W = 3429, p-value = 2.373e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>wcox_test_sc<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.373047e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>p1_box_sc <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpG Probes</span><span class="st">`</span>, </span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ylab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">test_pval =</span> wcox_test_sc<span class="sc">$</span>p.value,</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y_pos =</span> <span class="fl">4.8</span>,</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"Covariate adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpG Probes"</span></span>
<span id="cb223-9"><a href="#cb223-9" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb223-10"><a href="#cb223-10" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc</span></span>
<span id="cb223-11"><a href="#cb223-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-12"><a href="#cb223-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-13"><a href="#cb223-13" aria-hidden="true" tabindex="-1"></a>wcox_test_sc1 <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb223-14"><a href="#cb223-14" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>)</span>
<span id="cb223-15"><a href="#cb223-15" aria-hidden="true" tabindex="-1"></a>wcox_test_sc1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by CurrentPTSD
W = 3460, p-value = 3.464e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>wcox_test_sc1<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.464215e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>p1_box_sc1 <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ylab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">test_pval =</span> wcox_test_sc1<span class="sc">$</span>p.value,</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y_pos =</span> <span class="fl">4.7</span>,</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">title =</span> <span class="st">"Covariate adjusted and scaled: </span><span class="sc">\n</span><span class="st"> Without NonCpGXY Probes"</span></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>                           )</span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc1</span></span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1_box_sc, p1_box_sc1, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="960"></p>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># life</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_life_sc &lt;- wilcox.test(meth_only_risk_score ~ LifetimePTSD, </span></span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 data =adj_life_sc_df$`Without NonCpG Probes`)</span></span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_life_sc</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_life_sc$p.value</span></span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_life_sc &lt;- make_boxplot(df = adj_life_sc_df, x = 'LifetimePTSD',</span></span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                        y = 'meth_only_risk_score',</span></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                        xlab = 'Lifetime PTSD',</span></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                        ylab = '',</span></span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                        test_pval = wcox_test_life_sc$p.value,</span></span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                        y_pos = .54,</span></span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                        title = "" # Covariate adjusted \nand scaled</span></span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_life_sc</span></span>
<span id="cb228-17"><a href="#cb228-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb228-18"><a href="#cb228-18" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb228-19"><a href="#cb228-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb228-20"><a href="#cb228-20" aria-hidden="true" tabindex="-1"></a><span class="co"># # --------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="density-plot-for-istss" class="level3">
<h3 class="anchored" data-anchor-id="density-plot-for-istss">Density plot for ISTSS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># istss_den &lt;- make_densityplot(df = adj_sc_df$`Without NonCpGXY Probes`, </span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                               x = 'meth_only_risk_score',</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                               y = 'CurrentPTSD',</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                               xlab = 'Risk score (methylation)',</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                               ylab = "Density",</span></span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                               fig_legend = FALSE,</span></span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                               legend = "",</span></span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                               title = "Distribution of risk scores"</span></span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                               )</span></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>istss_den_meth <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb229-16"><a href="#cb229-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">legend =</span> <span class="st">"Current</span><span class="sc">\n</span><span class="st"> PTSD"</span>,</span>
<span id="cb229-17"><a href="#cb229-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title =</span> <span class="st">"Distribution of risk scores"</span></span>
<span id="cb229-18"><a href="#cb229-18" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb229-19"><a href="#cb229-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-20"><a href="#cb229-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-21"><a href="#cb229-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-22"><a href="#cb229-22" aria-hidden="true" tabindex="-1"></a><span class="co"># istss_den</span></span>
<span id="cb229-23"><a href="#cb229-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb229-24"><a href="#cb229-24" aria-hidden="true" tabindex="-1"></a><span class="co"># istss_den_meth</span></span>
<span id="cb229-25"><a href="#cb229-25" aria-hidden="true" tabindex="-1"></a>istss_den_meth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</section>
<section id="box-plots-for-individual-cohorts" class="level3">
<h3 class="anchored" data-anchor-id="box-plots-for-individual-cohorts">Box plots for Individual Cohorts</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>indp_wcox <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ind_sc_df, <span class="cf">function</span>(x){ </span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, <span class="at">data =</span> x)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>indp_wcox_pvals <span class="ot">&lt;-</span> <span class="fu">lapply</span>(indp_wcox, <span class="cf">function</span>(x){</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span>p.value</span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>indp_wcox_pvals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1] 1.955405e-21

$DNHS
[1] 3.419555e-20

$GTP
[1] 2.215773e-60

$MRS
[1] 1.436727e-19

$Prismo
[1] 3.960445e-11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>indp_box_plots <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(ind_sc_df), <span class="cf">function</span>(i){</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>)){</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>)){</span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(i<span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)){</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>    y_pos<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{y_pos <span class="ot">=</span> <span class="fl">4.6</span>}</span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>   <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)){</span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>    ylab <span class="ot">=</span> <span class="st">""</span></span>
<span id="cb232-12"><a href="#cb232-12" aria-hidden="true" tabindex="-1"></a>   }<span class="cf">else</span>{ylab <span class="ot">=</span> <span class="st">'Risk score (methylation)'</span>}</span>
<span id="cb232-13"><a href="#cb232-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">make_boxplot</span>(<span class="at">df =</span> ind_sc_df[[i]], </span>
<span id="cb232-14"><a href="#cb232-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb232-15"><a href="#cb232-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb232-16"><a href="#cb232-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb232-17"><a href="#cb232-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> ylab,</span>
<span id="cb232-18"><a href="#cb232-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">test_pval =</span> indp_wcox[[i]]<span class="sc">$</span>p.value,</span>
<span id="cb232-19"><a href="#cb232-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">y_pos =</span> y_pos,</span>
<span id="cb232-20"><a href="#cb232-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="fu">names</span>(ind_sc_df)[i]</span>
<span id="cb232-21"><a href="#cb232-21" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb232-22"><a href="#cb232-22" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb232-23"><a href="#cb232-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb232-24"><a href="#cb232-24" aria-hidden="true" tabindex="-1"></a><span class="co"># indp_box_plots</span></span>
<span id="cb232-25"><a href="#cb232-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-26"><a href="#cb232-26" aria-hidden="true" tabindex="-1"></a>indp_box_p <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> indp_box_plots)</span>
<span id="cb232-27"><a href="#cb232-27" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(indp_box_p, <span class="at">top=</span> indp_cohorts.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="box-plots-for-individual-cohorts-test-set" class="level3">
<h3 class="anchored" data-anchor-id="box-plots-for-individual-cohorts-test-set">Box plots for Individual Cohorts TEST SET</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>indp_wcox_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ind_sc_df_test, <span class="cf">function</span>(x){ </span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD, </span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> x)</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>indp_wcox_pvals_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(indp_wcox_test, <span class="cf">function</span>(x){</span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span>p.value</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a>indp_wcox_pvals_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Armystarrs
[1] 6.136856e-09

$DNHS
[1] 6.274654e-06

$GTP
[1] 2.480871e-08

$MRS
[1] 0.000421272

$Prismo
[1] 0.07142857</code></pre>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>indp_box_plots_test <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(ind_sc_df_test), <span class="cf">function</span>(i){</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)){</span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>)){</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>    y_pos <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(i<span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>)){</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>    y_pos<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{y_pos <span class="ot">=</span> <span class="fl">3.5</span>}</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)){</span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a>    ylab <span class="ot">=</span> <span class="st">""</span></span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{ylab <span class="ot">=</span> <span class="st">'Methylation risk score'</span>}</span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">make_boxplot</span>(<span class="at">df =</span> ind_sc_df_test[[i]], </span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">'Current PTSD'</span>,</span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> ylab,</span>
<span id="cb235-20"><a href="#cb235-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">test_pval =</span> indp_wcox_test[[i]]<span class="sc">$</span>p.value,</span>
<span id="cb235-21"><a href="#cb235-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">y_pos =</span> y_pos,</span>
<span id="cb235-22"><a href="#cb235-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">title =</span> <span class="fu">names</span>(ind_sc_df_test)[i]</span>
<span id="cb235-23"><a href="#cb235-23" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb235-24"><a href="#cb235-24" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb235-25"><a href="#cb235-25" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb235-26"><a href="#cb235-26" aria-hidden="true" tabindex="-1"></a><span class="co"># indp_box_plots</span></span>
<span id="cb235-27"><a href="#cb235-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-28"><a href="#cb235-28" aria-hidden="true" tabindex="-1"></a>indp_box_p_test <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> indp_box_plots_test)</span>
<span id="cb235-29"><a href="#cb235-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-30"><a href="#cb235-30" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="fu">arrangeGrob</span>(indp_box_p_test, <span class="at">top =</span> indp_cohorts_test.grob))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="box-plot-for-istss" class="level3">
<h3 class="anchored" data-anchor-id="box-plot-for-istss">Box plot for ISTSS</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>istss_den_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>, </span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb236-7"><a href="#cb236-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">xlab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb236-8"><a href="#cb236-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ylab =</span> <span class="st">""</span>,</span>
<span id="cb236-9"><a href="#cb236-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">legend =</span> <span class="st">"Current</span><span class="sc">\n</span><span class="st"> PTSD"</span>,</span>
<span id="cb236-10"><a href="#cb236-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title =</span> <span class="st">"With Adjusted exposures"</span></span>
<span id="cb236-11"><a href="#cb236-11" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb236-12"><a href="#cb236-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-13"><a href="#cb236-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-14"><a href="#cb236-14" aria-hidden="true" tabindex="-1"></a>wcox_test_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(meth_only_risk_score <span class="sc">~</span> CurrentPTSD,</span>
<span id="cb236-15"><a href="#cb236-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>)</span>
<span id="cb236-16"><a href="#cb236-16" aria-hidden="true" tabindex="-1"></a>wcox_test_meth_wo_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  meth_only_risk_score by CurrentPTSD
W = 3460, p-value = 3.464e-16
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>wcox_test_meth_wo_exp<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.464215e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>p1_box_istss_meth_wo_exp <span class="ot">&lt;-</span> <span class="fu">make_boxplot</span>(<span class="at">df =</span> adj_sc_df<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span>,</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="st">'CurrentPTSD'</span>,</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="st">'meth_only_risk_score'</span>,</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xlab =</span> <span class="st">''</span>,</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">ylab =</span> <span class="st">'Risk score (methylation)'</span>,</span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">test_pval =</span> wcox_test_meth_wo_exp<span class="sc">$</span>p.value,</span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y_pos =</span> <span class="dv">4</span>,</span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title =</span> <span class="st">""</span></span>
<span id="cb240-9"><a href="#cb240-9" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb240-10"><a href="#cb240-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-11"><a href="#cb240-11" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange den plots</span></span>
<span id="cb240-12"><a href="#cb240-12" aria-hidden="true" tabindex="-1"></a>p_wo_exp <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(istss_den_meth_wo_exp, </span>
<span id="cb240-13"><a href="#cb240-13" aria-hidden="true" tabindex="-1"></a>                               p1_box_istss_meth_wo_exp, </span>
<span id="cb240-14"><a href="#cb240-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb240-15"><a href="#cb240-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label_x =</span> .<span class="dv">15</span> )</span>
<span id="cb240-16"><a href="#cb240-16" aria-hidden="true" tabindex="-1"></a>p_wo_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="384"></p>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # arrange den plots</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="co"># # p1 &lt;- cowplot::plot_grid(istss_den, istss_den_meth,</span></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #                          labels = c("A","B"),</span></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a><span class="co"># #                          label_x = .15 , vjust = 2,</span></span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #                          rel_widths = c(1.5, 2))</span></span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a><span class="co"># # add title to den plots</span></span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # title_den.grob &lt;- textGrob("Distribution of risk scores",</span></span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a><span class="co"># #                    gp=gpar(fontsize=20), vjust = 1)</span></span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a><span class="co"># #</span></span>
<span id="cb241-12"><a href="#cb241-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # p1 &lt;- grid.arrange(arrangeGrob(p1, top = title_den.grob))</span></span>
<span id="cb241-13"><a href="#cb241-13" aria-hidden="true" tabindex="-1"></a><span class="co"># #</span></span>
<span id="cb241-14"><a href="#cb241-14" aria-hidden="true" tabindex="-1"></a><span class="co"># # # arrange box plots</span></span>
<span id="cb241-15"><a href="#cb241-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # p2 &lt;- cowplot::plot_grid(p1_box_istss,</span></span>
<span id="cb241-16"><a href="#cb241-16" aria-hidden="true" tabindex="-1"></a><span class="co"># #                          p1_box_istss_meth,</span></span>
<span id="cb241-17"><a href="#cb241-17" aria-hidden="true" tabindex="-1"></a><span class="co"># #                          labels = c("C","D"),</span></span>
<span id="cb241-18"><a href="#cb241-18" aria-hidden="true" tabindex="-1"></a><span class="co"># #                          label_x = .15 , vjust = 2)</span></span>
<span id="cb241-19"><a href="#cb241-19" aria-hidden="true" tabindex="-1"></a><span class="co"># #</span></span>
<span id="cb241-20"><a href="#cb241-20" aria-hidden="true" tabindex="-1"></a><span class="co"># # # add title to box plots</span></span>
<span id="cb241-21"><a href="#cb241-21" aria-hidden="true" tabindex="-1"></a><span class="co"># # title.grob &lt;- textGrob("Difference in risk scores",</span></span>
<span id="cb241-22"><a href="#cb241-22" aria-hidden="true" tabindex="-1"></a><span class="co"># #                    gp=gpar(fontsize=20), vjust = 1)</span></span>
<span id="cb241-23"><a href="#cb241-23" aria-hidden="true" tabindex="-1"></a><span class="co"># # p2 &lt;- grid.arrange(arrangeGrob(p2, top = title.grob))</span></span>
<span id="cb241-24"><a href="#cb241-24" aria-hidden="true" tabindex="-1"></a><span class="co"># #</span></span>
<span id="cb241-25"><a href="#cb241-25" aria-hidden="true" tabindex="-1"></a><span class="co"># # # add x label to box plots</span></span>
<span id="cb241-26"><a href="#cb241-26" aria-hidden="true" tabindex="-1"></a><span class="co"># # x.grob &lt;- textGrob("Current PTSD",</span></span>
<span id="cb241-27"><a href="#cb241-27" aria-hidden="true" tabindex="-1"></a><span class="co"># #                    gp=gpar(fontsize=18), vjust = -2)</span></span>
<span id="cb241-28"><a href="#cb241-28" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb241-29"><a href="#cb241-29" aria-hidden="true" tabindex="-1"></a><span class="co"># # arrange plots in grid</span></span>
<span id="cb241-30"><a href="#cb241-30" aria-hidden="true" tabindex="-1"></a><span class="co"># p_comb &lt;- cowplot::plot_grid(istss_den,p1_box_istss, rel_widths = c(1.5, 2))</span></span>
<span id="cb241-31"><a href="#cb241-31" aria-hidden="true" tabindex="-1"></a><span class="co"># p_comb</span></span>
<span id="cb241-32"><a href="#cb241-32" aria-hidden="true" tabindex="-1"></a><span class="co"># # grid.arrange(arrangeGrob(p_comb, bottom = x.grob))</span></span>
<span id="cb241-33"><a href="#cb241-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-34"><a href="#cb241-34" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_istss</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="boxplot-for-negative-and-positive-coefficient-features-using" class="level3">
<h3 class="anchored" data-anchor-id="boxplot-for-negative-and-positive-coefficient-features-using">Boxplot for negative and positive coefficient features using</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_neg &lt;- wilcox.test(risk_score ~ CurrentPTSD, </span></span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 data = adj_sc_df_neg$`Without NonCpG Probes`)</span></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_neg$p.value</span></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_neg1 &lt;- wilcox.test(risk_score ~ CurrentPTSD, </span></span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  data = adj_sc_df_neg$`Without NonCpGXY Probes`)</span></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_neg1$p.value</span></span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc_neg &lt;- make_boxplot(df = adj_sc_df_neg$`Without NonCpG Probes`, </span></span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                               x = 'CurrentPTSD',</span></span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a><span class="co">#                               y = 'mean_meth',</span></span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                               xlab = 'Current PTSD',</span></span>
<span id="cb242-15"><a href="#cb242-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                               ylab = 'Mean methylation',</span></span>
<span id="cb242-16"><a href="#cb242-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                               test_pval = wcox_test_sc_neg$p.value,</span></span>
<span id="cb242-17"><a href="#cb242-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                               y_pos = .53,</span></span>
<span id="cb242-18"><a href="#cb242-18" aria-hidden="true" tabindex="-1"></a><span class="co">#                               title = "Covariate adjusted and scaled: \n Without NonCpG Probes \n(negative coefficients)"</span></span>
<span id="cb242-19"><a href="#cb242-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb242-20"><a href="#cb242-20" aria-hidden="true" tabindex="-1"></a><span class="co"># # p1_box_sc</span></span>
<span id="cb242-21"><a href="#cb242-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-22"><a href="#cb242-22" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply(adj_sc_df_neg, dim)</span></span>
<span id="cb242-23"><a href="#cb242-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-24"><a href="#cb242-24" aria-hidden="true" tabindex="-1"></a><span class="co"># lapply(adj_sc_df_pos, dim)</span></span>
<span id="cb242-25"><a href="#cb242-25" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-26"><a href="#cb242-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-27"><a href="#cb242-27" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-28"><a href="#cb242-28" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc_neg1 &lt;- make_boxplot(df = adj_sc_df_neg$`Without NonCpGXY Probes`, </span></span>
<span id="cb242-29"><a href="#cb242-29" aria-hidden="true" tabindex="-1"></a><span class="co">#                                x = 'CurrentPTSD',</span></span>
<span id="cb242-30"><a href="#cb242-30" aria-hidden="true" tabindex="-1"></a><span class="co">#                                y = 'mean_meth',</span></span>
<span id="cb242-31"><a href="#cb242-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                                xlab = 'Current PTSD',</span></span>
<span id="cb242-32"><a href="#cb242-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                                ylab = 'Mean methylation',</span></span>
<span id="cb242-33"><a href="#cb242-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                                test_pval = wcox_test_sc_neg1$p.value,</span></span>
<span id="cb242-34"><a href="#cb242-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                                y_pos = .53,</span></span>
<span id="cb242-35"><a href="#cb242-35" aria-hidden="true" tabindex="-1"></a><span class="co">#                                title = "Covariate adjusted and scaled: \n Without NonCpGXY Probes \n(negative coefficients)"</span></span>
<span id="cb242-36"><a href="#cb242-36" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb242-37"><a href="#cb242-37" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-38"><a href="#cb242-38" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p1_box_sc_neg, p1_box_sc_neg1, nrow = 1)</span></span>
<span id="cb242-39"><a href="#cb242-39" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-40"><a href="#cb242-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-41"><a href="#cb242-41" aria-hidden="true" tabindex="-1"></a><span class="co"># #------------------------------------</span></span>
<span id="cb242-42"><a href="#cb242-42" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_pos &lt;- wilcox.test(risk_score ~ CurrentPTSD, </span></span>
<span id="cb242-43"><a href="#cb242-43" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 data = adj_sc_df_pos$`Without NonCpG Probes`)</span></span>
<span id="cb242-44"><a href="#cb242-44" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_pos$p.value</span></span>
<span id="cb242-45"><a href="#cb242-45" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-46"><a href="#cb242-46" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_pos1 &lt;- wilcox.test(risk_score ~ CurrentPTSD, </span></span>
<span id="cb242-47"><a href="#cb242-47" aria-hidden="true" tabindex="-1"></a><span class="co">#                                  data = adj_sc_df_pos$`Without NonCpGXY Probes`)</span></span>
<span id="cb242-48"><a href="#cb242-48" aria-hidden="true" tabindex="-1"></a><span class="co"># wcox_test_sc_pos1$p.value</span></span>
<span id="cb242-49"><a href="#cb242-49" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-50"><a href="#cb242-50" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc_pos &lt;- make_boxplot(df = adj_sc_df_pos$`Without NonCpG Probes`, </span></span>
<span id="cb242-51"><a href="#cb242-51" aria-hidden="true" tabindex="-1"></a><span class="co">#                               x = 'CurrentPTSD',</span></span>
<span id="cb242-52"><a href="#cb242-52" aria-hidden="true" tabindex="-1"></a><span class="co">#                               y = 'mean_meth',</span></span>
<span id="cb242-53"><a href="#cb242-53" aria-hidden="true" tabindex="-1"></a><span class="co">#                               xlab = 'Current PTSD',</span></span>
<span id="cb242-54"><a href="#cb242-54" aria-hidden="true" tabindex="-1"></a><span class="co">#                               ylab = 'Mean methylation',</span></span>
<span id="cb242-55"><a href="#cb242-55" aria-hidden="true" tabindex="-1"></a><span class="co">#                               test_pval = wcox_test_sc_pos$p.value,</span></span>
<span id="cb242-56"><a href="#cb242-56" aria-hidden="true" tabindex="-1"></a><span class="co">#                               y_pos = .53,</span></span>
<span id="cb242-57"><a href="#cb242-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                               title = "Covariate adjusted and scaled: \n Without NonCpG Probes \n(positive coefficients)"</span></span>
<span id="cb242-58"><a href="#cb242-58" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb242-59"><a href="#cb242-59" aria-hidden="true" tabindex="-1"></a><span class="co"># # p1_box_sc</span></span>
<span id="cb242-60"><a href="#cb242-60" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-61"><a href="#cb242-61" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-62"><a href="#cb242-62" aria-hidden="true" tabindex="-1"></a><span class="co"># p1_box_sc_pos1 &lt;- make_boxplot(df = adj_sc_df_pos$`Without NonCpGXY Probes`, </span></span>
<span id="cb242-63"><a href="#cb242-63" aria-hidden="true" tabindex="-1"></a><span class="co">#                                x = 'CurrentPTSD',</span></span>
<span id="cb242-64"><a href="#cb242-64" aria-hidden="true" tabindex="-1"></a><span class="co">#                                y = 'mean_meth',</span></span>
<span id="cb242-65"><a href="#cb242-65" aria-hidden="true" tabindex="-1"></a><span class="co">#                                xlab = 'Current PTSD',</span></span>
<span id="cb242-66"><a href="#cb242-66" aria-hidden="true" tabindex="-1"></a><span class="co">#                                ylab = 'Mean methylation',</span></span>
<span id="cb242-67"><a href="#cb242-67" aria-hidden="true" tabindex="-1"></a><span class="co">#                                test_pval = wcox_test_sc_pos1$p.value,</span></span>
<span id="cb242-68"><a href="#cb242-68" aria-hidden="true" tabindex="-1"></a><span class="co">#                                y_pos = .53,</span></span>
<span id="cb242-69"><a href="#cb242-69" aria-hidden="true" tabindex="-1"></a><span class="co">#                                title = "Covariate adjusted and scaled: \n Without NonCpGXY Probes \n(positive coefficients)"</span></span>
<span id="cb242-70"><a href="#cb242-70" aria-hidden="true" tabindex="-1"></a><span class="co">#                        )</span></span>
<span id="cb242-71"><a href="#cb242-71" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb242-72"><a href="#cb242-72" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_grid(p1_box_sc_pos, p1_box_sc_pos1, nrow = 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="save-dfs-with-risk-scores-and-weights-to-use-in-paathway-analysis" class="level3">
<h3 class="anchored" data-anchor-id="save-dfs-with-risk-scores-and-weights-to-use-in-paathway-analysis">Save dfs with risk scores and weights to use in paathway analysis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(adj_sc_df, <span class="at">file =</span>  <span class="st">"../../../Combined Data/2023-03-08_21-41-11//Adj_sc_df_for_pathways.RData"</span>)</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(weights, <span class="at">file =</span> <span class="st">"../../../Combined Data/2023-03-08_21-41-11//weights_for_pathways.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="distribution-plot-methylation" class="level3">
<h3 class="anchored" data-anchor-id="distribution-plot-methylation">Distribution plot methylation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>exp_adjusted <span class="ot">&lt;-</span> weights<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>exp_adjusted<span class="sc">$</span>Type <span class="ot">=</span> <span class="st">"Adjusted Exposures"</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>exp_unadjusted <span class="ot">&lt;-</span> weights_old<span class="sc">$</span><span class="st">`</span><span class="at">Without NonCpGXY Probes</span><span class="st">`</span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>exp_unadjusted<span class="sc">$</span>Type <span class="ot">=</span> <span class="st">"Unadjusted Exposures"</span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>comn_features <span class="ot">&lt;-</span> exp_adjusted[<span class="fu">which</span>(exp_adjusted<span class="sc">$</span>Feature <span class="sc">%in%</span> exp_unadjusted<span class="sc">$</span>Feature), ]</span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(comn_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2005    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(comn_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Feature Importance               Type
7  cg18135206 -0.5213713 Adjusted Exposures
13 cg17391997 -0.4795698 Adjusted Exposures
21 cg13718616 -0.4442636 Adjusted Exposures
25 cg15405368 -0.4352835 Adjusted Exposures
31 cg02670141 -0.3955294 Adjusted Exposures
34 cg24589102 -0.3918362 Adjusted Exposures</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>comn_features_old <span class="ot">&lt;-</span> exp_unadjusted[exp_unadjusted<span class="sc">$</span>Feature <span class="sc">%in%</span> exp_adjusted<span class="sc">$</span>Feature, ]</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(comn_features_old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2005    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(comn_features_old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Feature Importance                 Type
2  cg18135206 -0.5681374 Unadjusted Exposures
5  cg15405368 -0.5304694 Unadjusted Exposures
6  cg19542849 -0.5100509 Unadjusted Exposures
8  cg17391997 -0.4942164 Unadjusted Exposures
10 cg13716200 -0.4833850 Unadjusted Exposures
11 cg09550508 -0.4821752 Unadjusted Exposures</code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>combined_comn <span class="ot">&lt;-</span> <span class="fu">rbind</span>(comn_features_old, comn_features)</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(combined_comn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4010    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>dist_comn <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> combined_comn,</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x =</span> <span class="st">'Importance'</span>,</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="st">'Type'</span>,</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">xlab =</span> <span class="st">'Weights'</span>,</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">legend =</span> <span class="st">"Type"</span>,</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title =</span> <span class="st">"Distribution of weights"</span></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a>dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (x, method = "euclidean", diag = FALSE, upper = FALSE, 
    p = 2) 
{
    if (!is.na(pmatch(method, "euclidian"))) 
        method &lt;- "euclidean"
    METHODS &lt;- c("euclidean", "maximum", "manhattan", "canberra", 
        "binary", "minkowski")
    method &lt;- pmatch(method, METHODS)
    if (is.na(method)) 
        stop("invalid distance method")
    if (method == -1) 
        stop("ambiguous distance method")
    x &lt;- as.matrix(x)
    N &lt;- nrow(x)
    attrs &lt;- if (method == 6L) 
        list(Size = N, Labels = dimnames(x)[[1L]], Diag = diag, 
            Upper = upper, method = METHODS[method], p = p, call = match.call(), 
            class = "dist")
    else list(Size = N, Labels = dimnames(x)[[1L]], Diag = diag, 
        Upper = upper, method = METHODS[method], call = match.call(), 
        class = "dist")
    .Call(C_Cdist, x, method, attrs, p)
}
&lt;bytecode: 0x0000029de484b540&gt;
&lt;environment: namespace:stats&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>comb_all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(exp_adjusted, exp_unadjusted)</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>dist_all <span class="ot">&lt;-</span> <span class="fu">make_densityplot</span>(<span class="at">df =</span> comb_all,</span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">x =</span> <span class="st">'Importance'</span>,</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">y =</span> <span class="st">'Type'</span>,</span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">xlab =</span> <span class="st">'Weights'</span>,</span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ylab =</span> <span class="st">"Density"</span>,</span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">legend =</span> <span class="st">"Type"</span>,</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">title =</span> <span class="st">"Distribution of weights"</span></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>dist_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="downstream_analysis_adj_for_Exp_Vars_v5_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>